
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>veroviz.utilities &#8212; veroviz 0.4.5 documentation</title>
    <link rel="stylesheet" href="../../_static/lglb-sphinx-doc.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
  </head><body>
<div class="header">
 <p class="logo"><a href="https://veroviz.org">
  <img class="logo" src="../../_static/optimator_lab_transparency_small.png" alt="Logo"/>
 </a></p>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">veroviz 0.4.5 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../veroviz.html" accesskey="U">veroviz</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for veroviz.utilities</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">veroviz._common</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">veroviz._validation</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">veroviz._geometry</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">veroviz._internal</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">veroviz._geocode</span> <span class="k">import</span> <span class="n">privGeocode</span><span class="p">,</span> <span class="n">privReverseGeocode</span>
<span class="kn">from</span> <span class="nn">veroviz._isochrones</span> <span class="k">import</span> <span class="n">privIsochrones</span>
<span class="kn">from</span> <span class="nn">veroviz._elevation</span> <span class="k">import</span> <span class="n">privGetElevationLocs</span>
<span class="kn">from</span> <span class="nn">veroviz._elevation</span> <span class="k">import</span> <span class="n">privGetElevationNodes</span><span class="p">,</span> <span class="n">privGetElevationArcsAsgn</span>
<span class="kn">from</span> <span class="nn">veroviz._weather</span> <span class="k">import</span> <span class="n">privGetWeather</span>
<span class="kn">from</span> <span class="nn">veroviz._createEntitiesFromList</span> <span class="k">import</span> <span class="n">privCreateNodesFromLocs</span>
<span class="kn">from</span> <span class="nn">veroviz._getTimeDistFromLocs2D</span> <span class="k">import</span> <span class="n">getTimeDistFromLocs2D</span>
<span class="kn">from</span> <span class="nn">veroviz._nearestNodes</span> <span class="k">import</span> <span class="n">privNearestNodes</span>
<span class="kn">from</span> <span class="nn">veroviz._utilities</span> <span class="k">import</span> <span class="n">privInitDataframe</span><span class="p">,</span> <span class="n">privConvertDistance</span><span class="p">,</span> <span class="n">privConvertTime</span><span class="p">,</span> <span class="n">privConvertSpeed</span><span class="p">,</span> <span class="n">privGetMapBoundary</span><span class="p">,</span> <span class="n">privExportDataframe</span><span class="p">,</span> <span class="n">privAssignmentsToPaths</span><span class="p">,</span> <span class="n">privArcsToPaths</span><span class="p">,</span> <span class="n">privClosestPointLoc2Path</span>


<div class="viewcode-block" id="convertSpeed"><a class="viewcode-back" href="../../veroviz.utilities.html#veroviz.utilities.convertSpeed">[docs]</a><span class="k">def</span> <span class="nf">convertSpeed</span><span class="p">(</span><span class="n">speed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fromUnitsDist</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fromUnitsTime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">toUnitsDist</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">toUnitsTime</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Convert a speed to different units.</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	speed: float, Required</span>
<span class="sd">		The numeric value describing a speed to be converted.</span>
<span class="sd">	fromUnitsDist: string, Required</span>
<span class="sd">		Distance units for the given speed, before conversion. See :ref:`Units` for options.</span>
<span class="sd">	fromUnitsTime: string, Required</span>
<span class="sd">		Time units for the given speed, before conversion. See :ref:`Units` for options.</span>
<span class="sd">	toUnitsDist: string, Required</span>
<span class="sd">		Distance units for the speed after conversion. See :ref:`Units` for options.</span>
<span class="sd">	toUnitTime: string, Required</span>
<span class="sd">		Time units for the speed after conversion. See :ref:`Units` for options.</span>
<span class="sd">	</span>
<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	float</span>
<span class="sd">		Speed after conversion</span>

<span class="sd">	Example</span>
<span class="sd">	-------</span>
<span class="sd">		&gt;&gt;&gt; import veroviz as vrv</span>
<span class="sd">		&gt;&gt;&gt; speedFPS = 10</span>
<span class="sd">		&gt;&gt;&gt; speedMPH = vrv.convertSpeed(speedFPS, &#39;ft&#39;, &#39;s&#39;, &#39;mi&#39;, &#39;h&#39;)</span>
<span class="sd">		&gt;&gt;&gt; speedMPH</span>
<span class="sd">		6.818198764711	</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="c1"># validation</span>
	<span class="p">[</span><span class="n">valFlag</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">,</span> <span class="n">warningMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">valConvertSpeed</span><span class="p">(</span><span class="n">speed</span><span class="p">,</span> <span class="n">fromUnitsDist</span><span class="p">,</span> <span class="n">fromUnitsTime</span><span class="p">,</span> <span class="n">toUnitsDist</span><span class="p">,</span> <span class="n">toUnitsTime</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">valFlag</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">errorMsg</span><span class="p">)</span>
		<span class="k">return</span>
	<span class="k">elif</span> <span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;VRV_SETTING_SHOWWARNINGMESSAGE&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">warningMsg</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">warningMsg</span><span class="p">)</span>
	
	<span class="k">return</span> <span class="n">privConvertSpeed</span><span class="p">(</span><span class="n">speed</span><span class="p">,</span> <span class="n">fromUnitsDist</span><span class="p">,</span> <span class="n">fromUnitsTime</span><span class="p">,</span> <span class="n">toUnitsDist</span><span class="p">,</span> <span class="n">toUnitsTime</span><span class="p">)</span></div>
	

<div class="viewcode-block" id="convertDistance"><a class="viewcode-back" href="../../veroviz.utilities.html#veroviz.utilities.convertDistance">[docs]</a><span class="k">def</span> <span class="nf">convertDistance</span><span class="p">(</span><span class="n">distance</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fromUnits</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">toUnits</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Convert a distance to different units.</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	distance: float, Required</span>
<span class="sd">		The numeric value describing a distance to be converted.</span>
<span class="sd">	fromUnits: string, Required</span>
<span class="sd">		Distance units before conversion. See :ref:`Units` for options.</span>
<span class="sd">	toUnits: string, Required</span>
<span class="sd">		Distance units after conversion. See :ref:`Units` for options.</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	float</span>
<span class="sd">		Distance after conversion</span>

<span class="sd">	Example</span>
<span class="sd">	-------</span>
<span class="sd">		&gt;&gt;&gt; import veroviz as vrv</span>
<span class="sd">		&gt;&gt;&gt; distanceMiles = 1.0</span>
<span class="sd">		&gt;&gt;&gt; distanceKilometers = vrv.convertDistance(distanceMiles, &#39;miles&#39;, &#39;km&#39;)</span>
<span class="sd">		&gt;&gt;&gt; distanceKilometers</span>
<span class="sd">		1.60934</span>

<span class="sd">	&quot;&quot;&quot;</span>

	<span class="c1"># validation</span>
	<span class="p">[</span><span class="n">valFlag</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">,</span> <span class="n">warningMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">valConvertDistance</span><span class="p">(</span><span class="n">distance</span><span class="p">,</span> <span class="n">fromUnits</span><span class="p">,</span> <span class="n">toUnits</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">valFlag</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">errorMsg</span><span class="p">)</span>
		<span class="k">return</span>
	<span class="k">elif</span> <span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;VRV_SETTING_SHOWWARNINGMESSAGE&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">warningMsg</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">warningMsg</span><span class="p">)</span>

	<span class="k">return</span> <span class="n">privConvertDistance</span><span class="p">(</span><span class="n">distance</span><span class="p">,</span> <span class="n">fromUnits</span><span class="p">,</span> <span class="n">toUnits</span><span class="p">)</span></div>
	

<div class="viewcode-block" id="convertTime"><a class="viewcode-back" href="../../veroviz.utilities.html#veroviz.utilities.convertTime">[docs]</a><span class="k">def</span> <span class="nf">convertTime</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fromUnits</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">toUnits</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Convert a time to different units.</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	time: float, Required</span>
<span class="sd">		The numeric value describing a time to be converted.</span>
<span class="sd">	fromUnits: string, Required</span>
<span class="sd">		Time units before conversion. See :ref:`Units` for options.</span>
<span class="sd">	toUnits: string, Required</span>
<span class="sd">		Time units after conversion. See :ref:`Units` for options.</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	float</span>
<span class="sd">		Time after conversion</span>

<span class="sd">	Example</span>
<span class="sd">	-------</span>
<span class="sd">		&gt;&gt;&gt; import veroviz as vrv</span>
<span class="sd">		&gt;&gt;&gt; timeHours = 1.5</span>
<span class="sd">		&gt;&gt;&gt; timeMinutes = vrv.convertTime(timeHours, &#39;h&#39;, &#39;min&#39;)</span>
<span class="sd">		&gt;&gt;&gt; timeMinutes</span>
<span class="sd">		90.0</span>

<span class="sd">	&quot;&quot;&quot;</span>

	<span class="c1"># validation</span>
	<span class="p">[</span><span class="n">valFlag</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">,</span> <span class="n">warningMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">valConvertTime</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">fromUnits</span><span class="p">,</span> <span class="n">toUnits</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">valFlag</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">errorMsg</span><span class="p">)</span>
		<span class="k">return</span>
	<span class="k">elif</span> <span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;VRV_SETTING_SHOWWARNINGMESSAGE&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">warningMsg</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">warningMsg</span><span class="p">)</span>

	<span class="k">return</span> <span class="n">privConvertTime</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">fromUnits</span><span class="p">,</span> <span class="n">toUnits</span><span class="p">)</span></div>


<div class="viewcode-block" id="convertArea"><a class="viewcode-back" href="../../veroviz.utilities.html#veroviz.utilities.convertArea">[docs]</a><span class="k">def</span> <span class="nf">convertArea</span><span class="p">(</span><span class="n">area</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fromUnits</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">toUnits</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Convert an area from `fromUnits` to `toUnits`.</span>
<span class="sd">	</span>
<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	area: float, Required</span>
<span class="sd">		The numeric value describing an area to be converted.</span>
<span class="sd">	fromUnits: string, Required</span>
<span class="sd">		Area units, before conversion. See :ref:`Units` for options.</span>
<span class="sd">	toUnits: string, Required</span>
<span class="sd">		Desired units of area after conversion. See :ref:`Units` for options.</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	float</span>
<span class="sd">		New value of area, after conversion.</span>
<span class="sd">		</span>
<span class="sd">	Example</span>
<span class="sd">	-------</span>
<span class="sd">		&gt;&gt;&gt; import veroviz as vrv</span>
<span class="sd">		&gt;&gt;&gt; areaSQKM = 1.0</span>
<span class="sd">		&gt;&gt;&gt; areaSqMiles = vrv.convertArea(50, &#39;sqkm&#39;, &#39;sqmi&#39;)	</span>
<span class="sd">		&gt;&gt;&gt; areaSqMiles</span>
<span class="sd">		&gt;&gt;&gt; 19.305</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="p">[</span><span class="n">valFlag</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">,</span> <span class="n">warningMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">valConvertArea</span><span class="p">(</span><span class="n">area</span><span class="p">,</span> <span class="n">fromUnits</span><span class="p">,</span> <span class="n">toUnits</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">valFlag</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">errorMsg</span><span class="p">)</span>
		<span class="k">return</span>
	<span class="k">elif</span> <span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;VRV_SETTING_SHOWWARNINGMESSAGE&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">warningMsg</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">warningMsg</span><span class="p">)</span>
		
	<span class="k">try</span><span class="p">:</span>
		<span class="n">fromUnits</span> <span class="o">=</span> <span class="n">fromUnits</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
	<span class="k">except</span><span class="p">:</span>
		<span class="k">pass</span>
				
	<span class="c1"># Convert input to square meters:	</span>
	<span class="n">fromUnits</span> <span class="o">=</span> <span class="n">areaUnitsDictionary</span><span class="p">[</span><span class="n">fromUnits</span><span class="p">]</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">fromUnits</span> <span class="o">==</span> <span class="s1">&#39;sqft&#39;</span><span class="p">):</span>
		<span class="n">tmpArea</span> <span class="o">=</span> <span class="n">area</span> <span class="o">/</span> <span class="n">VRV_CONST_SQFT_PER_SQMETER</span> 
	<span class="k">elif</span> <span class="p">(</span><span class="n">fromUnits</span> <span class="o">==</span> <span class="s1">&#39;sqmi&#39;</span><span class="p">):</span>
		<span class="n">tmpArea</span> <span class="o">=</span> <span class="n">area</span> <span class="o">/</span> <span class="n">VRV_CONST_SQMILES_PER_SQMETER</span>
	<span class="k">elif</span> <span class="p">(</span><span class="n">fromUnits</span> <span class="o">==</span> <span class="s1">&#39;sqkm&#39;</span><span class="p">):</span>
		<span class="n">tmpArea</span> <span class="o">=</span> <span class="n">area</span> <span class="o">/</span> <span class="n">VRV_CONST_SQKM_PER_SQMETER</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">tmpArea</span> <span class="o">=</span> <span class="n">area</span>
	
	<span class="k">try</span><span class="p">:</span>
		<span class="n">toUnits</span> <span class="o">=</span> <span class="n">toUnits</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
	<span class="k">except</span><span class="p">:</span>
		<span class="k">pass</span>
		
	<span class="c1"># Convert from square meters to desired output units:</span>
	<span class="n">toUnits</span> <span class="o">=</span> <span class="n">areaUnitsDictionary</span><span class="p">[</span><span class="n">toUnits</span><span class="p">]</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">toUnits</span> <span class="o">==</span> <span class="s1">&#39;sqft&#39;</span><span class="p">):</span>
		<span class="n">convArea</span> <span class="o">=</span> <span class="n">tmpArea</span> <span class="o">*</span> <span class="n">VRV_CONST_SQFT_PER_SQMETER</span> 
	<span class="k">elif</span> <span class="p">(</span><span class="n">toUnits</span> <span class="o">==</span> <span class="s1">&#39;sqmi&#39;</span><span class="p">):</span>
		<span class="n">convArea</span> <span class="o">=</span> <span class="n">tmpArea</span> <span class="o">*</span> <span class="n">VRV_CONST_SQMILES_PER_SQMETER</span>
	<span class="k">elif</span> <span class="p">(</span><span class="n">toUnits</span> <span class="o">==</span> <span class="s1">&#39;sqkm&#39;</span><span class="p">):</span>
		<span class="n">convArea</span> <span class="o">=</span> <span class="n">tmpArea</span> <span class="o">*</span> <span class="n">VRV_CONST_SQFT_PER_SQMETER</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">convArea</span> <span class="o">=</span> <span class="n">tmpArea</span>
	
	<span class="k">return</span> <span class="n">convArea</span></div>

<div class="viewcode-block" id="lengthFromNodeSeq"><a class="viewcode-back" href="../../veroviz.utilities.html#veroviz.utilities.lengthFromNodeSeq">[docs]</a><span class="k">def</span> <span class="nf">lengthFromNodeSeq</span><span class="p">(</span><span class="n">nodeSeq</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lengthDict</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Calculate the total &quot;length&quot; (either in time or distance) along a path defined by a sequence of node IDs.</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	nodeSeq: list, Required</span>
<span class="sd">		An ordered list of node IDs.  These IDs must be included in the `id` column of the :ref:`Nodes` dataframe specified in the `nodes` input argument to this function. The format for `nodeSeq` is [node_id_1, node_id_2, ...].</span>
<span class="sd">	lengthDict: dictionary, Required</span>

<span class="sd">	Return</span>
<span class="sd">	------</span>
<span class="sd">	float</span>
<span class="sd">		Total length of the path.</span>

<span class="sd">	Example</span>
<span class="sd">	-------</span>
<span class="sd">	Import veroviz and check if the version is up-to-date:</span>
<span class="sd">		&gt;&gt;&gt; import veroviz as vrv</span>
<span class="sd">		&gt;&gt;&gt; vrv.checkVersion()</span>

<span class="sd">	Define some sample locations and create a nodes dataframe:</span>
<span class="sd">		&gt;&gt;&gt; locs = [[42.8871085, -78.8731949],</span>
<span class="sd">		...         [42.8888311, -78.8649649],</span>
<span class="sd">		...         [42.8802158, -78.8660787],</span>
<span class="sd">		...         [42.8845705, -78.8762794],</span>
<span class="sd">		...         [42.8908031, -78.8770140]]</span>
<span class="sd">		&gt;&gt;&gt; myNodes = vrv.createNodesFromLocs(locs=locs)</span>

<span class="sd">	Calculate time and distance matrices:</span>
<span class="sd">		&gt;&gt;&gt; [timeSecDict, distMetersDict] = vrv.getTimeDist2D(nodes = myNodes, routeType = &#39;euclidean2D&#39;, speedMPS = 15)</span>

<span class="sd">	Define a sequence of nodes to visit:</span>
<span class="sd">		&gt;&gt;&gt; nodeSeq = [1, 3, 2]</span>

<span class="sd">	Find the total travel time to visit the nodes:</span>
<span class="sd">		&gt;&gt;&gt; totalTimeSec = vrv.lengthFromNodeSeq(nodeSeq, timeSecDict)</span>
<span class="sd">		&gt;&gt;&gt; totalTimeSec</span>
<span class="sd">		128.18625959871764</span>
<span class="sd">		</span>
<span class="sd">	Find the total length of the node sequence:</span>
<span class="sd">		&gt;&gt;&gt; totalDistMeters = vrv.lengthFromNodeSeq(nodeSeq, distMetersDict)</span>
<span class="sd">		&gt;&gt;&gt; totalDistMeters</span>
<span class="sd">		1922.793893980765		</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="p">[</span><span class="n">valFlag</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">,</span> <span class="n">warningMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">valLengthFromNodeSeq</span><span class="p">(</span><span class="n">nodeSeq</span><span class="p">,</span> <span class="n">lengthDict</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">valFlag</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">errorMsg</span><span class="p">)</span>
		<span class="k">return</span>
	<span class="k">elif</span> <span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;VRV_SETTING_SHOWWARNINGMESSAGE&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">warningMsg</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">warningMsg</span><span class="p">)</span>

	<span class="n">length</span> <span class="o">=</span> <span class="mi">0</span>
	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">nodeSeq</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
		<span class="n">length</span> <span class="o">+=</span> <span class="n">lengthDict</span><span class="p">[</span><span class="n">nodeSeq</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">nodeSeq</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]]</span>
	<span class="k">return</span> <span class="n">length</span></div>

<div class="viewcode-block" id="calcPerimeter2D"><a class="viewcode-back" href="../../veroviz.utilities.html#veroviz.utilities.calcPerimeter2D">[docs]</a><span class="k">def</span> <span class="nf">calcPerimeter2D</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">closeLoop</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">distUnits</span><span class="o">=</span><span class="s1">&#39;meters&#39;</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Calculate the total geodesic distance along a path defined by [lat, lon] coordinates.</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	path: list of lists, Required, default as None</span>
<span class="sd">	A list of coordinates that form a path, in the format of [[lat, lon], [lat, lon], ...] or [[lat, lon, alt], [lat, lon, alt], ...].  If provided, altitude will be ignored.</span>
<span class="sd">	closeLoop: Boolean, Optional, default as False</span>
<span class="sd">	Indicates whether the path should be closed (i.e., connecting the last location to the first).</span>
<span class="sd">	distUnits: string, Optional, default as &#39;meters&#39;</span>
<span class="sd">	Specifies the desired distance units for the output. See :ref:`Units` for options.</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	float</span>
<span class="sd">		Total length of the path.</span>

<span class="sd">	Example</span>
<span class="sd">	-------</span>
<span class="sd">	&gt;&gt;&gt; import veroviz as vrv</span>
<span class="sd">	&gt;&gt;&gt; locs = [[42.80, -78.90, 0], [42.82, -78.92, 0], [42.84, -78.94, 0]]</span>
<span class="sd">	&gt;&gt;&gt; perimDist = vrv.calcPerimeter2D(path=locs, closeLoop=True, distUnits=&#39;mi&#39;)</span>
<span class="sd">	&gt;&gt;&gt; perimDist</span>
<span class="sd">	6.857172388864359</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="p">[</span><span class="n">valFlag</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">,</span> <span class="n">warningMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">valCalcPerimeter2D</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">closeLoop</span><span class="p">,</span> <span class="n">distUnits</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">valFlag</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">errorMsg</span><span class="p">)</span>
		<span class="k">return</span>
	<span class="k">elif</span> <span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;VRV_SETTING_SHOWWARNINGMESSAGE&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">warningMsg</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">warningMsg</span><span class="p">)</span>

	<span class="n">dist</span> <span class="o">=</span> <span class="mi">0</span>
	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
		<span class="n">dist</span> <span class="o">+=</span> <span class="n">distance2D</span><span class="p">(</span><span class="n">path</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="n">path</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">closeLoop</span><span class="p">):</span>
		<span class="n">dist</span> <span class="o">+=</span> <span class="n">distance2D</span><span class="p">(</span><span class="n">path</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="n">path</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span>

	<span class="n">dist</span> <span class="o">=</span> <span class="n">convertDistance</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="s1">&#39;meters&#39;</span><span class="p">,</span> <span class="n">distUnits</span><span class="p">)</span>

	<span class="k">return</span> <span class="n">dist</span></div>

<div class="viewcode-block" id="calcArea"><a class="viewcode-back" href="../../veroviz.utilities.html#veroviz.utilities.calcArea">[docs]</a><span class="k">def</span> <span class="nf">calcArea</span><span class="p">(</span><span class="n">poly</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Calculate the area, in square meters, of a polygon.</span>
<span class="sd">	</span>
<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	poly: list of lists, Required</span>
<span class="sd">		A polygon defined as a list of individual locations, in the form of [[lat1, lon1, alt1], [lat2, lon2, alt2], ...] or [[lat1, lon1], [lat2, lon2], ...].  If provided, altitudes will be ignored. </span>
<span class="sd">		</span>
<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	float</span>
<span class="sd">	Area, in meters, of the polygon.</span>
<span class="sd">	</span>
<span class="sd">	Example</span>
<span class="sd">	-------</span>
<span class="sd">	Import veroviz and check if the version is up-to-date:</span>
<span class="sd">		&gt;&gt;&gt; import veroviz as vrv</span>
<span class="sd">		&gt;&gt;&gt; vrv.checkVersion()</span>
<span class="sd">	</span>
<span class="sd">	Define a sequence of locations:</span>
<span class="sd">		&gt;&gt;&gt; locs = [[42.82, -78.80, 0], [42.86, -78.82, 0], [42.84, -78.84, 0]]</span>

<span class="sd">	Calculate the area of the polygon formed by these locations:</span>
<span class="sd">		&gt;&gt;&gt; area = vrv.calcArea(poly=locs)</span>
<span class="sd">		&gt;&gt;&gt; area	</span>
<span class="sd">		5449365.537915299</span>
<span class="sd">	</span>
<span class="sd">	Draw the polygon:</span>
<span class="sd">		&gt;&gt;&gt; myNodes = vrv.createNodesFromLocs(locs)</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletPolygon(points=locs, fillColor=&#39;red&#39;)</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.createLeaflet(mapObject=myMap, nodes=myNodes)</span>
<span class="sd">		&gt;&gt;&gt; myMap		</span>
<span class="sd">	&quot;&quot;&quot;</span>
	
	<span class="p">[</span><span class="n">valFlag</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">,</span> <span class="n">warningMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">valCalcArea</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">valFlag</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">errorMsg</span><span class="p">)</span>
		<span class="k">return</span>
	<span class="k">elif</span> <span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;VRV_SETTING_SHOWWARNINGMESSAGE&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">warningMsg</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">warningMsg</span><span class="p">)</span>
			
	<span class="n">area</span> <span class="o">=</span> <span class="n">geoAreaOfPolygon</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>
	
	<span class="k">return</span> <span class="n">area</span>		</div>

<div class="viewcode-block" id="initDataframe"><a class="viewcode-back" href="../../veroviz.utilities.html#veroviz.utilities.initDataframe">[docs]</a><span class="k">def</span> <span class="nf">initDataframe</span><span class="p">(</span><span class="n">dataframeType</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Return an empty dataframe of a given type.</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	dataframeType: string, Required</span>
<span class="sd">		The options are &#39;Nodes&#39;, &#39;Arcs&#39;, and &#39;Assignments&#39;.  These options are case insensitive.</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	pandas.dataframe</span>
<span class="sd">		A dataframe of the given type.  See :ref:`Nodes`, :ref:`Arcs`, and :ref:`Assignments` for details on each dataframe type.</span>

<span class="sd">	Example</span>
<span class="sd">	-------</span>
<span class="sd">		&gt;&gt;&gt; import veroviz as vrv</span>
<span class="sd">		&gt;&gt;&gt; newNodes = vrv.initDataframe(&#39;Nodes&#39;)</span>
<span class="sd">		&gt;&gt;&gt; newNodes</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="c1"># validation</span>
	<span class="p">[</span><span class="n">valFlag</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">,</span> <span class="n">warningMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">valInitDataframe</span><span class="p">(</span><span class="n">dataframeType</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">valFlag</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">errorMsg</span><span class="p">)</span>
		<span class="k">return</span>
	<span class="k">elif</span> <span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;VRV_SETTING_SHOWWARNINGMESSAGE&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">warningMsg</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">warningMsg</span><span class="p">)</span>

	<span class="k">return</span> <span class="n">privInitDataframe</span><span class="p">(</span><span class="n">dataframeType</span><span class="p">)</span></div>
	
	
<div class="viewcode-block" id="getMapBoundary"><a class="viewcode-back" href="../../veroviz.utilities.html#veroviz.utilities.getMapBoundary">[docs]</a><span class="k">def</span> <span class="nf">getMapBoundary</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">arcs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">locs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Find the smallest rectangle that encloses a collection of nodes, arcs, assignments, and/or locations.  This function returns a list of lists, of the form [minLat, maxLon], [maxLat, minLon]].  This is equivalent to finding the southeast and northwest corners of the rectangle.</span>
<span class="sd">	</span>
<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	nodes: :ref:`Nodes`, Conditional, `nodes`, `arcs`, and `locs` cannot be None at the same time</span>
<span class="sd">		A :ref:`Nodes` dataframe.</span>
<span class="sd">	arcs: :ref:`Arcs` or :ref:`Assignments`, Conditional, `nodes`, `arcs`, and `locs` cannot be None at the same time</span>
<span class="sd">		An :ref:`Arcs` or :ref:`Assignments` dataframe.</span>
<span class="sd">	locs: list of lists, Conditional, `nodes`, `arcs`, and `locs` cannot be None at the same time</span>
<span class="sd">		A list of individual locations, in the form of [[lat1, lon1, alt1], [lat2, lon2, alt2], ...] or [[lat1, lon1], [lat2, lon2], ...].  If provided, altitudes will be ignored.  </span>
<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	list of lists</span>
<span class="sd">		In form of [[minLat, maxLon], [maxLat, minLon]].  These two points denote the southeast and northwest corners of the boundary rectangle.</span>

<span class="sd">	Example</span>
<span class="sd">	-------</span>
<span class="sd">		&gt;&gt;&gt; import veroviz as vrv</span>
<span class="sd">		&gt;&gt;&gt;</span>
<span class="sd">		&gt;&gt;&gt; # Create 3 nodes, with blue pin markers (default):</span>
<span class="sd">		&gt;&gt;&gt; myNodes = vrv.createNodesFromLocs(</span>
<span class="sd">		...     locs = [[42.1343, -78.1234], </span>
<span class="sd">		...             [42.5323, -78.2534], </span>
<span class="sd">		...             [42.9812, -78.1353]])</span>
<span class="sd">		&gt;&gt;&gt; </span>
<span class="sd">		&gt;&gt;&gt; # Create 1 arc, with orange arrows (default):</span>
<span class="sd">		&gt;&gt;&gt; myArc = vrv.createArcsFromLocSeq(locSeq = [[42.62, -78.20], </span>
<span class="sd">		...                                            [42.92, -78.30]])</span>
<span class="sd">		&gt;&gt;&gt; </span>
<span class="sd">		&gt;&gt;&gt; # Define 2 locations, with altitude.  (We&#39;ll color these purple later):</span>
<span class="sd">		&gt;&gt;&gt; myLocs = [[42.03, -78.26, 100], [42.78, -78.25, 200]] </span>
<span class="sd">		&gt;&gt;&gt;</span>
<span class="sd">		&gt;&gt;&gt; # Find the boundary of these objects:</span>
<span class="sd">		&gt;&gt;&gt; myBoundary = vrv.getMapBoundary(nodes = myNodes,</span>
<span class="sd">		...                                 arcs  = myArc,</span>
<span class="sd">		...                                 locs  = myLocs)</span>
<span class="sd">		&gt;&gt;&gt; myBoundary</span>
<span class="sd">		[[42.03, -78.1234], [42.9812, -78.3]]</span>
<span class="sd">		</span>
<span class="sd">		&gt;&gt;&gt; # Initialize a map with nodes (blue) and an arc (orange):</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.createLeaflet(nodes = myNodes, </span>
<span class="sd">		...                           arcs  = myArc)</span>
<span class="sd">		&gt;&gt;&gt;</span>
<span class="sd">		&gt;&gt;&gt; # Add red (default) circle markers for the locations:</span>
<span class="sd">		&gt;&gt;&gt; for i in range(0, len(myLocs)):</span>
<span class="sd">		...    myMap = vrv.addLeafletMarker(mapObject = myMap, </span>
<span class="sd">		...                                 center    = myLocs[i])    </span>
<span class="sd">		&gt;&gt;&gt;</span>
<span class="sd">		&gt;&gt;&gt; # Convert myBoundary to a 4-point polygon:</span>
<span class="sd">		&gt;&gt;&gt; myBoundingRegion = [myBoundary[0], </span>
<span class="sd">		...                     [myBoundary[0][0], myBoundary[1][1]], </span>
<span class="sd">		...                     myBoundary[1], </span>
<span class="sd">		...                     [myBoundary[1][0], myBoundary[0][1]]]</span>
<span class="sd">		&gt;&gt;&gt;</span>
<span class="sd">		&gt;&gt;&gt; # Add the bounding region to the map:</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.createLeaflet(mapObject      = myMap, </span>
<span class="sd">		...                           boundingRegion = myBoundingRegion)</span>
<span class="sd">		&gt;&gt;&gt; # Display the map:</span>
<span class="sd">		&gt;&gt;&gt; myMap</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="c1"># validation</span>
	<span class="p">[</span><span class="n">valFlag</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">,</span> <span class="n">warningMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">valGetMapBoundary</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="n">arcs</span><span class="p">,</span> <span class="n">locs</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">valFlag</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">errorMsg</span><span class="p">)</span>
		<span class="k">return</span>
	<span class="k">elif</span> <span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;VRV_SETTING_SHOWWARNINGMESSAGE&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">warningMsg</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">warningMsg</span><span class="p">)</span>

	<span class="k">return</span> <span class="n">privGetMapBoundary</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="n">arcs</span><span class="p">,</span> <span class="n">locs</span><span class="p">)</span></div>


<div class="viewcode-block" id="convertMatricesDataframeToDictionary"><a class="viewcode-back" href="../../veroviz.utilities.html#veroviz.utilities.convertMatricesDataframeToDictionary">[docs]</a><span class="k">def</span> <span class="nf">convertMatricesDataframeToDictionary</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	This function is intended for use with time/distance matrices, which are stored in veroviz as Python dictionaries. This function transforms a matrix dataframe into  a dictionary, such that the indices of columns and rows become a tuple key for the dictionary.</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	dataframe: pandas.dataframe, Required</span>
<span class="sd">		The rows and columns are both integers. There should not be duplicated origin/destination pairs.</span>

<span class="sd">	Return</span>
<span class="sd">	------</span>
<span class="sd">	dictionary</span>
<span class="sd">		The keys are tuples of (originIndex, destinationIndex)</span>

<span class="sd">	Note</span>
<span class="sd">	----</span>
<span class="sd">	Pandas dataframes can be confusing when used with time and distance matrices.  In particular, suppose you have a distance dataframe named `distDF`.  The value of `distDF[1][2]` will actually return the distance from 2 to 1.  Conversely, if you have a distance dictionary named `distDict`, the value of `distDict[1,2]` will be the distance from 1 to 2.</span>
<span class="sd">	</span>
<span class="sd">	Example</span>
<span class="sd">	-------</span>
<span class="sd">	Prepare some data.</span>
<span class="sd">		&gt;&gt;&gt; import veroviz as vrv</span>
<span class="sd">		&gt;&gt;&gt; locs = [</span>
<span class="sd">		...     [42.1538, -78.4253], </span>
<span class="sd">		...     [42.3465, -78.6234], </span>
<span class="sd">		...     [42.6343, -78.1146]]</span>
<span class="sd">		&gt;&gt;&gt; exampleNodes = vrv.createNodesFromLocs(locs=locs)</span>
<span class="sd">		&gt;&gt;&gt; [timeDict, distDict] = vrv.getTimeDist2D(</span>
<span class="sd">		...     nodes        = exampleNodes, </span>
<span class="sd">		...     routeType    = &#39;fastest&#39;, </span>
<span class="sd">		...     dataProvider = &#39;OSRM-online&#39;)</span>
<span class="sd">		&gt;&gt;&gt; [timeDict]</span>
<span class="sd">		[{(1, 1): 0.0,</span>
<span class="sd">		  (1, 2): 2869.9,</span>
<span class="sd">		  (1, 3): 4033.9,</span>
<span class="sd">		  (2, 1): 2853.3,</span>
<span class="sd">		  (2, 2): 0.0,</span>
<span class="sd">		  (2, 3): 4138.2,</span>
<span class="sd">		  (3, 1): 4037.8,</span>
<span class="sd">		  (3, 2): 4055.4,</span>
<span class="sd">		  (3, 3): 0.0}]</span>

<span class="sd">		&gt;&gt;&gt; print(&quot;The travel time from node 1 to node 2 is %.2f seconds&quot; % (timeDict[1, 2]))</span>
<span class="sd">		The travel time from node 1 to node 2 is 2869.90 seconds</span>

<span class="sd">		</span>
<span class="sd">	timeDict is a dictionary.  Convert to a dataframe:</span>
<span class="sd">		&gt;&gt;&gt; timeDF = vrv.convertMatricesDictionaryToDataframe(timeDict)</span>
<span class="sd">		&gt;&gt;&gt; timeDF</span>

<span class="sd">		&gt;&gt;&gt; # NOTE:  The travel time from 1 to 2 is NOT found by timeDF[1][2].</span>
<span class="sd">		&gt;&gt;&gt; # INSTEAD, you must use timeDF[2][1]</span>
<span class="sd">		&gt;&gt;&gt; # Pandas uses the form timeDF[COLUMN_INDEX][ROW_INDEX]</span>
<span class="sd">		&gt;&gt;&gt; timeDF[1][2], timeDF[2][1], timeDict[1, 2], timeDict[2, 1]</span>
<span class="sd">		(2853.3, 2869.9, 2869.9, 2853.3)</span>


<span class="sd">	We can transform a dataframe into a dictionary</span>
<span class="sd">		&gt;&gt;&gt; timeDict2 = vrv.convertMatricesDataframeToDictionary(timeDF)</span>
<span class="sd">		&gt;&gt;&gt; timeDict2</span>
<span class="sd">		&gt;&gt;&gt; # This should be the same as `timeDict`</span>
<span class="sd">		{(1, 1): 0.0,</span>
<span class="sd">		 (1, 2): 2869.9,</span>
<span class="sd">		 (1, 3): 4033.9,</span>
<span class="sd">		 (2, 1): 2853.3,</span>
<span class="sd">		 (2, 2): 0.0,</span>
<span class="sd">		 (2, 3): 4138.2,</span>
<span class="sd">		 (3, 1): 4037.8,</span>
<span class="sd">		 (3, 2): 4055.4,</span>
<span class="sd">		 (3, 3): 0.0}</span>

<span class="sd">		&gt;&gt;&gt; # Find the travel time *from* 1 *to* 3:</span>
<span class="sd">		&gt;&gt;&gt; timeDict2[1,3]</span>
<span class="sd">		4033.9</span>
<span class="sd">		</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="c1"># Make sure an input argument was provided</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">dataframe</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
		<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: dataframe is missing as an input to function `convertMatricesDataframeToDictionary()`.&quot;</span><span class="p">)</span>		
		<span class="k">return</span>

	<span class="c1"># Make sure the input is a dataframe</span>
	<span class="k">if</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">dataframe</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
		<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: The input to function `convertMatricesDataframeToDictionary()` must be a pandas dataframe.&quot;</span><span class="p">)</span>		
		<span class="k">return</span>
	
	<span class="n">dictionary</span> <span class="o">=</span> <span class="p">{}</span>
	<span class="k">try</span><span class="p">:</span>
		<span class="p">(</span><span class="n">rowNum</span><span class="p">,</span> <span class="n">columnNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">shape</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rowNum</span><span class="p">):</span>
			<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">columnNum</span><span class="p">):</span>
				<span class="n">dictionary</span><span class="p">[</span><span class="n">dataframe</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span> <span class="o">=</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">dataframe</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span>
	<span class="k">except</span><span class="p">:</span>
		<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: Duplicated key values, please check the columns and rows of dataframe&quot;</span><span class="p">)</span>

	<span class="k">return</span> <span class="n">dictionary</span></div>

<div class="viewcode-block" id="convertMatricesDictionaryToDataframe"><a class="viewcode-back" href="../../veroviz.utilities.html#veroviz.utilities.convertMatricesDictionaryToDataframe">[docs]</a><span class="k">def</span> <span class="nf">convertMatricesDictionaryToDataframe</span><span class="p">(</span><span class="n">dictionary</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	This function is intended for use with time/distance matrices, which are stored in veroviz as Python dictionaries. This function transforms a matrix dictionary into a pandas dataframe.  The dictionary is assumed to have 2-tuple indices (the first index represents the ID of the &quot;from&quot; location, the second index is the ID of the &quot;to&quot; location).  In the resulting pandas dataframe, the row indices will represent the &quot;from&quot; location, the column indices the &quot;to&quot; location.</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	dictionary: </span>
<span class="sd">		The keys are tuples of (originIndex, destinationIndex) format.</span>

<span class="sd">	Return</span>
<span class="sd">	------</span>
<span class="sd">	pandas.dataframe</span>
<span class="sd">		The keys in the dictionary should be 2-tuples, the first value will be a row index, the second value will be a column index.</span>

<span class="sd">	Note</span>
<span class="sd">	----</span>
<span class="sd">	Pandas dataframes can be confusing when used with time and distance matrices.  In particular, suppose you have a distance dataframe named `distDF`.  The value of `distDF[1][2]` will actually return the distance from 2 to 1.  Conversely, if you have a distance dictionary named `distDict`, the value of `distDict[1,2]` will be the distance from 1 to 2.</span>
<span class="sd">	</span>
<span class="sd">	Example</span>
<span class="sd">	-------</span>
<span class="sd">	Prepare some data.</span>
<span class="sd">		&gt;&gt;&gt; import veroviz as vrv</span>
<span class="sd">		&gt;&gt;&gt; locs = [</span>
<span class="sd">		...     [42.1538, -78.4253], </span>
<span class="sd">		...     [42.3465, -78.6234], </span>
<span class="sd">		...     [42.6343, -78.1146]]</span>
<span class="sd">		&gt;&gt;&gt; exampleNodes = vrv.createNodesFromLocs(locs=locs)</span>
<span class="sd">		&gt;&gt;&gt; [timeDict, distDict] = vrv.getTimeDist2D(</span>
<span class="sd">		...     nodes        = exampleNodes, </span>
<span class="sd">		...     routeType    = &#39;fastest&#39;, </span>
<span class="sd">		...     dataProvider = &#39;OSRM-online&#39;)</span>
<span class="sd">		&gt;&gt;&gt; [timeDict]</span>
<span class="sd">		[{(1, 1): 0.0,</span>
<span class="sd">		  (1, 2): 2869.9,</span>
<span class="sd">		  (1, 3): 4033.9,</span>
<span class="sd">		  (2, 1): 2853.3,</span>
<span class="sd">		  (2, 2): 0.0,</span>
<span class="sd">		  (2, 3): 4138.2,</span>
<span class="sd">		  (3, 1): 4037.8,</span>
<span class="sd">		  (3, 2): 4055.4,</span>
<span class="sd">		  (3, 3): 0.0}]</span>

<span class="sd">		&gt;&gt;&gt; print(&quot;The travel time from node 1 to node 2 is %.2f seconds&quot; % (timeDict[1, 2]))</span>
<span class="sd">		The travel time from node 1 to node 2 is 2869.90 seconds</span>

<span class="sd">		</span>
<span class="sd">	timeDict is a dictionary.  Convert to a dataframe:</span>
<span class="sd">		&gt;&gt;&gt; timeDF = vrv.convertMatricesDictionaryToDataframe(timeDict)</span>
<span class="sd">		&gt;&gt;&gt; timeDF</span>

<span class="sd">		&gt;&gt;&gt; # NOTE:  The travel time from 1 to 2 is NOT found by timeDF[1][2].</span>
<span class="sd">		&gt;&gt;&gt; # INSTEAD, you must use timeDF[2][1]</span>
<span class="sd">		&gt;&gt;&gt; # Pandas uses the form timeDF[COLUMN_INDEX][ROW_INDEX]</span>
<span class="sd">		&gt;&gt;&gt; timeDF[1][2], timeDF[2][1], timeDict[1, 2], timeDict[2, 1]</span>
<span class="sd">		(2853.3, 2869.9, 2869.9, 2853.3)</span>


<span class="sd">	We can transform a dataframe into a dictionary</span>
<span class="sd">		&gt;&gt;&gt; timeDict2 = vrv.convertMatricesDataframeToDictionary(timeDF)</span>
<span class="sd">		&gt;&gt;&gt; timeDict2</span>
<span class="sd">		&gt;&gt;&gt; # This should be the same as `timeDict`</span>
<span class="sd">		{(1, 1): 0.0,</span>
<span class="sd">		 (1, 2): 2869.9,</span>
<span class="sd">		 (1, 3): 4033.9,</span>
<span class="sd">		 (2, 1): 2853.3,</span>
<span class="sd">		 (2, 2): 0.0,</span>
<span class="sd">		 (2, 3): 4138.2,</span>
<span class="sd">		 (3, 1): 4037.8,</span>
<span class="sd">		 (3, 2): 4055.4,</span>
<span class="sd">		 (3, 3): 0.0}</span>

<span class="sd">		&gt;&gt;&gt; # Find the travel time *from* 1 *to* 3:</span>
<span class="sd">		&gt;&gt;&gt; timeDict2[1,3]</span>
<span class="sd">		4033.9</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="c1"># Make sure an input argument was provided</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">dictionary</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
		<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: dictionary is missing as an input to function `convertMatricesDictionaryToDataframe()`.&quot;</span><span class="p">)</span>		
		<span class="k">return</span>

	<span class="c1"># Make sure the input is a dictionary</span>
	<span class="k">if</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">dictionary</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">dict</span><span class="p">):</span>
		<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: The input to function `convertMatricesDictionaryToDataframe()` must be a python dictionary.&quot;</span><span class="p">)</span>		
		<span class="k">return</span>


	<span class="n">rows</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="n">columns</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="n">keys</span> <span class="o">=</span> <span class="n">dictionary</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>

	<span class="k">for</span> <span class="n">keys</span> <span class="ow">in</span> <span class="n">dictionary</span><span class="p">:</span>
		<span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">):</span>
			<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: This dictionary is not a legitimate matrix, the key values should be pairs.&quot;</span><span class="p">)</span>
			<span class="k">return</span>

	<span class="k">try</span><span class="p">:</span>
		<span class="k">for</span> <span class="n">keys</span> <span class="ow">in</span> <span class="n">dictionary</span><span class="p">:</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">):</span>
				<span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">keys</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">):</span>
				<span class="n">columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">keys</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
		<span class="n">rows</span> <span class="o">=</span> <span class="n">rows</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
		<span class="n">columns</span> <span class="o">=</span> <span class="n">columns</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

		<span class="n">dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">rows</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">keys</span> <span class="ow">in</span> <span class="n">dictionary</span><span class="p">:</span>
			<span class="n">dataframe</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">keys</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">dictionary</span><span class="p">[</span><span class="n">keys</span><span class="p">]</span>
		
	<span class="k">except</span><span class="p">:</span>
		<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: Failed to convert dictionary to dataframe.&quot;</span><span class="p">)</span>

	<span class="k">return</span> <span class="n">dataframe</span></div>

<div class="viewcode-block" id="exportDataToCSV"><a class="viewcode-back" href="../../veroviz.utilities.html#veroviz.utilities.exportDataToCSV">[docs]</a><span class="k">def</span> <span class="nf">exportDataToCSV</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Export a dataframe or python time/distance matrix dictionary to a `.csv` file.</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	data: pandas.dataframe or dictionary</span>
<span class="sd">		The data to be exported.  This can be a :ref:`Nodes`, :ref:`Arcs`, or :ref:`Assignments` dataframe, or it can be a time/distance python dictionary.</span>
<span class="sd">	filename: string</span>
<span class="sd">		The path and name of file to be exported.</span>

<span class="sd">	Examples</span>
<span class="sd">	--------</span>
<span class="sd">	The following examples will be the same as examples in :meth:`~veroviz.utilities.importDataFromCSV`.</span>

<span class="sd">	Import veroviz and check if it is the latest version:</span>
<span class="sd">		&gt;&gt;&gt; import veroviz as vrv</span>
<span class="sd">		&gt;&gt;&gt; vrv.checkVersion()</span>

<span class="sd">	Create a nodes dataframe:</span>
<span class="sd">		&gt;&gt;&gt; nodesDF = vrv.createNodesFromLocs(</span>
<span class="sd">		...              locs = [[42.1538, -78.4253], </span>
<span class="sd">		...                      [42.3465, -78.6234], </span>
<span class="sd">		...                      [42.6343, -78.1146]])</span>
<span class="sd">		&gt;&gt;&gt; nodesDF	</span>

<span class="sd">	Save the nodesDF dataframe as a .csv file in a subdirectory named &quot;test&quot;:</span>
<span class="sd">		&gt;&gt;&gt; vrv.exportDataToCSV(data = nodesDF, filename = &#39;test/nodes.csv&#39;)</span>
<span class="sd">	</span>
<span class="sd">	Import the dataframe we just saved:</span>
<span class="sd">		&gt;&gt;&gt; importedNodes = vrv.importDataFromCSV(</span>
<span class="sd">		...     dataType = &#39;nodes&#39;,</span>
<span class="sd">		...     filename = &#39;test/nodes.csv&#39;)</span>
<span class="sd">		&gt;&gt;&gt; importedNodes</span>

<span class="sd">	If the data type is inconsistent with the data, an error message will be thrown and nothing will be imported.</span>
<span class="sd">		&gt;&gt;&gt; importedArcs = vrv.importDataFromCSV(</span>
<span class="sd">		...     dataType = &#39;arcs&#39;, </span>
<span class="sd">		...     filename = &#39;test/nodes.csv&#39;)</span>
<span class="sd">		Error: test/nodes.csv was not successfully imported.  Check the data type.</span>

<span class="sd">	Similarly we can import and export the &#39;arcs&#39; and &#39;assignments&#39; dataframe</span>

<span class="sd">	For time/distance matrices, they are saved as dictionaries in VeRoViz, here is an example of how to import/export them.</span>

<span class="sd">	Get travel time/distance matrices using the nodes we just created:</span>
<span class="sd">		&gt;&gt;&gt; [timeDict, distDict] = vrv.getTimeDist2D(</span>
<span class="sd">		...           nodes        = nodesDF, </span>
<span class="sd">		...           routeType    = &#39;fastest&#39;, </span>
<span class="sd">		...           dataProvider = &#39;OSRM-online&#39;)</span>
<span class="sd">		&gt;&gt;&gt; timeDict</span>
<span class="sd">		{(1, 1): 0.0,</span>
<span class="sd">		 (1, 2): 2869.9,</span>
<span class="sd">		 (1, 3): 4033.9,</span>
<span class="sd">		 (2, 1): 2853.3,</span>
<span class="sd">		 (2, 2): 0.0,</span>
<span class="sd">		 (2, 3): 4138.2,</span>
<span class="sd">		 (3, 1): 4037.8,</span>
<span class="sd">		 (3, 2): 4055.4,</span>
<span class="sd">		 (3, 3): 0.0}</span>

<span class="sd">	Export the time dictionary to a .csv file in a subdirectory named &quot;test&quot;:</span>
<span class="sd">		&gt;&gt;&gt; vrv.exportDataToCSV(data = timeDict, filename = &#39;test/timeMatrix.csv&#39;)</span>

<span class="sd">	Import the saved dictionary</span>
<span class="sd">		&gt;&gt;&gt; importedTime = vrv.importDataFromCSV(</span>
<span class="sd">		...     dataType = &#39;matrix&#39;,</span>
<span class="sd">		...     filename = &#39;test/timeMatrix.csv&#39;)</span>
<span class="sd">		&gt;&gt;&gt; importedTime</span>
<span class="sd">		{(1, 1): 0.0,</span>
<span class="sd">		 (1, 2): 2869.9,</span>
<span class="sd">		 (1, 3): 4033.9,</span>
<span class="sd">		 (2, 1): 2853.3,</span>
<span class="sd">		 (2, 2): 0.0,</span>
<span class="sd">		 (2, 3): 4138.2,</span>
<span class="sd">		 (3, 1): 4037.8,</span>
<span class="sd">		 (3, 2): 4055.4,</span>
<span class="sd">		 (3, 3): 0.0}</span>

<span class="sd">	&quot;&quot;&quot;</span>

	<span class="c1"># Make sure both input args are provided:</span>
	<span class="k">if</span> <span class="p">((</span><span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">filename</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)):</span>
		<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: 1 or more of the 2 required input parameters to function `exportDataToCSV()` are missing.&quot;</span><span class="p">)</span>
		<span class="k">return</span>
	
	<span class="c1"># Replace backslash</span>
	<span class="n">filename</span> <span class="o">=</span> <span class="n">replaceBackslashToSlash</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

	<span class="k">if</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">str</span><span class="p">):</span>
		<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: filename should be a string, please check the inputs.&quot;</span><span class="p">)</span>
		<span class="k">return</span>

	<span class="c1"># Get directory</span>
	<span class="k">if</span> <span class="p">(</span><span class="s2">&quot;/&quot;</span> <span class="ow">in</span> <span class="n">filename</span><span class="p">):</span>
		<span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
		<span class="n">pathList</span> <span class="o">=</span> <span class="n">filename</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pathList</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
			<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pathList</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
				<span class="n">path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="n">pathList</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
				<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

	<span class="c1"># Exporting</span>
	<span class="k">if</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="ow">is</span> <span class="n">pd</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
		<span class="n">dataframe</span> <span class="o">=</span> <span class="n">data</span>
		<span class="n">dataframe</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">path_or_buf</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
	<span class="k">elif</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">):</span>
		<span class="n">dataframe</span> <span class="o">=</span> <span class="n">convertMatricesDictionaryToDataframe</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
		<span class="n">dataframe</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">path_or_buf</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;VRV_SETTING_SHOWOUTPUTMESSAGE&#39;</span><span class="p">]):</span>
		<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Message: Data written to </span><span class="si">%s</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">filename</span><span class="p">))</span>

	<span class="k">return</span></div>

<div class="viewcode-block" id="importDataFromCSV"><a class="viewcode-back" href="../../veroviz.utilities.html#veroviz.utilities.importDataFromCSV">[docs]</a><span class="k">def</span> <span class="nf">importDataFromCSV</span><span class="p">(</span><span class="n">dataType</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Import from a `.csv` file into a dataframe or python time/distance matrix dictionary.</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	dataType: string, Required</span>
<span class="sd">		The type of data to be imported.  Valid options are &#39;nodes&#39;, &#39;arcs&#39;, &#39;assignments&#39;, or &#39;matrix&#39;.</span>
<span class="sd">	filename: string, Required</span>
<span class="sd">		The path and the name of the file to be imported.</span>

<span class="sd">	Return</span>
<span class="sd">	------</span>
<span class="sd">	pandas.dataframe or dictionary</span>
<span class="sd">		The resulting object depends on the data that are imported.  If the data are &#39;nodes&#39;, &#39;arcs&#39; or &#39;assignments&#39;, return pandas.dataframe; otherwise, if the data are &#39;matrix&#39;, return dictionary.</span>

<span class="sd">	Examples</span>
<span class="sd">	--------</span>
<span class="sd">	The following examples will be the same as examples in :meth:`~veroviz.utilities.exportDataToCSV`</span>

<span class="sd">	Import veroviz and check if it is the latest version:</span>
<span class="sd">		&gt;&gt;&gt; import veroviz as vrv</span>
<span class="sd">		&gt;&gt;&gt; vrv.checkVersion()</span>

<span class="sd">	Create a nodes dataframe:</span>
<span class="sd">		&gt;&gt;&gt; nodesDF = vrv.createNodesFromLocs(</span>
<span class="sd">		...              locs = [[42.1538, -78.4253], </span>
<span class="sd">		...                      [42.3465, -78.6234], </span>
<span class="sd">		...                      [42.6343, -78.1146]])</span>
<span class="sd">		&gt;&gt;&gt; nodesDF	</span>

<span class="sd">	Save the nodesDF dataframe as a .csv file in a subdirectory named &quot;test&quot;:</span>
<span class="sd">		&gt;&gt;&gt; vrv.exportDataToCSV(data = nodesDF, filename = &#39;test/nodes.csv&#39;)</span>
<span class="sd">	</span>
<span class="sd">	Import the dataframe we just saved:</span>
<span class="sd">		&gt;&gt;&gt; importedNodes = vrv.importDataFromCSV(</span>
<span class="sd">		...     dataType = &#39;nodes&#39;,</span>
<span class="sd">		...     filename = &#39;test/nodes.csv&#39;)</span>
<span class="sd">		&gt;&gt;&gt; importedNodes</span>

<span class="sd">	If the data type is inconsistent with the data, an error message will be thrown and nothing will be imported.</span>
<span class="sd">		&gt;&gt;&gt; importedArcs = vrv.importDataFromCSV(</span>
<span class="sd">		...     dataType = &#39;arcs&#39;, </span>
<span class="sd">		...     filename = &#39;test/nodes.csv&#39;)</span>
<span class="sd">		Error: test/nodes.csv was not successfully imported.  Check the data type.</span>

<span class="sd">	Similarly we can import and export the &#39;arcs&#39; and &#39;assignments&#39; dataframe</span>

<span class="sd">	For time/distance matrices, they are saved as dictionaries in VeRoViz, here is an example of how to import/export them.</span>

<span class="sd">	Get travel time/distance matrices using the nodes we just created:</span>
<span class="sd">		&gt;&gt;&gt; [timeDict, distDict] = vrv.getTimeDist2D(</span>
<span class="sd">		...           nodes        = nodesDF, </span>
<span class="sd">		...           routeType    = &#39;fastest&#39;, </span>
<span class="sd">		...           dataProvider = &#39;OSRM-online&#39;)</span>
<span class="sd">		&gt;&gt;&gt; timeDict</span>
<span class="sd">		{(1, 1): 0.0,</span>
<span class="sd">		 (1, 2): 2869.9,</span>
<span class="sd">		 (1, 3): 4033.9,</span>
<span class="sd">		 (2, 1): 2853.3,</span>
<span class="sd">		 (2, 2): 0.0,</span>
<span class="sd">		 (2, 3): 4138.2,</span>
<span class="sd">		 (3, 1): 4037.8,</span>
<span class="sd">		 (3, 2): 4055.4,</span>
<span class="sd">		 (3, 3): 0.0}</span>

<span class="sd">	Export the time dictionary to a .csv file in a subdirectory named &quot;test&quot;:</span>
<span class="sd">		&gt;&gt;&gt; vrv.exportDataToCSV(data = timeDict, filename = &#39;test/timeMatrix.csv&#39;)</span>

<span class="sd">	Import the saved dictionary</span>
<span class="sd">		&gt;&gt;&gt; importedTime = vrv.importDataFromCSV(</span>
<span class="sd">		...     dataType = &#39;matrix&#39;,</span>
<span class="sd">		...     filename = &#39;test/timeMatrix.csv&#39;)</span>
<span class="sd">		&gt;&gt;&gt; importedTime</span>
<span class="sd">		{(1, 1): 0.0,</span>
<span class="sd">		 (1, 2): 2869.9,</span>
<span class="sd">		 (1, 3): 4033.9,</span>
<span class="sd">		 (2, 1): 2853.3,</span>
<span class="sd">		 (2, 2): 0.0,</span>
<span class="sd">		 (2, 3): 4138.2,</span>
<span class="sd">		 (3, 1): 4037.8,</span>
<span class="sd">		 (3, 2): 4055.4,</span>
<span class="sd">		 (3, 3): 0.0}</span>

<span class="sd">	&quot;&quot;&quot;</span>

	<span class="c1"># Make sure both input args are provided:</span>
	<span class="k">if</span> <span class="p">((</span><span class="n">dataType</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">filename</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)):</span>
		<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: 1 or more of the 2 required input parameters to function `importDataFromCSV()` are missing.&quot;</span><span class="p">)</span>
		<span class="k">return</span>

	<span class="c1"># Replace backslash</span>
	<span class="n">filename</span> <span class="o">=</span> <span class="n">replaceBackslashToSlash</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

	<span class="k">if</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">str</span><span class="p">):</span>
		<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: filename should be a string, please check the inputs.&quot;</span><span class="p">)</span>
		<span class="k">return</span>

	<span class="c1"># validation - The validation of this script is different from others</span>
	<span class="k">try</span><span class="p">:</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">dataType</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;nodes&#39;</span><span class="p">,</span> <span class="s1">&#39;arcs&#39;</span><span class="p">,</span> <span class="s1">&#39;assignments&#39;</span><span class="p">}):</span>
			<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">dataType</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;nodes&#39;</span><span class="p">):</span>
				<span class="p">[</span><span class="n">valFlag</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">,</span> <span class="n">warningMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">valNodes</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">valFlag</span> <span class="ow">and</span> <span class="n">warningMsg</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
					<span class="c1"># print(&quot;Message: %s was successfully imported as Nodes dataframe&quot; % filename)</span>
					<span class="k">pass</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">  </span><span class="si">%s</span><span class="s2"> was not successfully imported.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">errorMsg</span><span class="p">,</span> <span class="n">filename</span><span class="p">))</span>
					<span class="k">return</span>
			<span class="k">elif</span> <span class="p">(</span><span class="n">dataType</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;arcs&#39;</span><span class="p">):</span>
				<span class="p">[</span><span class="n">valFlag</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">,</span> <span class="n">warningMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">valArcs</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">valFlag</span> <span class="ow">and</span> <span class="n">warningMsg</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
					<span class="c1"># print(&quot;Message: %s was successfully imported as Arcs dataframe&quot; % filename)</span>
					<span class="k">pass</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">  </span><span class="si">%s</span><span class="s2"> was not successfully imported.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">errorMsg</span><span class="p">,</span> <span class="n">filename</span><span class="p">))</span>
					<span class="k">return</span>
			<span class="k">elif</span> <span class="p">(</span><span class="n">dataType</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;assignments&#39;</span><span class="p">):</span>
				<span class="p">[</span><span class="n">valFlag</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">,</span> <span class="n">warningMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">valAssignments</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">valFlag</span> <span class="ow">and</span> <span class="n">warningMsg</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
					<span class="c1"># print(&quot;Message: %s was successfully imported as Assignments dataframe&quot; % filename)</span>
					<span class="k">pass</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">  </span><span class="si">%s</span><span class="s2"> was not successfully imported.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">errorMsg</span><span class="p">,</span> <span class="n">filename</span><span class="p">))</span>
					<span class="k">return</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="k">return</span>

		<span class="k">elif</span> <span class="p">(</span><span class="n">dataType</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;matrix&#39;</span><span class="p">):</span>
			<span class="n">dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
			<span class="n">dataframe</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
			<span class="n">data</span> <span class="o">=</span> <span class="n">convertMatricesDataframeToDictionary</span><span class="p">(</span><span class="n">dataframe</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: data type not supported.  Expected &#39;nodes&#39;, &#39;arcs&#39;, &#39;assignments&#39; or &#39;matrix&#39; (for time matrix or distance matrix)&quot;</span><span class="p">)</span>

	<span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
		<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: Cannot import file: </span><span class="si">%s</span><span class="s2">, check if `dataType` is correct for inputs.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">filename</span><span class="p">))</span>

	<span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
		<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: Cannot import file: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">filename</span><span class="p">))</span>

	<span class="k">return</span> <span class="n">data</span></div>

<div class="viewcode-block" id="exportDataframe"><a class="viewcode-back" href="../../veroviz.utilities.html#veroviz.utilities.exportDataframe">[docs]</a><span class="k">def</span> <span class="nf">exportDataframe</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Exports a nodes, arcs, or assignments dataframe to a `.csv` file.</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	dataframe: pandas.dataframe, Required</span>
<span class="sd">		The dataframe to be exported.  This can be a :ref:`Nodes`, :ref:`Arcs`, or :ref:`Assignments` dataframe.</span>
<span class="sd">	filename: string, Required</span>
<span class="sd">		The path and the name of file to be exported.</span>

<span class="sd">	Example</span>
<span class="sd">	-------	</span>
<span class="sd">	Import veroviz and check if it is the latest version:</span>
<span class="sd">		&gt;&gt;&gt; import veroviz as vrv</span>
<span class="sd">		&gt;&gt;&gt; vrv.checkVersion()</span>
<span class="sd">	</span>
<span class="sd">	Create a nodes dataframe:</span>
<span class="sd">		&gt;&gt;&gt; nodesDF = vrv.createNodesFromLocs(locs=[</span>
<span class="sd">		...     [42.1538, -78.4253], </span>
<span class="sd">		...     [42.3465, -78.6234], </span>
<span class="sd">		...     [42.6343, -78.1146]])</span>
<span class="sd">		&gt;&gt;&gt; nodesDF</span>
<span class="sd">	</span>
<span class="sd">	Save the nodesDF dataframe as a .csv file in a subdirectory named &quot;test&quot;:</span>
<span class="sd">		&gt;&gt;&gt; vrv.exportDataframe(dataframe = nodesDF, filename = &#39;test/nodes.csv&#39;)</span>
<span class="sd">	</span>
<span class="sd">	Import the saved dataframe:</span>
<span class="sd">		&gt;&gt;&gt; importedNodesDF = vrv.importDataframe(&#39;test/nodes.csv&#39;)</span>
<span class="sd">		&gt;&gt;&gt; importedNodesDF</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="c1"># Make sure both input args are provided:</span>
	<span class="k">if</span> <span class="p">((</span><span class="n">dataframe</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">filename</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)):</span>
		<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: 1 or more of the 2 required input parameters to function `exportDataframe()` are missing.&quot;</span><span class="p">)</span>
		<span class="k">return</span>

	<span class="k">return</span> <span class="n">privExportDataframe</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span></div>
	

<div class="viewcode-block" id="importDataframe"><a class="viewcode-back" href="../../veroviz.utilities.html#veroviz.utilities.importDataframe">[docs]</a><span class="k">def</span> <span class="nf">importDataframe</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">intCols</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">useIndex</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Imports a VeRoViz nodes, arcs, or assignments dataframe from a .csv file.  This function returns a pandas dataframe.</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	filename: string, Required</span>
<span class="sd">		The path and the name of the file to be imported.</span>
<span class="sd">	intCols: boolean, Optional, default as False</span>
<span class="sd">		If the dataframe column names are integers (rather than text), set `intCols` to be True.  See notes below for more information.</span>
<span class="sd">	useIndex: boolean, Optional, default as True</span>
<span class="sd">		Setting this value to True means that the first column in the .csv will be used as the row indices.</span>

<span class="sd">	Note</span>
<span class="sd">	----</span>
<span class="sd">	If the dataframe is one of the following, the column names are not integers; leave `intCols=False` (default).  Also, leave `useIndex=True` (default):</span>
<span class="sd">	</span>
<span class="sd">	- nodes</span>
<span class="sd">	- arcs</span>
<span class="sd">	- assignments</span>

<span class="sd">	If you are importing the following matrices, it is recommended to use `importDataFromCSV()` function, the return value of that function will be a dictionary for matrix.</span>

<span class="sd">	- time matrix</span>
<span class="sd">	- distance matrix</span>

<span class="sd">	Return</span>
<span class="sd">	------</span>
<span class="sd">	pandas.dataframe</span>
<span class="sd">		A dataframe constructed from the contents of the imported .csv file.</span>

<span class="sd">	Example</span>
<span class="sd">	-------	</span>
<span class="sd">	Import veroviz and check if it is the latest version:</span>
<span class="sd">		&gt;&gt;&gt; import veroviz as vrv</span>
<span class="sd">		&gt;&gt;&gt; vrv.checkVersion()</span>
<span class="sd">	</span>
<span class="sd">	Create a nodes dataframe:</span>
<span class="sd">		&gt;&gt;&gt; nodesDF = vrv.createNodesFromLocs(locs=[</span>
<span class="sd">		...     [42.1538, -78.4253], </span>
<span class="sd">		...     [42.3465, -78.6234], </span>
<span class="sd">		...     [42.6343, -78.1146]])</span>
<span class="sd">		&gt;&gt;&gt; nodesDF</span>
<span class="sd">	</span>
<span class="sd">	Save the nodesDF dataframe as a .csv file in a subdirectory named &quot;test&quot;:</span>
<span class="sd">		&gt;&gt;&gt; vrv.exportDataframe(dataframe = nodesDF, filename = &#39;test/nodes.csv&#39;)</span>
<span class="sd">	</span>
<span class="sd">	Import the saved dataframe:</span>
<span class="sd">		&gt;&gt;&gt; importedNodesDF = vrv.importDataframe(&#39;test/nodes.csv&#39;)</span>
<span class="sd">		&gt;&gt;&gt; importedNodesDF</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="c1"># Make sure filename is provided</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">filename</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
		<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: filename is missing as an input to function `importDataframe()`.&quot;</span><span class="p">)</span>
		<span class="k">return</span>

	<span class="c1"># Replace backslash</span>
	<span class="n">filename</span> <span class="o">=</span> <span class="n">replaceBackslashToSlash</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

	<span class="k">if</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">str</span><span class="p">):</span>
		<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: filename should be a string, please check the inputs.&quot;</span><span class="p">)</span>
		<span class="k">return</span>

	<span class="n">df</span> <span class="o">=</span> <span class="kc">None</span>
	
	<span class="k">try</span><span class="p">:</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">useIndex</span><span class="p">):</span>
			<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>	
		<span class="k">else</span><span class="p">:</span>
			<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>	
		<span class="k">if</span> <span class="p">(</span><span class="n">intCols</span><span class="p">):</span>
			<span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
	<span class="k">except</span><span class="p">:</span>
		<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: Cannot import </span><span class="si">%s</span><span class="s2">, please check the inputs.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">filename</span><span class="p">))</span>

	<span class="k">return</span> <span class="n">df</span></div>

<div class="viewcode-block" id="getConvexHull"><a class="viewcode-back" href="../../veroviz.utilities.html#veroviz.utilities.getConvexHull">[docs]</a><span class="k">def</span> <span class="nf">getConvexHull</span><span class="p">(</span><span class="n">locs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Find the convex hull of a set of points.</span>
<span class="sd">	</span>
<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	locs: list of lists</span>
<span class="sd">		A list of individual locations, in the form of [[lat1, lon1, alt1], [lat2, lon2, alt2], ...] or [[lat1, lon1], [lat2, lon2], ...].  If provided, altitudes will be ignored.</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	list of lists</span>
<span class="sd">		A list of lat/lon coordinates of the convex hull.  This is in the same form as the input points.</span>
<span class="sd">		</span>
<span class="sd">	Example</span>
<span class="sd">	-------</span>
<span class="sd">		&gt;&gt;&gt; # Find the convex hull of 5 locs that straddle the Prime Meridian:</span>
<span class="sd">		&gt;&gt;&gt; import veroviz as vrv</span>
<span class="sd">		&gt;&gt;&gt; locs = [[51.4865,  0.0008], </span>
<span class="sd">		...         [51.4777, -0.0002], </span>
<span class="sd">		...         [51.4801,  0.0029], </span>
<span class="sd">		...         [51.4726, -0.0161], </span>
<span class="sd">		...         [51.4752,  0.0158]]</span>
<span class="sd">		&gt;&gt;&gt; convexHull = vrv.getConvexHull(locs)</span>
<span class="sd">		&gt;&gt;&gt; convexHull</span>
<span class="sd">		[[51.4726, -0.0161], [51.4865, 0.0008], [51.4752, 0.0158]]</span>


<span class="sd">		&gt;&gt;&gt; # Display the 5 locations and the convex hull on a map:</span>
<span class="sd">		&gt;&gt;&gt; myMap = None</span>
<span class="sd">		&gt;&gt;&gt; for loc in locs:</span>
<span class="sd">		...     myMap = vrv.addLeafletMarker(mapObject=myMap, center=loc)</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletPolygon(mapObject=myMap, points=convexHull)</span>
<span class="sd">		&gt;&gt;&gt; myMap</span>
<span class="sd">	&quot;&quot;&quot;</span>
	
	<span class="c1"># FIXME -- How does this work when crossing meridians?</span>
	<span class="c1"># I did some simple tests and it seems to be OK.</span>

	<span class="p">[</span><span class="n">valFlag</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">,</span> <span class="n">warningMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">valGetConvexHull</span><span class="p">(</span><span class="n">locs</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">valFlag</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">errorMsg</span><span class="p">)</span>
		<span class="k">return</span>
	<span class="k">elif</span> <span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;VRV_SETTING_SHOWWARNINGMESSAGE&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">warningMsg</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">warningMsg</span><span class="p">)</span>

	<span class="n">locs2D</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">locs</span><span class="p">)):</span>
		<span class="n">locs2D</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">locs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">locs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]])</span>
	
	<span class="n">ch2D</span> <span class="o">=</span> <span class="p">[</span><span class="n">locs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">scipy</span><span class="o">.</span><span class="n">spatial</span><span class="o">.</span><span class="n">ConvexHull</span><span class="p">(</span><span class="n">locs2D</span><span class="p">)</span><span class="o">.</span><span class="n">vertices</span><span class="p">]</span>

	<span class="n">ch</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ch2D</span><span class="p">)):</span>
		<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">locs2D</span><span class="p">)):</span>
			<span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">ch2D</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">locs2D</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mf">0.0001</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">ch2D</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">locs2D</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mf">0.0001</span><span class="p">):</span>
				<span class="n">ch</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">locs</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>

	<span class="k">return</span> <span class="n">ch</span></div>

<div class="viewcode-block" id="isPointInPoly"><a class="viewcode-back" href="../../veroviz.utilities.html#veroviz.utilities.isPointInPoly">[docs]</a><span class="k">def</span> <span class="nf">isPointInPoly</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">poly</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Determine if a point is inside a polygon.  Points that are along the perimeter of the polygon (including vertices) are considered to be &quot;inside&quot;.</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	loc: list, Required</span>
<span class="sd">		The coordinate of the point, in either [lat, lon] or [lat, lon, alt] format.  If provided, the altitude will be ignored.</span>
<span class="sd">	poly: list of lists, Required</span>
<span class="sd">		A polygon defined as a list of individual locations, in the form of [[lat1, lon1, alt1], [lat2, lon2, alt2], ...] or [[lat1, lon1], [lat2, lon2], ...].  If provided, altitudes will be ignored. </span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	boolean</span>
<span class="sd">		The point is inside the polygon or not</span>

<span class="sd">	Examples</span>
<span class="sd">	--------</span>
<span class="sd">	Import veroviz:</span>
<span class="sd">		&gt;&gt;&gt; import veroviz as vrv</span>

<span class="sd">	Example 1 - Location is inside polygon:</span>
<span class="sd">		&gt;&gt;&gt; loc = [42.03, -78.05]</span>
<span class="sd">		&gt;&gt;&gt; poly = [[42.00, -78.00], [42.10, -78.10], [42.00, -78.10]]</span>
<span class="sd">		&gt;&gt;&gt; vrv.isPointInPoly(loc, poly)</span>
<span class="sd">		True</span>
<span class="sd">		</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletMarker(center = loc)</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletPolygon(mapObject = myMap, points = poly)</span>
<span class="sd">		&gt;&gt;&gt; myMap</span>
<span class="sd">	</span>
<span class="sd">	Example 2 - Location is outside polygon:</span>
<span class="sd">		&gt;&gt;&gt; loc = [42.07, -78.05]</span>
<span class="sd">		&gt;&gt;&gt; poly = [[42.00, -78.00], [42.10, -78.10], [42.00, -78.10]]</span>
<span class="sd">		&gt;&gt;&gt; vrv.isPointInPoly(loc, poly)</span>
<span class="sd">		False</span>

<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletMarker(center = loc)</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletPolygon(mapObject = myMap, points = poly)</span>
<span class="sd">		&gt;&gt;&gt; myMap</span>

<span class="sd">	Example 3 - Location is on the polygon boundary:</span>
<span class="sd">		&gt;&gt;&gt; loc = [42.05, -78.10]</span>
<span class="sd">		&gt;&gt;&gt; poly = [[42.00, -78.00], [42.10, -78.10], [42.00, -78.10]]</span>
<span class="sd">		&gt;&gt;&gt; vrv.isPointInPoly(loc, poly)</span>
<span class="sd">		True</span>

<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletMarker(center = loc)</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletPolygon(mapObject = myMap, points = poly)</span>
<span class="sd">		&gt;&gt;&gt; myMap</span>
<span class="sd">						</span>
<span class="sd">	Example 4 - Location is on a polygon vertex:</span>
<span class="sd">		&gt;&gt;&gt; loc = [42.10, -78.10]</span>
<span class="sd">		&gt;&gt;&gt; poly = [[42.00, -78.00], [42.10, -78.10], [42.00, -78.10]]</span>
<span class="sd">		&gt;&gt;&gt; vrv.isPointInPoly(loc, poly)</span>
<span class="sd">		True</span>
<span class="sd">		</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletMarker(center = loc)</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletPolygon(mapObject = myMap, points = poly)</span>
<span class="sd">		&gt;&gt;&gt; myMap</span>
<span class="sd">		</span>
<span class="sd">	Example 5 - Non-convex poly region:</span>
<span class="sd">		&gt;&gt;&gt; loc = [42.50, -78.90]</span>
<span class="sd">		&gt;&gt;&gt; poly = [[42.00, -78.00], [43.00, -78.00], [42.2, -78.5], [43.00, -79.00], [42.00, -79.00]]</span>
<span class="sd">		&gt;&gt;&gt; vrv.isPointInPoly(loc, poly)</span>

<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletMarker(center = loc)</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletPolygon(mapObject = myMap, points = poly)</span>
<span class="sd">		&gt;&gt;&gt; myMap</span>
<span class="sd">		</span>
<span class="sd">	Example 6 - Altitudes are included (but ignored):</span>
<span class="sd">		&gt;&gt;&gt; loc = [42.05, -78.10, 100]</span>
<span class="sd">		&gt;&gt;&gt; poly = [[42.00, -78.00, 200], [42.10, -78.10, 300], [42.00, -78.10, 200]]</span>
<span class="sd">		&gt;&gt;&gt; vrv.isPointInPoly(loc, poly)		</span>
<span class="sd">		True</span>
<span class="sd">		</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletMarker(center = loc)</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletPolygon(mapObject = myMap, points = poly)</span>
<span class="sd">		&gt;&gt;&gt; myMap</span>
<span class="sd">				</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="c1"># validation</span>
	<span class="p">[</span><span class="n">valFlag</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">,</span> <span class="n">warningMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">valIsPointInPoly</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="n">poly</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">valFlag</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">errorMsg</span><span class="p">)</span>
		<span class="k">return</span>
	<span class="k">elif</span> <span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;VRV_SETTING_SHOWWARNINGMESSAGE&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">warningMsg</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">warningMsg</span><span class="p">)</span>

	<span class="n">loc2D</span> <span class="o">=</span> <span class="p">[</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
	<span class="n">poly2D</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">poly</span><span class="p">)):</span>
		<span class="n">poly2D</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">poly</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">poly</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]])</span>

	<span class="n">inside</span> <span class="o">=</span> <span class="n">geoIsPointInPoly</span><span class="p">(</span><span class="n">loc2D</span><span class="p">,</span> <span class="n">poly2D</span><span class="p">)</span>
		
	<span class="k">return</span> <span class="n">inside</span></div>

<div class="viewcode-block" id="isPathInPoly"><a class="viewcode-back" href="../../veroviz.utilities.html#veroviz.utilities.isPathInPoly">[docs]</a><span class="k">def</span> <span class="nf">isPathInPoly</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">poly</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Determine if a given path is completely within the boundary of a polygon. </span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	path: list of lists, Required</span>
<span class="sd">		A list of coordinates in the form of [[lat1, lon1, alt1], [lat2, lon2, alt2], ...] or [[lat1, lon1], [lat2, lon2], ...].  If provided, altitudes will be ignored.  This is considered as an open polyline.</span>
<span class="sd">	poly: list of lists, Required</span>
<span class="sd">		A closed polygon defined as a list of individual locations, in the form of [[lat1, lon1, alt1], [lat2, lon2, alt2], ...] or [[lat1, lon1], [lat2, lon2], ...].  If provided, altitudes will be ignored.</span>
<span class="sd">	</span>
<span class="sd">	</span>
<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	boolean</span>
<span class="sd">		True if the path lies entirely inside the polygon; False if at least one point of the path is not inside polygon.</span>

<span class="sd">	Examples</span>
<span class="sd">	--------</span>
<span class="sd">	Import veroviz:</span>
<span class="sd">		&gt;&gt;&gt; import veroviz as vrv</span>

<span class="sd">	Example 1 - Entire path is inside polygon:</span>
<span class="sd">		&gt;&gt;&gt; path = [[42.50, -78.10], [42.50, -78.50], [42.50, -78.90]]</span>
<span class="sd">		&gt;&gt;&gt; poly = [[42.00, -78.00], [43.00, -78.00], [43.00, -79.00], [42.00, -79.00]]</span>
<span class="sd">		&gt;&gt;&gt; vrv.isPathInPoly(path, poly)</span>
<span class="sd">		True</span>
<span class="sd">		</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletPolyline(points = path)</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletPolygon(mapObject = myMap, points = poly)</span>
<span class="sd">		&gt;&gt;&gt; myMap</span>

<span class="sd">	Example 2 - One of the vertices is on the edge of the polygon:</span>
<span class="sd">		&gt;&gt;&gt; path = [[42.50, -78.10], [43.00, -78.50], [42.50, -78.90]]</span>
<span class="sd">		&gt;&gt;&gt; poly = [[42.00, -78.00], [43.00, -78.00], [43.00, -79.00], [42.00, -79.00]]</span>
<span class="sd">		&gt;&gt;&gt; vrv.isPathInPoly(path, poly)</span>
<span class="sd">		False</span>

<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletPolyline(points = path)</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletPolygon(mapObject = myMap, points = poly)</span>
<span class="sd">		&gt;&gt;&gt; myMap</span>

<span class="sd">	Example 3 - Part of the path is outside of the polygon:</span>
<span class="sd">		&gt;&gt;&gt; path = [[42.50, -78.10], [43.10, -78.50], [42.50, -78.90]]</span>
<span class="sd">		&gt;&gt;&gt; poly = [[42.00, -78.00], [43.00, -78.00], [43.00, -79.00], [42.00, -79.00]]</span>
<span class="sd">		&gt;&gt;&gt; vrv.isPathInPoly(path, poly)</span>
<span class="sd">		False</span>
<span class="sd">		</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletPolyline(points = path)</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletPolygon(mapObject = myMap, points = poly)</span>
<span class="sd">		&gt;&gt;&gt; myMap</span>

<span class="sd">	Example 4 - Endpoints are in the polygon, but the poly isn&#39;t convex:</span>
<span class="sd">		&gt;&gt;&gt; path = [[42.50, -78.10], [42.50, -78.90]]</span>
<span class="sd">		&gt;&gt;&gt; poly = [[42.00, -78.00], [43.00, -78.00], [42.2, -78.5], [43.00, -79.00], [42.00, -79.00]]</span>
<span class="sd">		&gt;&gt;&gt; vrv.isPathInPoly(path, poly)</span>
<span class="sd">		True</span>
<span class="sd">		</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletPolyline(points = path)</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletPolygon(mapObject = myMap, points = poly)</span>
<span class="sd">		&gt;&gt;&gt; myMap</span>

<span class="sd">	Example 5 - Path and poly coordinates include altitude (which is ignored):</span>
<span class="sd">		&gt;&gt;&gt; path = [[42.50, -78.10, 100], [42.50, -78.90, 200]]</span>
<span class="sd">		&gt;&gt;&gt; poly = [[42.00, -78.00, 100], </span>
<span class="sd">		...         [43.00, -78.00, 100], </span>
<span class="sd">		...         [42.2, -78.5, 100], </span>
<span class="sd">		...         [43.00, -79.00, 200], </span>
<span class="sd">		...         [42.00, -79.00, 200]]</span>
<span class="sd">		&gt;&gt;&gt; vrv.isPathInPoly(path, poly)</span>
<span class="sd">		True</span>
<span class="sd">		</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletPolyline(points = path)</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletPolygon(mapObject = myMap, points = poly)</span>
<span class="sd">		&gt;&gt;&gt; myMap</span>

<span class="sd">	&quot;&quot;&quot;</span>

	<span class="c1"># validation</span>
	<span class="p">[</span><span class="n">valFlag</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">,</span> <span class="n">warningMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">valIsPathInPoly</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">poly</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">valFlag</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">errorMsg</span><span class="p">)</span>
		<span class="k">return</span>
	<span class="k">elif</span> <span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;VRV_SETTING_SHOWWARNINGMESSAGE&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">warningMsg</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">warningMsg</span><span class="p">)</span>

	<span class="n">path2D</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">path</span><span class="p">)):</span>
		<span class="n">path2D</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">path</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">path</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]])</span>
	<span class="n">poly2D</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">poly</span><span class="p">)):</span>
		<span class="n">poly2D</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">poly</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">poly</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]])</span>

	<span class="n">inside</span> <span class="o">=</span> <span class="n">geoIsPathInPoly</span><span class="p">(</span><span class="n">path2D</span><span class="p">,</span> <span class="n">poly2D</span><span class="p">)</span>

	<span class="k">return</span> <span class="n">inside</span></div>

<div class="viewcode-block" id="isPathCrossPoly"><a class="viewcode-back" href="../../veroviz.utilities.html#veroviz.utilities.isPathCrossPoly">[docs]</a><span class="k">def</span> <span class="nf">isPathCrossPoly</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">poly</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Determine if a given path crosses the boundary of a polygon.</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	path: list of lists, Required</span>
<span class="sd">		A list of coordinates in the form of [[lat1, lon1, alt1], [lat2, lon2, alt2], ...] or [[lat1, lon1], [lat2, lon2], ...].  If provided, altitudes will be ignored.  This is considered as an open polyline.</span>
<span class="sd">	poly: list of lists, Required</span>
<span class="sd">		A closed polygon defined as a list of individual locations, in the form of [[lat1, lon1, alt1], [lat2, lon2, alt2], ...] or [[lat1, lon1], [lat2, lon2], ...].  If provided, altitudes will be ignored.</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	boolean</span>
<span class="sd">		True if the path have intersection with the polygon, false if no intersection</span>

<span class="sd">	Examples</span>
<span class="sd">	--------</span>
<span class="sd">	First import veroviz</span>
<span class="sd">		&gt;&gt;&gt; import veroviz</span>

<span class="sd">	Example 1 - Entire path is inside poly</span>
<span class="sd">		&gt;&gt;&gt; path = [[42.50, -78.10], [42.50, -78.50], [42.50, -78.90]]</span>
<span class="sd">		&gt;&gt;&gt; poly = [[42.00, -78.00], [43.00, -78.00], [43.00, -79.00], [42.00, -79.00]]</span>
<span class="sd">		&gt;&gt;&gt; vrv.isPathCrossPoly(path, poly)</span>
<span class="sd">		False</span>

<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletPolyline(points = path)</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletPolygon(mapObject = myMap, points = poly)</span>
<span class="sd">		&gt;&gt;&gt; myMap</span>

<span class="sd">	Example 2 - One of the vertices is on the edge of poly</span>
<span class="sd">		&gt;&gt;&gt; path = [[42.50, -78.10], [43.00, -78.50], [42.50, -78.90]]</span>
<span class="sd">		&gt;&gt;&gt; poly = [[42.00, -78.00], [43.00, -78.00], [43.00, -79.00], [42.00, -79.00]]</span>
<span class="sd">		&gt;&gt;&gt; vrv.isPathCrossPoly(path, poly)</span>
<span class="sd">		True</span>

<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletPolyline(points = path)</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletPolygon(mapObject = myMap, points = poly)</span>
<span class="sd">		&gt;&gt;&gt; myMap</span>

<span class="sd">	Example 3 - Part of the path is outside of poly:</span>
<span class="sd">		&gt;&gt;&gt; path = [[42.50, -78.10], [43.10, -78.50], [42.50, -78.90]]</span>
<span class="sd">		&gt;&gt;&gt; poly = [[42.00, -78.00], [43.00, -78.00], [43.00, -79.00], [42.00, -79.00]]</span>
<span class="sd">		&gt;&gt;&gt; vrv.isPathCrossPoly(path, poly)</span>
<span class="sd">		True</span>
<span class="sd">		</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletPolyline(points = path)</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletPolygon(mapObject = myMap, points = poly)</span>
<span class="sd">		&gt;&gt;&gt; myMap</span>
<span class="sd">		</span>
<span class="sd">	Example 4 - Endpoints are in poly, but poly isn&#39;t convex:</span>
<span class="sd">		&gt;&gt;&gt; path = [[42.50, -78.10], [42.50, -78.90]]</span>
<span class="sd">		&gt;&gt;&gt; poly = [[42.00, -78.00], [43.00, -78.00], [42.2, -78.5], [43.00, -79.00], [42.00, -79.00]]</span>
<span class="sd">		&gt;&gt;&gt; vrv.isPathCrossPoly(path, poly)</span>
<span class="sd">		False</span>

<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletPolyline(points = path)</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletPolygon(mapObject = myMap, points = poly)</span>
<span class="sd">		&gt;&gt;&gt; myMap	</span>
<span class="sd">		</span>
<span class="sd">	Example 5 - Path and poly include altitudes (which are ignored):</span>
<span class="sd">		&gt;&gt;&gt; path = [[42.50, -78.10, 100], [42.50, -78.90, 300]]</span>
<span class="sd">		&gt;&gt;&gt; poly = [[42.00, -78.00, 100], </span>
<span class="sd">		...         [43.00, -78.00, 200], </span>
<span class="sd">		...         [42.2, -78.5, 100], </span>
<span class="sd">		...         [43.00, -79.00, 300], </span>
<span class="sd">		...         [42.00, -79.00, 100]]</span>
<span class="sd">		&gt;&gt;&gt; vrv.isPathCrossPoly(path, poly)	</span>
<span class="sd">		</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="c1"># validation</span>
	<span class="p">[</span><span class="n">valFlag</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">,</span> <span class="n">warningMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">valIsPathCrossPoly</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">poly</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">valFlag</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">errorMsg</span><span class="p">)</span>
		<span class="k">return</span>
	<span class="k">elif</span> <span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;VRV_SETTING_SHOWWARNINGMESSAGE&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">warningMsg</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">warningMsg</span><span class="p">)</span>

	<span class="n">path2D</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">path</span><span class="p">)):</span>
		<span class="n">path2D</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">path</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">path</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]])</span>
	<span class="n">poly2D</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">poly</span><span class="p">)):</span>
		<span class="n">poly2D</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">poly</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">poly</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]])</span>

	<span class="n">crossFlag</span> <span class="o">=</span> <span class="n">geoIsPathCrossPoly</span><span class="p">(</span><span class="n">path2D</span><span class="p">,</span> <span class="n">poly2D</span><span class="p">)</span>

	<span class="k">return</span> <span class="n">crossFlag</span></div>

<div class="viewcode-block" id="isPassPath"><a class="viewcode-back" href="../../veroviz.utilities.html#veroviz.utilities.isPassPath">[docs]</a><span class="k">def</span> <span class="nf">isPassPath</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
	<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	Determine if any point along a path is within tolerance meters of a stationary point (i.e., did our path pass by the target?).</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	loc: list, Required</span>
<span class="sd">		The stationary point to be tested if it has been passed, in either [lat, lon] or [lat, lon, alt] format.  If provided, the altitude will be ignored.</span>
<span class="sd">	path: list of lists, Required</span>
<span class="sd">		A list of coordinates in the form of [[lat1, lon1, alt1], [lat2, lon2, alt2], ...] or [[lat1, lon1], [lat2, lon2], ...].  If provided, altitudes will be ignored.  This is considered as an open polyline.</span>
<span class="sd">	tolerance: float, Required</span>
<span class="sd">		How close must the path be to the stationary location to be considered as &quot;passed&quot;.  The units are in meters.</span>
<span class="sd">	</span>
<span class="sd">		</span>
<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	boolean</span>
<span class="sd">		Whether or not the path passes the point.</span>

<span class="sd">	Examples</span>
<span class="sd">	--------</span>
<span class="sd">	Prepare some data</span>
<span class="sd">		&gt;&gt;&gt; import veroviz</span>
<span class="sd">		&gt;&gt;&gt; path = [[42.50, -78.10], [42.50, -78.90]]</span>

<span class="sd">	Example 1 - The distance from the location to the path exceeds the tolerance.</span>
<span class="sd">		&gt;&gt;&gt; awayLoc = [42.51, -78.50]</span>
<span class="sd">		&gt;&gt;&gt; vrv.isPassPath(awayLoc, path, 1000)</span>
<span class="sd">		False</span>
<span class="sd">		</span>
<span class="sd">		&gt;&gt;&gt; # Find the minimum distance, in meters, from the location to the path:</span>
<span class="sd">		&gt;&gt;&gt; vrv.minDistLoc2Path(awayLoc, path)</span>
<span class="sd">		1105.9845259826711</span>

<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletMarker(center = awayLoc)</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletPolyline(mapObject = myMap, points = path)</span>
<span class="sd">		&gt;&gt;&gt; myMap</span>

<span class="sd">	Example 2 - The distance from the location to the path is within the tolerance.</span>
<span class="sd">		&gt;&gt;&gt; closeLoc = [42.505, -78.50]</span>
<span class="sd">		&gt;&gt;&gt; vrv.isPassPath(closeLoc, path, 1000)</span>
<span class="sd">		True</span>
<span class="sd">		</span>
<span class="sd">		&gt;&gt;&gt; # Find the minimum distance, in meters, from the location to the path:</span>
<span class="sd">		&gt;&gt;&gt; vrv.minDistLoc2Path(closeLoc, path)	</span>
<span class="sd">		550.5689415111023</span>
<span class="sd">		</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletMarker(center = closeLoc)</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletPolyline(mapObject = myMap, points = path)</span>
<span class="sd">		&gt;&gt;&gt; myMap</span>
<span class="sd">		</span>
<span class="sd">	Example 3 - Location and path include altitudes (which are ignored):</span>
<span class="sd">		&gt;&gt;&gt; loc  = [42.505, -78.50, 100]</span>
<span class="sd">		&gt;&gt;&gt; path = [[42.50, -78.40, 100], </span>
<span class="sd">		...         [42.50, -78.60, 200], </span>
<span class="sd">		...         [42.40, -78.70, 100]]</span>
<span class="sd">		&gt;&gt;&gt; vrv.isPassPath(loc, path, 1000)</span>
<span class="sd">	&#39;&#39;&#39;</span>

	<span class="c1"># validation</span>
	<span class="p">[</span><span class="n">valFlag</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">,</span> <span class="n">warningMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">valIsPassPath</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">valFlag</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">errorMsg</span><span class="p">)</span>
		<span class="k">return</span>
	<span class="k">elif</span> <span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;VRV_SETTING_SHOWWARNINGMESSAGE&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">warningMsg</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">warningMsg</span><span class="p">)</span>

	<span class="n">loc2D</span> <span class="o">=</span> <span class="p">[</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
	<span class="n">path2D</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">path</span><span class="p">)):</span>
		<span class="n">path2D</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">path</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">path</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]])</span>

	<span class="n">passFlag</span> <span class="o">=</span> <span class="n">geoIsPassPath</span><span class="p">(</span><span class="n">loc2D</span><span class="p">,</span> <span class="n">path2D</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">)</span>

	<span class="k">return</span> <span class="n">passFlag</span></div>

<div class="viewcode-block" id="pointInDistance2D"><a class="viewcode-back" href="../../veroviz.utilities.html#veroviz.utilities.pointInDistance2D">[docs]</a><span class="k">def</span> <span class="nf">pointInDistance2D</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">distMeters</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Find the [lat, lon, alt] coordinate of a point that is a given distance away from a current location at a given heading. This can be useful for determining where a vehicle may be in the future (assuming constant velocity and straight-line travel).</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	loc: list, Required</span>
<span class="sd">		The starting location, expressed as either [lat, lon, alt] or [lat, lon]. If no altitude is provided, it will be assumed to be 0 meters above ground level.		</span>
<span class="sd">	direction: float, Required</span>
<span class="sd">		The direction of travel from the current location, in units of degrees.  The range is [0, 360], where north is 0 degrees, east is 90 degrees, south is 180 degrees, and west is 270 degrees.</span>
<span class="sd">	distMeters: float, Required</span>
<span class="sd">		The straight-line distance to be traveled, in meters, from the current location in the given direction.</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	list</span>
<span class="sd">		A location a given distance away from the given location, in [lat, lon, alt] form.</span>

<span class="sd">	Example</span>
<span class="sd">	-------</span>
<span class="sd">		&gt;&gt;&gt; import veroviz as vrv</span>
<span class="sd">		&gt;&gt;&gt; startPt  = [42.80, -78.30, 200]</span>
<span class="sd">		&gt;&gt;&gt; heading  = 45 # degrees. travel northeast.</span>
<span class="sd">		&gt;&gt;&gt; distance = 300 # meters.</span>
<span class="sd">		&gt;&gt;&gt; </span>
<span class="sd">		&gt;&gt;&gt; endPt = vrv.pointInDistance2D(startPt, heading, distance)</span>
<span class="sd">		&gt;&gt;&gt; endPt</span>
<span class="sd">		</span>
<span class="sd">		&gt;&gt;&gt; myArc = vrv.createArcsFromLocSeq(locSeq = [startPt, endPt])</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.createLeaflet(arcs=myArc)</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletMarker(mapObject=myMap, center=startPt, fillColor=&#39;red&#39;)</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletMarker(mapObject=myMap, center=endPt, fillColor=&#39;green&#39;)</span>
<span class="sd">		&gt;&gt;&gt; myMap</span>
<span class="sd">	&quot;&quot;&quot;</span>
	
	<span class="c1"># validation</span>
	<span class="p">[</span><span class="n">valFlag</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">,</span> <span class="n">warningMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">valPointInDistance2D</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="n">direction</span><span class="p">,</span> <span class="n">distMeters</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">valFlag</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">errorMsg</span><span class="p">)</span>
		<span class="k">return</span>
	<span class="k">elif</span> <span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;VRV_SETTING_SHOWWARNINGMESSAGE&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">warningMsg</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">warningMsg</span><span class="p">)</span>

	<span class="n">loc2D</span> <span class="o">=</span> <span class="p">[</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

	<span class="n">newLoc</span> <span class="o">=</span> <span class="n">geoPointInDistance2D</span><span class="p">(</span><span class="n">loc2D</span><span class="p">,</span> <span class="n">direction</span><span class="p">,</span> <span class="n">distMeters</span><span class="p">)</span>

	<span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span>
		<span class="n">newLoc</span> <span class="o">=</span> <span class="p">[</span><span class="n">newLoc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">newLoc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">loc</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>

	<span class="k">return</span> <span class="n">newLoc</span></div>

<div class="viewcode-block" id="minDistLoc2Path"><a class="viewcode-back" href="../../veroviz.utilities.html#veroviz.utilities.minDistLoc2Path">[docs]</a><span class="k">def</span> <span class="nf">minDistLoc2Path</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Calculate the minimum distance, in [meters], from a single stationary location (target) to any point along a path.</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	loc: list, Required</span>
<span class="sd">		The coordinate of the stationary location, in either [lat, lon] or [lat, lon, alt] format.  If provided, the altitude will be ignored.</span>
<span class="sd">	path: list of lists, Required</span>
<span class="sd">		A list of coordinates in the form of [[lat1, lon1, alt1], [lat2, lon2, alt2], ...] or [[lat1, lon1], [lat2, lon2], ...].  If provided, altitudes will be ignored.  </span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	float</span>
<span class="sd">		The minimum distance, in meters, between the stationary location and the given polyline (path).</span>

<span class="sd">	Examples</span>
<span class="sd">	--------</span>
<span class="sd">	Prepare some data</span>
<span class="sd">		&gt;&gt;&gt; import veroviz</span>
<span class="sd">		&gt;&gt;&gt; path = [[42.50, -78.10], [42.50, -78.90]]</span>
<span class="sd">		&gt;&gt;&gt; loc1 = [42.50, -78.50]</span>
<span class="sd">		&gt;&gt;&gt; loc2 = [42.51, -78.50]</span>
<span class="sd">		&gt;&gt;&gt; loc3 = [42.51, -78.00]</span>

<span class="sd">	Example 1 - The location is on the path:</span>
<span class="sd">		&gt;&gt;&gt; vrv.minDistLoc2Path(loc1, path)</span>
<span class="sd">		0.0</span>

<span class="sd">	Example 2 - The minimum distance is between points on the path:</span>
<span class="sd">		&gt;&gt;&gt; vrv.minDistLoc2Path(loc2, path)</span>
<span class="sd">		1105.9845259826711</span>
<span class="sd">		</span>
<span class="sd">	Example 3 - The minimum distance is to an endpoint of the path:</span>
<span class="sd">		&gt;&gt;&gt; vrv.minDistLoc2Path(loc3, path)</span>
<span class="sd">		8293.970453010765</span>

<span class="sd">	Show the objects on a map:</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletMarker(center=loc1, fillColor=&#39;blue&#39;)</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletMarker(mapObject=myMap, center=loc2, fillColor=&#39;green&#39;)</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletMarker(mapObject=myMap, center=loc3, fillColor=&#39;purple&#39;)</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletPolyline(mapObject=myMap, points=path)</span>
<span class="sd">		&gt;&gt;&gt; myMap</span>
<span class="sd">		</span>
<span class="sd">	Example 4 - The location and path include altitudes (which are ignored):</span>
<span class="sd">		&gt;&gt;&gt; path2 = [[42.50, -78.40, 100], </span>
<span class="sd">		...          [42.50, -78.60, 200], </span>
<span class="sd">		...          [42.40, -78.70, 100]]</span>
<span class="sd">		&gt;&gt;&gt; loc4  = [42.51, -78.3, 300]</span>
<span class="sd">		&gt;&gt;&gt; vrv.minDistLoc2Path(loc4, path2)</span>

<span class="sd">	&quot;&quot;&quot;</span>

	<span class="p">[</span><span class="n">valFlag</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">,</span> <span class="n">warningMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">valMinDistLoc2Path</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">valFlag</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">errorMsg</span><span class="p">)</span>
		<span class="k">return</span>
	<span class="k">elif</span> <span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;VRV_SETTING_SHOWWARNINGMESSAGE&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">warningMsg</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">warningMsg</span><span class="p">)</span>

	<span class="n">distMeters</span> <span class="o">=</span> <span class="n">geoMinDistLoc2Path</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>

	<span class="k">return</span> <span class="n">distMeters</span></div>

<div class="viewcode-block" id="closestPointLoc2Path"><a class="viewcode-back" href="../../veroviz.utilities.html#veroviz.utilities.closestPointLoc2Path">[docs]</a><span class="k">def</span> <span class="nf">closestPointLoc2Path</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Finds the point along a given line that is closest to a given location.  Returns the [lat, lon] coordinates of the point, and the corresponding distance (in [meters]) from that point to the line.</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	loc: list, Required</span>
<span class="sd">		The coordinate of the current coordinate, in [lat, lon, alt] format.</span>
<span class="sd">	path: list of lists, Required</span>
<span class="sd">		Specifies the ordered collection of lat/lon coordinates comprising a path.   This must be a list of lists, of the form `[[lat1, lon1], [lat2, lon2], ..., [latn, lonn]]` or `[[lat1, lon1, alt1], [lat2, lon2, alt2], ..., [latn, lonn, altn]]`.  If an altitude is provided with each coordinate, this component will be ignored. 	</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	minLoc: list specifying a location, in [lat, lon] format.</span>
<span class="sd">	distMeters: The distance from the given location to minLoc.</span>

<span class="sd">	Examples</span>
<span class="sd">	--------</span>
<span class="sd">	Import veroviz and check if the version is up-to-date:</span>
<span class="sd">		&gt;&gt;&gt; import veroviz as vrv</span>
<span class="sd">		&gt;&gt;&gt; vrv.checkVersion()</span>

<span class="sd">	Prepare some data</span>
<span class="sd">		&gt;&gt;&gt; import veroviz</span>
<span class="sd">		&gt;&gt;&gt; path = [[42.50, -78.65], [42.50, -78.40]]</span>
<span class="sd">		&gt;&gt;&gt; loc1 = [42.50, -78.50]</span>
<span class="sd">		&gt;&gt;&gt; loc2 = [42.51, -78.50]</span>

<span class="sd">	Draw the line and the 2 points on the map:</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletPolyline(points = path)</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletMarker(mapObject = myMap,</span>
<span class="sd">		...                              center = loc1, </span>
<span class="sd">		...                              radius = 14,</span>
<span class="sd">		...                              text=&#39;1&#39;, fontColor=&#39;black&#39;)</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletMarker(mapObject = myMap,</span>
<span class="sd">		...                              center = loc2, </span>
<span class="sd">		...                              radius = 14,</span>
<span class="sd">		...                              text=&#39;2&#39;, fontColor=&#39;black&#39;)</span>
<span class="sd">		&gt;&gt;&gt; myMap</span>

<span class="sd">	Example 1 - The location is on the path:</span>
<span class="sd">		&gt;&gt;&gt; vrv.closestPointLoc2Path(loc1, path)</span>
<span class="sd">		([42.5, -78.5], 0.0)</span>

<span class="sd">	Example 2 - The minimum distance is between points on the path:</span>
<span class="sd">		&gt;&gt;&gt; vrv.closestPointLoc2Path(loc2, path)</span>
<span class="sd">		([42.5, -78.50000397522506], 1103.5612443321572)</span>

<span class="sd">	Example 3 - The location and path include altitudes (which are ignored):</span>
<span class="sd">		&gt;&gt;&gt; path2 = [[42.50, -78.40, 100],</span>
<span class="sd">		...          [42.50, -78.60, 200],</span>
<span class="sd">		...          [42.40, -78.70, 100]]</span>
<span class="sd">		&gt;&gt;&gt; loc3  = [42.51, -78.3, 300]</span>
<span class="sd">		&gt;&gt;&gt; vrv.closestPointLoc2Path(loc3, path2)</span>
<span class="sd">		([42.5, -78.6, 0], 8293.970453010768)</span>
<span class="sd">		</span>
<span class="sd">	Draw the line, the reference point, and the nearest point on the map:</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletPolyline(points = path2)</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletMarker(mapObject = myMap,</span>
<span class="sd">		...                              center = loc3, </span>
<span class="sd">		...                              radius = 14,</span>
<span class="sd">		...                              text=&#39;3&#39;, fontColor=&#39;black&#39;)</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletMarker(mapObject = myMap, center = nearestPt, radius = 12)</span>
<span class="sd">		&gt;&gt;&gt; myMap		</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="c1"># validation</span>
	<span class="p">[</span><span class="n">valFlag</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">,</span> <span class="n">warningMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">valClosestPointLoc2Path</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">valFlag</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">errorMsg</span><span class="p">)</span>
		<span class="k">return</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
	<span class="k">elif</span> <span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;VRV_SETTING_SHOWWARNINGMESSAGE&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">warningMsg</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">warningMsg</span><span class="p">)</span>

	<span class="p">(</span><span class="n">minPoint</span><span class="p">,</span> <span class="n">distMeters</span><span class="p">)</span> <span class="o">=</span> <span class="n">privClosestPointLoc2Path</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>

	<span class="k">return</span> <span class="p">(</span><span class="n">minPoint</span><span class="p">,</span> <span class="n">distMeters</span><span class="p">)</span></div>
	
	
<div class="viewcode-block" id="closestPointLoc2Assignments"><a class="viewcode-back" href="../../veroviz.utilities.html#veroviz.utilities.closestPointLoc2Assignments">[docs]</a><span class="k">def</span> <span class="nf">closestPointLoc2Assignments</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">assignments</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">objectID</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignoreStaticPoints</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>

	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Finds the point along each path defined by the given assignments dataframe that is closest to a given location.  Returns the [lat, lon] coordinates of these points, and the corresponding distance (in [meters]) from each point to the each path.</span>

<span class="sd">	Returns a dictionary of lists of dictionaries.  The first dictionary&#39;s keys are objectIDs found in the &#39;assignments&#39; dataframe.  For each &#39;objectID&#39;, a list is provided.  This list will contain the nearest point and the distance from the given location to that point.  If the objectID does not have any consecutive rows in the &#39;assignments&#39; dataframe where the ending location differs from the starting location in the next row, then there will be only one result for each objectID.  </span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	loc: list, Required</span>
<span class="sd">		The coordinate of the current coordinate, in [lat, lon, alt] format.</span>
<span class="sd">	assignments: An :ref:`Assignments` dataframe, Required, default as None</span>
<span class="sd">		Each row of an :ref:`Assignments` dataframe describes the starting and ending location of an object, with corresponding start and end times (in seconds).</span>
<span class="sd">	objectID: string, Optional, default as None</span>
<span class="sd">		This is an identifier for each object in the `assignments` dataframe.  If `objectID` is None, then paths will be returned for each unique `objectID` found in the `assignments` dataframe.  Otherwise, only paths associated with the given `objectID` will be returned.</span>
<span class="sd">	ignoreStaticPoints: Boolean, Optional, default as True</span>
<span class="sd">		Static (stationary) points are rows in the &#39;assignments&#39; dataframe where the starting and ending locations are identical.  If these are included in the path, you get a path segment of zero distance.  By default, we&#39;ll ignore these points, so each segment of the line is of non-zero distance.</span>
<span class="sd">	</span>
<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	A nested dictionary.  The keys of this dictionary are objectIDs.  For each objectID, a list is provided, where each list corresponds to a path associated with the objectID.  For each list, a dictionary containing keys of `nearestPt` (a list of the form [lat, lon]) and `distMeters` (a scalar) is provided.</span>
<span class="sd">	</span>
<span class="sd">	Example</span>
<span class="sd">	--------</span>
<span class="sd">	Import veroviz and check if the version is up-to-date</span>
<span class="sd">		&gt;&gt;&gt; import veroviz as vrv</span>
<span class="sd">		&gt;&gt;&gt; vrv.checkVersion()</span>

<span class="sd">	We&#39;ll begin by generating some data, which will be used by the `closestPointLoc2Assignments()` function.</span>

<span class="sd">		&gt;&gt;&gt; # Specify 4 locations that could be visited:</span>
<span class="sd">		... locs = [[42.1648, -78.4293], </span>
<span class="sd">		...         [42.1565, -78.4234], </span>
<span class="sd">		...         [42.1443, -78.4246],</span>
<span class="sd">		...         [42.1113, -78.4212]]</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">		&gt;&gt;&gt; # Now, create an :ref:`Assignments` dataframe for two vehicles (a truck and a car).  </span>
<span class="sd">		... </span>
<span class="sd">		... # The truck will visit nodes 1 and 2.  </span>
<span class="sd">		... exampleAssignments = vrv.createAssignmentsFromLocSeq2D(</span>
<span class="sd">		...     locSeq         = locs[0:2],</span>
<span class="sd">		...     serviceTimeSec = 30.0,</span>
<span class="sd">		...     objectID       = &#39;Truck&#39;,</span>
<span class="sd">		...     routeType      = &#39;fastest&#39;,</span>
<span class="sd">		...     dataProvider   = &#39;OSRM-online&#39;,</span>
<span class="sd">		...     leafletColor   = &#39;red&#39;)</span>
<span class="sd">		... </span>
<span class="sd">		... # The truck will then pause 45 seconds before taking a route from node 4 to node 3. </span>
<span class="sd">		... # There is an obvious break in these routes.  </span>
<span class="sd">		... exampleAssignments = vrv.createAssignmentsFromLocSeq2D(</span>
<span class="sd">		...     initAssignments = exampleAssignments,</span>
<span class="sd">		...     locSeq          = locs[-1:1:-1],</span>
<span class="sd">		...     serviceTimeSec  = 30.0,</span>
<span class="sd">		...     startTimeSec    = max(exampleAssignments[&#39;endTimeSec&#39;]) + 45,</span>
<span class="sd">		...     objectID        = &#39;Truck&#39;,</span>
<span class="sd">		...     routeType       = &#39;fastest&#39;,</span>
<span class="sd">		...     dataProvider    = &#39;OSRM-online&#39;,</span>
<span class="sd">		...     leafletColor    = &#39;green&#39;)</span>
<span class="sd">		... </span>
<span class="sd">		... # The car will visit nodes 1 and 4.</span>
<span class="sd">		... exampleAssignments = vrv.createAssignmentsFromLocSeq2D(</span>
<span class="sd">		...     initAssignments = exampleAssignments,</span>
<span class="sd">		...     locSeq          = [locs[0], locs[3]],</span>
<span class="sd">		...     serviceTimeSec  = 30.0,</span>
<span class="sd">		...     objectID        = &#39;Car&#39;,</span>
<span class="sd">		...     routeType       = &#39;fastest&#39;,</span>
<span class="sd">		...     dataProvider    = &#39;OSRM-online&#39;,</span>
<span class="sd">		...     leafletColor    = &#39;blue&#39;) </span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">	Visualize the locations and assignments. Generate a :ref:`Nodes` dataframe from a list of coordinates.  See :meth:`~veroviz.generateNodes.generateNodes` for other methods to generate &quot;nodes&quot; dataframes. </span>
<span class="sd">		&gt;&gt;&gt; exampleNodes = vrv.createNodesFromLocs(locs = locs)</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.createLeaflet(nodes = exampleNodes, arcs = exampleAssignments)</span>
<span class="sd">		&gt;&gt;&gt; myMap</span>

<span class="sd">	Specify a location:</span>
<span class="sd">		&gt;&gt;&gt; loc = [42.1382899, -78.3887493]</span>
<span class="sd">	</span>
<span class="sd">	Add a marker for the given location:</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletMarker(mapObject = myMap,</span>
<span class="sd">		...                              center = loc, </span>
<span class="sd">		...                              radius = 30,</span>
<span class="sd">		...                              text=&#39;Loc&#39;, fontColor=&#39;black&#39;)</span>
<span class="sd">		&gt;&gt;&gt; myMap</span>

<span class="sd">	Find the nearest point to the given location for each vehicle in the assignments dataframe.  Note: The truck has two separate paths, so it will have two nearest points (one for each path).</span>
<span class="sd">		&gt;&gt;&gt; closestPoints = vrv.closestPointLoc2Assignments(</span>
<span class="sd">		...	    loc                = loc, </span>
<span class="sd">		...	    assignments        = exampleAssignments, </span>
<span class="sd">		...	    objectID           = None, </span>
<span class="sd">		...	    ignoreStaticPoints = True)	</span>
<span class="sd">		&gt;&gt;&gt; closestPoints</span>
<span class="sd">		{&#39;Truck&#39;: [{&#39;nearestPoint&#39;: [42.157619, -78.422146], &#39;distMeters&#39;: 15506.568584267798},</span>
<span class="sd">		           {&#39;nearestPoint&#39;: [42.129462, -78.409906], &#39;distMeters&#39;: 14152.410369937512}],</span>
<span class="sd">		  &#39;Car&#39;:  [{&#39;nearestPoint&#39;: [42.150689, -78.398545], &#39;distMeters&#39;: 13441.061529262752}]}		</span>
<span class="sd">		</span>
<span class="sd">	Plot these points on the map:</span>
<span class="sd">		&gt;&gt;&gt; for objectID in closestPoints:</span>
<span class="sd">		...	    for i in range(0, len(closestPoints[objectID])):</span>
<span class="sd">		...	        myMap = vrv.addLeafletMarker(mapObject = myMap, </span>
<span class="sd">		...	                                     center    = closestPoints[objectID][i][&#39;nearestPoint&#39;],</span>
<span class="sd">		...	                                     radius    = 14)</span>
<span class="sd">		&gt;&gt;&gt;	myMap 	</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="c1"># validation</span>
	<span class="p">[</span><span class="n">valFlag</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">,</span> <span class="n">warningMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">valClosestPointLoc2Assignments</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="n">assignments</span><span class="p">,</span> <span class="n">objectID</span><span class="p">,</span> <span class="n">ignoreStaticPoints</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">valFlag</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">errorMsg</span><span class="p">)</span>
		<span class="k">return</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
	<span class="k">elif</span> <span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;VRV_SETTING_SHOWWARNINGMESSAGE&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">warningMsg</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">warningMsg</span><span class="p">)</span>
	
	<span class="n">paths</span> <span class="o">=</span> <span class="n">privAssignmentsToPaths</span><span class="p">(</span><span class="n">assignments</span><span class="p">,</span> <span class="n">objectID</span><span class="p">,</span> <span class="n">ignoreStaticPoints</span><span class="p">)</span>
	
	<span class="n">closestPoints</span> <span class="o">=</span> <span class="p">{}</span>
	<span class="k">for</span> <span class="n">tmpObjectID</span> <span class="ow">in</span> <span class="n">paths</span><span class="p">:</span>
		<span class="n">closestPoints</span><span class="p">[</span><span class="n">tmpObjectID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">[</span><span class="n">tmpObjectID</span><span class="p">])):</span>
			<span class="p">(</span><span class="n">minPoint</span><span class="p">,</span> <span class="n">distMeters</span><span class="p">)</span> <span class="o">=</span> <span class="n">privClosestPointLoc2Path</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="n">paths</span><span class="p">[</span><span class="n">tmpObjectID</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
			<span class="n">closestPoints</span><span class="p">[</span><span class="n">tmpObjectID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;nearestPoint&#39;</span><span class="p">:</span> <span class="n">minPoint</span><span class="p">,</span> <span class="s1">&#39;distMeters&#39;</span><span class="p">:</span> <span class="n">distMeters</span><span class="p">})</span>

	<span class="k">return</span> <span class="n">closestPoints</span>	</div>
	
	
<div class="viewcode-block" id="closestPointLoc2Arcs"><a class="viewcode-back" href="../../veroviz.utilities.html#veroviz.utilities.closestPointLoc2Arcs">[docs]</a><span class="k">def</span> <span class="nf">closestPointLoc2Arcs</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">arcs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">objectID</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignoreStaticPoints</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>

	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Finds the point along each path defined by the given arcs dataframe that is closest to a given location.  Returns the [lat, lon] coordinates of these points, and the corresponding distance (in [meters]) from each point to the each path.</span>

<span class="sd">	Returns a dictionary of lists of dictionaries.  The first dictionary&#39;s keys are objectIDs found in the &#39;arcs&#39; dataframe.  For each &#39;objectID&#39;, a list is provided.  This list will contain the nearest point and the distance from the given location to that point.  If the objectID does not have any consecutive rows in the &#39;arcs&#39; dataframe where the ending location differs from the starting location in the next row, then there will be only one result for each objectID.  </span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	loc: list, Required</span>
<span class="sd">		The coordinate of the current coordinate, in [lat, lon, alt] format.</span>
<span class="sd">	arcs: An :ref:`Arcs` dataframe, Required, default as None</span>
<span class="sd">		Each row of an :ref:`Arcs` dataframe describes the starting and ending location of an object.</span>
<span class="sd">	objectID: string, Optional, default as None</span>
<span class="sd">		This is an identifier for each object in the `arcs` dataframe.  If `objectID` is None, then paths will be returned for each unique `objectID` found in the `arcs` dataframe.  Otherwise, only paths associated with the given `objectID` will be returned.</span>
<span class="sd">	ignoreStaticPoints: Boolean, Optional, default as True</span>
<span class="sd">		Static (stationary) points are rows in the &#39;arcs&#39; dataframe where the starting and ending locations are identical.  If these are included in the path, you get a path segment of zero distance.  By default, we&#39;ll ignore these points, so each segment of the line is of non-zero distance.</span>
<span class="sd">	</span>
<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	A nested dictionary.  The keys of this dictionary are objectIDs.  For each objectID, a list is provided, where each list corresponds to a path associated with the objectID.  For each list, a dictionary containing keys of `nearestPt` (a list of the form [lat, lon]) and `distMeters` (a scalar) is provided.</span>
<span class="sd">	</span>
<span class="sd">	Example</span>
<span class="sd">	--------</span>
<span class="sd">	Import veroviz and check if the version is up-to-date</span>
<span class="sd">		&gt;&gt;&gt; import veroviz as vrv</span>
<span class="sd">		&gt;&gt;&gt; vrv.checkVersion()</span>

<span class="sd">	Specify 4 locations that could be visited:</span>
<span class="sd">		&gt;&gt;&gt; locs = [[42.1648, -78.4293], </span>
<span class="sd">		...         [42.1565, -78.4234], </span>
<span class="sd">		...         [42.1443, -78.4246],</span>
<span class="sd">		...         [42.1113, -78.4212]]</span>
<span class="sd">		</span>
<span class="sd">		&gt;&gt;&gt; # Now, create an :ref:`Arcs` dataframe for two vehicles.  </span>
<span class="sd">		... </span>
<span class="sd">		... # The truck will visit nodes 1 and 2. 		</span>
<span class="sd">		... exampleArcs = vrv.createArcsFromLocSeq(</span>
<span class="sd">		... 	locSeq       = locs[0:2],</span>
<span class="sd">		... 	objectID     = &#39;Truck&#39;,</span>
<span class="sd">		... 	leafletColor = &#39;red&#39;)</span>
<span class="sd">		... </span>
<span class="sd">		... # The truck will then take a route from node 4 to node 3.  There is an obvious break in these routes.  </span>
<span class="sd">		... exampleArcs = vrv.createArcsFromLocSeq(</span>
<span class="sd">		... 	initArcs     = exampleArcs,</span>
<span class="sd">		... 	locSeq       = locs[-1:1:-1],</span>
<span class="sd">		... 	objectID     = &#39;Truck&#39;,</span>
<span class="sd">		... 	leafletColor = &#39;green&#39;)</span>
<span class="sd">		... </span>
<span class="sd">		... # The car will visit nodes 1 and 4.</span>
<span class="sd">		... exampleArcs = vrv.createArcsFromLocSeq(</span>
<span class="sd">		... 	initArcs     = exampleArcs,</span>
<span class="sd">		... 	locSeq       = [locs[0], locs[3]],</span>
<span class="sd">		... 	objectID     = &#39;Car&#39;,</span>
<span class="sd">		... 	leafletColor = &#39;blue&#39;)		</span>

<span class="sd">	Visualize the locations and arcs. Generate a :ref:`Nodes` dataframe from a list of coordinates.  See :meth:`~veroviz.generateNodes.generateNodes` for other methods to generate &quot;nodes&quot; dataframes. </span>
<span class="sd">		&gt;&gt;&gt; exampleNodes = vrv.createNodesFromLocs(locs = locs)</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.createLeaflet(nodes = exampleNodes, arcs = exampleArcs)</span>
<span class="sd">		&gt;&gt;&gt; myMap</span>

<span class="sd">	Specify a location:</span>
<span class="sd">		&gt;&gt;&gt; loc = [42.1382899, -78.3887493]</span>
<span class="sd">	</span>
<span class="sd">	Add a marker for the given location:</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletMarker(mapObject = myMap,</span>
<span class="sd">		...                              center = loc, </span>
<span class="sd">		...                              radius = 30,</span>
<span class="sd">		...                              text=&#39;Loc&#39;, fontColor=&#39;black&#39;)</span>

<span class="sd">	Find the nearest point to the given location for each vehicle in the arcs dataframe.  Note: The truck has two separate paths, so it will have two nearest points (one for each path).</span>
<span class="sd">		&gt;&gt;&gt; closestPoints = vrv.closestPointLoc2Arcs(</span>
<span class="sd">		...	    loc                = loc, </span>
<span class="sd">		...	    arcs               = exampleArcs, </span>
<span class="sd">		...	    objectID           = None, </span>
<span class="sd">		...	    ignoreStaticPoints = True)	</span>
<span class="sd">		&gt;&gt;&gt; closestPoints</span>
<span class="sd">		{&#39;Truck&#39;: [{&#39;nearestPoint&#39;: [42.157619, -78.422146], &#39;distMeters&#39;: 15506.568584267798},</span>
<span class="sd">		           {&#39;nearestPoint&#39;: [42.129462, -78.409906], &#39;distMeters&#39;: 14152.410369937512}],</span>
<span class="sd">		  &#39;Car&#39;:  [{&#39;nearestPoint&#39;: [42.150689, -78.398545], &#39;distMeters&#39;: 13441.061529262752}]}		</span>
<span class="sd">		</span>
<span class="sd">	Plot these points on the map:</span>
<span class="sd">		&gt;&gt;&gt; for objectID in closestPoints:</span>
<span class="sd">		...	    for i in range(0, len(closestPoints[objectID])):</span>
<span class="sd">		...	        myMap = vrv.addLeafletMarker(mapObject = myMap, </span>
<span class="sd">		...	                                     center    = closestPoints[objectID][i][&#39;nearestPoint&#39;],</span>
<span class="sd">		...	                                     radius    = 14)</span>
<span class="sd">		&gt;&gt;&gt;	myMap 	</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="c1"># validation</span>
	<span class="p">[</span><span class="n">valFlag</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">,</span> <span class="n">warningMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">valClosestPointLoc2Arcs</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="n">arcs</span><span class="p">,</span> <span class="n">objectID</span><span class="p">,</span> <span class="n">ignoreStaticPoints</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">valFlag</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">errorMsg</span><span class="p">)</span>
		<span class="k">return</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
	<span class="k">elif</span> <span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;VRV_SETTING_SHOWWARNINGMESSAGE&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">warningMsg</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">warningMsg</span><span class="p">)</span>
	
	<span class="n">paths</span> <span class="o">=</span> <span class="n">privArcsToPaths</span><span class="p">(</span><span class="n">arcs</span><span class="p">,</span> <span class="n">objectID</span><span class="p">,</span> <span class="n">ignoreStaticPoints</span><span class="p">)</span>
	
	<span class="n">closestPoints</span> <span class="o">=</span> <span class="p">{}</span>
	<span class="k">for</span> <span class="n">tmpObjectID</span> <span class="ow">in</span> <span class="n">paths</span><span class="p">:</span>
		<span class="n">closestPoints</span><span class="p">[</span><span class="n">tmpObjectID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">paths</span><span class="p">[</span><span class="n">tmpObjectID</span><span class="p">])):</span>
			<span class="p">(</span><span class="n">minPoint</span><span class="p">,</span> <span class="n">distMeters</span><span class="p">)</span> <span class="o">=</span> <span class="n">privClosestPointLoc2Path</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="n">paths</span><span class="p">[</span><span class="n">tmpObjectID</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
			<span class="n">closestPoints</span><span class="p">[</span><span class="n">tmpObjectID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;nearestPoint&#39;</span><span class="p">:</span> <span class="n">minPoint</span><span class="p">,</span> <span class="s1">&#39;distMeters&#39;</span><span class="p">:</span> <span class="n">distMeters</span><span class="p">})</span>

	<span class="k">return</span> <span class="n">closestPoints</span></div>
		
	
<div class="viewcode-block" id="closestNode2Loc"><a class="viewcode-back" href="../../veroviz.utilities.html#veroviz.utilities.closestNode2Loc">[docs]</a><span class="k">def</span> <span class="nf">closestNode2Loc</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nodes</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Returns the closest node in the dataframe to the given location.  Also returns the Euclidean distance (in [meters]) from the location to the nearest node.</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	loc: list, Required</span>
<span class="sd">		The coordinate of given location, in [lat, lon, alt] format.</span>
<span class="sd">	nodes: A :ref:`Nodes` dataframe, Required</span>
<span class="sd">		Dataframe containing an existing set of nodes.</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	minNodeID: int</span>
<span class="sd">		A node id of the closest node</span>
<span class="sd">	distMeters: float</span>
<span class="sd">		The minimum distance is returned</span>

<span class="sd">	Examples</span>
<span class="sd">	--------</span>
<span class="sd">	Import veroviz and check if the version is up-to-date:</span>
<span class="sd">		&gt;&gt;&gt; import veroviz as vrv</span>
<span class="sd">		&gt;&gt;&gt; vrv.checkVersion()</span>

<span class="sd">	Prepare some sample data.</span>
<span class="sd">		&gt;&gt;&gt; # A single location:</span>
<span class="sd">		&gt;&gt;&gt; loc1 = [42.885, -78.861]</span>
<span class="sd">		&gt;&gt;&gt; </span>
<span class="sd">		&gt;&gt;&gt; # A collection of locations, which we&#39;ll</span>
<span class="sd">		&gt;&gt;&gt; # convert to a &quot;nodes&quot; dataframe:</span>
<span class="sd">		&gt;&gt;&gt; locs = [[42.8871085, -78.8731949],</span>
<span class="sd">		...         [42.8888311, -78.8649649],</span>
<span class="sd">		...         [42.8802158, -78.8660787],</span>
<span class="sd">		...         [42.8845705, -78.8762794],</span>
<span class="sd">		...         [42.8908031, -78.8770140]]</span>
<span class="sd">		&gt;&gt;&gt; </span>
<span class="sd">		&gt;&gt;&gt; myNodes = vrv.createNodesFromLocs(locs = locs, </span>
<span class="sd">		...                                   leafletIconPrefix = &quot;custom&quot;, </span>
<span class="sd">		...                                   leafletIconType   = &quot;12-white-12&quot;)</span>

<span class="sd">	Example 1 - Closest node:</span>
<span class="sd">		&gt;&gt;&gt; [nearestNode, distMeters] = vrv.closestNode2Loc(loc1, myNodes)</span>
<span class="sd">		&gt;&gt;&gt; nearestNode, distMeters</span>
<span class="sd">		(2, 534.828771310757)</span>

<span class="sd">	Show the five nodes from the dataframe and the reference location:</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.createLeaflet(nodes = myNodes)</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.addLeafletIcon(mapObject = myMap, location = loc1, iconColor=&#39;red&#39;)</span>
<span class="sd">		&gt;&gt;&gt; myMap</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="c1"># validation</span>
	<span class="p">[</span><span class="n">valFlag</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">,</span> <span class="n">warningMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">valClosestNode2Loc</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="n">nodes</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">valFlag</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">errorMsg</span><span class="p">)</span>
		<span class="k">return</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
	<span class="k">elif</span> <span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;VRV_SETTING_SHOWWARNINGMESSAGE&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">warningMsg</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">warningMsg</span><span class="p">)</span>

	<span class="n">distMeters</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;Inf&#39;</span><span class="p">)</span>
	<span class="n">minNodeID</span> <span class="o">=</span> <span class="kc">None</span>

	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">)):</span>
		<span class="n">nodeLat</span><span class="o">=</span><span class="n">nodes</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span>
		<span class="n">nodeLon</span><span class="o">=</span><span class="n">nodes</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;lon&#39;</span><span class="p">]</span>
		<span class="n">tmpDistMeters</span> <span class="o">=</span> <span class="n">distance2D</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="p">[</span><span class="n">nodeLat</span><span class="p">,</span> <span class="n">nodeLon</span><span class="p">])</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">tmpDistMeters</span> <span class="o">&lt;</span> <span class="n">distMeters</span><span class="p">):</span>
			<span class="n">distMeters</span> <span class="o">=</span> <span class="n">tmpDistMeters</span>
			<span class="n">minNodeID</span> <span class="o">=</span> <span class="n">nodes</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">minNodeID</span> <span class="o">==</span> <span class="kc">None</span><span class="p">):</span>
		<span class="k">return</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>

	<span class="k">return</span> <span class="p">[</span><span class="n">minNodeID</span><span class="p">,</span> <span class="n">distMeters</span><span class="p">]</span>	</div>
	
<div class="viewcode-block" id="nearestNodes"><a class="viewcode-back" href="../../veroviz.utilities.html#veroviz.utilities.nearestNodes">[docs]</a><span class="k">def</span> <span class="nf">nearestNodes</span><span class="p">(</span><span class="n">origin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nodes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">costDict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">,</span> <span class="n">routeType</span><span class="o">=</span><span class="s1">&#39;euclidean2D&#39;</span><span class="p">,</span> <span class="n">speedMPS</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dataProvider</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dataProviderArgs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Returns a pandas dataframe with 2 columns, &#39;id&#39; and &#39;cost&#39;.  The &#39;id&#39; column represents a nodeID, the &#39;cost&#39; represents either a time or a distance (consistent with the data provided by costDict).  The dataframe is sorted according to ascending values of &#39;cost&#39;.  The top k rows are returned (i.e., the nearest k nodes).</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	origin: list or integer, Required, default as None</span>
<span class="sd">		This function finds the k nearest nodes to this starting location.  `origin` can be a location, specified as a list of the form [lat, lon] or [lat, lon, alt].  If provided, the altitude will be ignored.  Alternatively, `origin` can be a nodeID.  In this case, `origin` must be a value in the &#39;id&#39; column of the `nodes` input.</span>
<span class="sd">	nodes: :ref:`Nodes`, Required, default as None</span>
<span class="sd">		A :ref:`Nodes` dataframe containing the nodes representing destinations from the origin.</span>
<span class="sd">	k: integer, Required, default as 1</span>
<span class="sd">		This function finds the k nodes nearest to the origin.  If k &lt;= 0, the function will simply return all nodes in ascending order of &quot;cost&quot; (excluding the `origin`, if `origin` is a nodeID).</span>
<span class="sd">	costDict: dictionary, Optional, default as None</span>
<span class="sd">		If provided, this should be one of the two output dictionaries from the VeRoViz getTimeDist2D() function.  If not provided, this information will be generated according to the fields below.</span>
<span class="sd">	metric: string, Conditional, default as &#39;distance&#39;</span>
<span class="sd">		Indicates if &quot;nearness&quot; is according to &#39;time&#39; or &#39;distance&#39; (the two valid options for this parameter).  This parameter is only required if `origin` is a location ([lat, lon]) or if `costDict` is None, as this implies that the function will need to build a valid cost dictionary.  In other words, this parameter is ignored if `origin` is a valid nodeID and if `costDict` is not None.        </span>
<span class="sd">	routeType: string, Optional, default as &#39;euclidean2D&#39;</span>
<span class="sd">		This describes a characteristic of the travel mode.  Possible values are: &#39;euclidean2D&#39;, &#39;manhattan&#39;, &#39;fastest&#39;, &#39;shortest&#39;, &#39;pedestrian&#39;, &#39;cycling&#39;, and &#39;truck&#39;.  The &#39;euclidean2D&#39; and &#39;manhattan&#39; options are calculated directly from GPS coordinates, without a road network.  Neither of these two options require a data provider.  However, the other options rely on road network information and require a data provider.  Furthermore, some of those other options are not supported by all data providers.  See :ref:`Data Providers` for details.</span>
<span class="sd">	speedMPS: float, Conditional, default as None</span>
<span class="sd">		Speed of the vehicle, in units of meters per second. For route types that are not road-network based (i.e., &#39;euclidean2D&#39; and &#39;manhattan&#39;), this field is required to calculate travel times. Otherwise, if a route type already incorporates travel speeds from road network data, (i.e., &#39;fastest&#39;, &#39;shortest&#39;, and &#39;pedestrain&#39;), this input argument may be ignored.  If provided, `speedMPS` will override travel speed data used by the route type option.</span>
<span class="sd">	dataProvider: string, Conditional, default as None</span>
<span class="sd">		Specifies the data source to be used for obtaining the travel data. See :ref:`Data Providers` for options and requirements.</span>
<span class="sd">	dataProviderArgs: dictionary, Conditional, default as None</span>
<span class="sd">		For some data providers, additional parameters are required (e.g., API keys or database names). See :ref:`Data Providers` for the additional arguments required for each supported data provider.</span>

<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	pandas dataframe</span>

<span class="sd">	Examples</span>
<span class="sd">	--------</span>
<span class="sd">	Import veroviz and check if the version is up-to-date</span>
<span class="sd">		&gt;&gt;&gt; import veroviz as vrv</span>
<span class="sd">		&gt;&gt;&gt; vrv.checkVersion()</span>

<span class="sd">	Generate a :ref:`Nodes` dataframe from a list of coordinates.  See :meth:`~veroviz.generateNodes.generateNodes` for other methods to generate &quot;nodes&quot; dataframes.</span>
<span class="sd">		&gt;&gt;&gt; locs = [</span>
<span class="sd">		...     [42.1538, -78.4253], </span>
<span class="sd">		...     [42.3465, -78.6234], </span>
<span class="sd">		...     [42.6343, -78.1146]]</span>
<span class="sd">		&gt;&gt;&gt; exampleNodes = vrv.createNodesFromLocs(locs=locs)</span>

<span class="sd">	Example 1 - Find the k=1 node closest to node 3, according to Euclidean distance</span>
<span class="sd">		&gt;&gt;&gt; vrv.nearestNodes(nodes = exampleNodes, origin = 3, k = 1)    </span>

<span class="sd">	Example 2 - Find the k=2 nodes closest to [42, -78], according to the travel time obtained from ORS-online.  This example includes all input parameters.</span>
<span class="sd">		&gt;&gt;&gt; import os</span>
<span class="sd">		&gt;&gt;&gt; ORS_API_KEY     = os.environ[&#39;ORSKEY&#39;]</span>
<span class="sd">		&gt;&gt;&gt; # ORS_API_KEY   = &#39;YOUR_ORS_KEY_GOES_HERE&#39;</span>

<span class="sd">		&gt;&gt;&gt; vrv.nearestNodes(origin           = [42, -78], </span>
<span class="sd">		...                  nodes            = exampleNodes, </span>
<span class="sd">		...                  k                = 2, </span>
<span class="sd">		...                  costDict         = None, </span>
<span class="sd">		...                  metric           = &#39;time&#39;, </span>
<span class="sd">		...                  routeType        = &#39;fastest&#39;,</span>
<span class="sd">		...                  speedMPS         = None, </span>
<span class="sd">		...                  dataProvider     = &#39;ors-online&#39;, </span>
<span class="sd">		...                  dataProviderArgs = {&#39;APIkey&#39;: ORS_API_KEY})</span>

<span class="sd">	&quot;&quot;&quot;</span>

	<span class="c1"># validation</span>
	<span class="p">[</span><span class="n">valFlag</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">,</span> <span class="n">warningMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">valNearestNodes</span><span class="p">(</span><span class="n">origin</span><span class="p">,</span> <span class="n">nodes</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">costDict</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">routeType</span><span class="p">,</span> <span class="n">speedMPS</span><span class="p">,</span> <span class="n">dataProvider</span><span class="p">,</span> <span class="n">dataProviderArgs</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">valFlag</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">errorMsg</span><span class="p">)</span>
		<span class="k">return</span>
	<span class="k">elif</span> <span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;VRV_SETTING_SHOWWARNINGMESSAGE&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">warningMsg</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">warningMsg</span><span class="p">)</span>

	
	<span class="c1"># If origin is a [lat, lon], we need to create a node</span>
	<span class="k">if</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">origin</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">):</span>
		<span class="n">originType</span> <span class="o">=</span> <span class="s1">&#39;loc&#39;</span>
		<span class="n">originNodeID</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">nodes</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span>
		<span class="n">nodes</span> <span class="o">=</span> <span class="n">privCreateNodesFromLocs</span><span class="p">(</span><span class="n">locs</span><span class="o">=</span><span class="p">[</span><span class="n">origin</span><span class="p">],</span> <span class="n">initNodes</span><span class="o">=</span><span class="n">nodes</span><span class="p">,</span> 
										<span class="n">startNode</span><span class="o">=</span><span class="n">originNodeID</span><span class="p">,</span> 
										<span class="n">dataProvider</span><span class="o">=</span><span class="n">dataProvider</span><span class="p">,</span> 
										<span class="n">dataProviderArgs</span><span class="o">=</span><span class="n">dataProviderArgs</span><span class="p">)</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">originType</span> <span class="o">=</span> <span class="s1">&#39;node&#39;</span>
		<span class="n">originNodeID</span> <span class="o">=</span> <span class="n">origin</span>


	<span class="k">if</span> <span class="p">((</span><span class="n">originType</span> <span class="o">==</span> <span class="s1">&#39;loc&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">costDict</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)):</span>
		<span class="c1"># Need to get time or dist matrix</span>
	
		<span class="c1"># Specify the list of rows and columns of output dataframes</span>
		<span class="c1"># This is &#39;one2many&#39;.</span>
		<span class="n">fromRows</span> <span class="o">=</span> <span class="p">[</span><span class="n">originNodeID</span><span class="p">]</span>
		<span class="n">toCols</span> <span class="o">=</span> <span class="n">nodes</span><span class="p">[</span><span class="n">nodes</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">originNodeID</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

		<span class="c1"># Specify lists of coordinates, in [lat, lon] format</span>
		<span class="n">fromLocs</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">toLocs</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">fromRows</span><span class="p">)):</span>
			<span class="n">fromLocs</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">nodes</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">nodes</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">fromRows</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nodes</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">nodes</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">fromRows</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s1">&#39;lon&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">toCols</span><span class="p">)):</span>
			<span class="n">toLocs</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">nodes</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">nodes</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">toCols</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nodes</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">nodes</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">toCols</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s1">&#39;lon&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">routeType</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;euclidean2D&#39;</span><span class="p">,</span> <span class="s1">&#39;manhatan&#39;</span><span class="p">]):</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">metric</span> <span class="o">==</span> <span class="s1">&#39;distance&#39;</span><span class="p">):</span>
				<span class="n">speedMPS</span> <span class="o">=</span> <span class="mi">1</span>   <span class="c1"># dummy value</span>

		<span class="c1"># Get time/dist</span>
		<span class="p">[</span><span class="n">timeSec</span><span class="p">,</span> <span class="n">distMeters</span><span class="p">]</span> <span class="o">=</span> <span class="n">getTimeDistFromLocs2D</span><span class="p">(</span><span class="n">fromLocs</span><span class="o">=</span><span class="n">fromLocs</span><span class="p">,</span> 
											 <span class="n">fromRows</span><span class="o">=</span><span class="n">fromRows</span><span class="p">,</span> 
											 <span class="n">toLocs</span><span class="o">=</span><span class="n">toLocs</span><span class="p">,</span> 
											 <span class="n">toCols</span><span class="o">=</span><span class="n">toCols</span><span class="p">,</span> 
											 <span class="n">outputDistUnits</span><span class="o">=</span><span class="s1">&#39;meters&#39;</span><span class="p">,</span> 
											 <span class="n">outputTimeUnits</span><span class="o">=</span><span class="s1">&#39;seconds&#39;</span><span class="p">,</span> 
											 <span class="n">routeType</span><span class="o">=</span><span class="n">routeType</span><span class="p">,</span> 
											 <span class="n">speedMPS</span><span class="o">=</span><span class="n">speedMPS</span><span class="p">,</span> 
											 <span class="n">dataProvider</span><span class="o">=</span><span class="n">dataProvider</span><span class="p">,</span> 
											 <span class="n">dataProviderArgs</span><span class="o">=</span><span class="n">dataProviderArgs</span><span class="p">)</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">metric</span> <span class="o">==</span> <span class="s1">&#39;distance&#39;</span><span class="p">):</span>
			<span class="n">costDict</span> <span class="o">=</span> <span class="n">distMeters</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">costDict</span> <span class="o">=</span> <span class="n">timeSec</span>
	
	<span class="k">return</span> <span class="n">privNearestNodes</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="n">originNodeID</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">costDict</span><span class="p">)</span></div>
	
	
<div class="viewcode-block" id="assignmentsToPaths"><a class="viewcode-back" href="../../veroviz.utilities.html#veroviz.utilities.assignmentsToPaths">[docs]</a><span class="k">def</span> <span class="nf">assignmentsToPaths</span><span class="p">(</span><span class="n">assignments</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">objectID</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignoreStaticPoints</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Returns a dictionary of lists of paths.  The dictionary&#39;s keys are objectIDs found in the &#39;assignments&#39; dataframe.  For each &#39;objectID&#39;, a list is provided.  This list will contain one or more paths associated with that objectID.  If the objectID does not have any consecutive rows in the &#39;assignments&#39; dataframe where the ending location differs from the starting location in the next row, then there will be only one path.  </span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	assignments: An :ref:`Assignments` dataframe, Required, default as None</span>
<span class="sd">		Each row of an :ref:`Assignments` dataframe describes the starting and ending location of an object, with corresponding start and end times (in seconds).</span>
<span class="sd">	objectID: string, Optional, default as None</span>
<span class="sd">		This is an identifier for each object in the `assignments` dataframe.  If `objectID` is None, then paths will be returned for each unique `objectID` found in the `assignments` dataframe.  Otherwise, only paths associated with the given `objectID` will be returned.</span>
<span class="sd">	ignoreStaticPoints: Boolean, Optional, default as True</span>
<span class="sd">		Static (stationary) points are rows in the &#39;assignments&#39; dataframe where the starting and ending locations are identical.  If these are included in the path, you get a path segment of zero distance.  By default, we&#39;ll ignore these points, so each segment of the line is of non-zero distance.</span>
<span class="sd">	</span>
<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	A dictionary of lists of paths</span>

<span class="sd">	Example</span>
<span class="sd">	--------</span>
<span class="sd">	Import veroviz and check if the version is up-to-date</span>
<span class="sd">		&gt;&gt;&gt; import veroviz as vrv</span>
<span class="sd">		&gt;&gt;&gt; vrv.checkVersion()</span>

<span class="sd">	We&#39;ll begin by generating some data, which will be used by the `assignmentsToPaths()` function.</span>

<span class="sd">		&gt;&gt;&gt; # Specify 4 locations that could be visited:</span>
<span class="sd">		... locs = [[42.1648, -78.4293], </span>
<span class="sd">		...         [42.1565, -78.4234], </span>
<span class="sd">		...         [42.1443, -78.4246],</span>
<span class="sd">		...         [42.1113, -78.4212]]</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">		&gt;&gt;&gt; # Now, create an :ref:`Assignments` dataframe for two vehicles (a truck and a car).  </span>
<span class="sd">		... </span>
<span class="sd">		... # The truck will visit nodes 1 and 2.  </span>
<span class="sd">		... exampleAssignments = vrv.createAssignmentsFromLocSeq2D(</span>
<span class="sd">		...     locSeq         = locs[0:2],</span>
<span class="sd">		...     serviceTimeSec = 30.0,</span>
<span class="sd">		...     objectID       = &#39;Truck&#39;,</span>
<span class="sd">		...     routeType      = &#39;fastest&#39;,</span>
<span class="sd">		...     dataProvider   = &#39;OSRM-online&#39;,</span>
<span class="sd">		...     leafletColor   = &#39;red&#39;)</span>
<span class="sd">		... </span>
<span class="sd">		... # The truck will then pause 45 seconds before taking a route from node 4 to node 3. </span>
<span class="sd">		... # There is an obvious break in these routes.  </span>
<span class="sd">		... exampleAssignments = vrv.createAssignmentsFromLocSeq2D(</span>
<span class="sd">		...     initAssignments = exampleAssignments,</span>
<span class="sd">		...     locSeq          = locs[-1:1:-1],</span>
<span class="sd">		...     serviceTimeSec  = 30.0,</span>
<span class="sd">		...     startTimeSec    = max(exampleAssignments[&#39;endTimeSec&#39;]) + 45,</span>
<span class="sd">		...     objectID        = &#39;Truck&#39;,</span>
<span class="sd">		...     routeType       = &#39;fastest&#39;,</span>
<span class="sd">		...     dataProvider    = &#39;OSRM-online&#39;,</span>
<span class="sd">		...     leafletColor    = &#39;green&#39;)</span>
<span class="sd">		... </span>
<span class="sd">		... # The car will visit nodes 1 and 4.</span>
<span class="sd">		... exampleAssignments = vrv.createAssignmentsFromLocSeq2D(</span>
<span class="sd">		...     initAssignments = exampleAssignments,</span>
<span class="sd">		...     locSeq          = [locs[0], locs[3]],</span>
<span class="sd">		...     serviceTimeSec  = 30.0,</span>
<span class="sd">		...     objectID        = &#39;Car&#39;,</span>
<span class="sd">		...     routeType       = &#39;fastest&#39;,</span>
<span class="sd">		...     dataProvider    = &#39;OSRM-online&#39;,</span>
<span class="sd">		...     leafletColor    = &#39;blue&#39;) </span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">	Visualize the locations and assignments. Generate a :ref:`Nodes` dataframe from a list of coordinates.  See :meth:`~veroviz.generateNodes.generateNodes` for other methods to generate &quot;nodes&quot; dataframes. </span>
<span class="sd">		&gt;&gt;&gt; exampleNodes = vrv.createNodesFromLocs(locs = locs)</span>
<span class="sd">		&gt;&gt;&gt; vrv.createLeaflet(nodes = exampleNodes, arcs = exampleAssignments)</span>


<span class="sd">	Generate the paths for each vehicle:</span>
<span class="sd">		&gt;&gt;&gt; myPaths = vrv.assignmentsToPaths(assignments=exampleAssignments, objectID=None, ignoreStaticPoints=True)</span>
<span class="sd">		</span>
<span class="sd">	Investigate some details of the output:	</span>
<span class="sd">		&gt;&gt;&gt; len(myPaths[&#39;Truck&#39;])</span>
<span class="sd">		2</span>
<span class="sd">		</span>
<span class="sd">		&gt;&gt;&gt; myPaths[&#39;Truck&#39;]</span>
<span class="sd">		[[[42.16451, -78.429309], [42.164482, -78.427724], [42.157619, -78.422146]],</span>
<span class="sd">		 [[42.11118, -78.418862],</span>
<span class="sd">		  [42.120028, -78.41856],</span>
<span class="sd">		  [42.119975, -78.415146],</span>
<span class="sd">		  [42.121504, -78.414822],</span>
<span class="sd">		  [42.122706, -78.41427],</span>
<span class="sd">		  [42.126237, -78.412131],</span>
<span class="sd">		  [42.129462, -78.409906],</span>
<span class="sd">		  [42.130688, -78.413378],</span>
<span class="sd">		  [42.130762, -78.418572],</span>
<span class="sd">		  [42.130914, -78.420397],</span>
<span class="sd">		  [42.130984, -78.420506],</span>
<span class="sd">		  [42.137118, -78.428013],</span>
<span class="sd">		  [42.139694, -78.426846],</span>
<span class="sd">		  [42.142291, -78.424425],</span>
<span class="sd">		  [42.14424, -78.424135]]]</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="c1"># validation</span>
	<span class="p">[</span><span class="n">valFlag</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">,</span> <span class="n">warningMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">valAssignmentsToPaths</span><span class="p">(</span><span class="n">assignments</span><span class="p">,</span> <span class="n">objectID</span><span class="p">,</span> <span class="n">ignoreStaticPoints</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">valFlag</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">errorMsg</span><span class="p">)</span>
		<span class="k">return</span>
	<span class="k">elif</span> <span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;VRV_SETTING_SHOWWARNINGMESSAGE&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">warningMsg</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">warningMsg</span><span class="p">)</span>


	<span class="n">paths</span> <span class="o">=</span> <span class="n">privAssignmentsToPaths</span><span class="p">(</span><span class="n">assignments</span><span class="p">,</span> <span class="n">objectID</span><span class="p">,</span> <span class="n">ignoreStaticPoints</span><span class="p">)</span>
	
	<span class="k">return</span> <span class="n">paths</span></div>
	    	
<div class="viewcode-block" id="arcsToPaths"><a class="viewcode-back" href="../../veroviz.utilities.html#veroviz.utilities.arcsToPaths">[docs]</a><span class="k">def</span> <span class="nf">arcsToPaths</span><span class="p">(</span><span class="n">arcs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">objectID</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignoreStaticPoints</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Returns a dictionary of lists of paths.  The dictionary&#39;s keys are objectIDs found in the &#39;arcs&#39; dataframe.  For each &#39;objectID&#39;, a list is provided.  This list will contain one or more paths associated with that objectID.  If the objectID does not have any consecutive rows in the &#39;arcs&#39; dataframe where the ending location differs from the starting location in the next row, then there will be only one path.  </span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	arcs: An :ref:`Arcs` dataframe, Required, default as None</span>
<span class="sd">		Each row of an :ref:`Arcs` dataframe describes the starting and ending location of an object.</span>
<span class="sd">	objectID: string, Optional, default as None</span>
<span class="sd">		This is an identifier for each object in the `arcs` dataframe.  If `objectID` is None, then paths will be returned for each unique `objectID` found in the `arcs` dataframe.  Otherwise, only paths associated with the given `objectID` will be returned.</span>
<span class="sd">	ignoreStaticPoints: Boolean, Optional, default as True</span>
<span class="sd">		Static (stationary) points are rows in the &#39;arcs&#39; dataframe where the starting and ending locations are identical.  If these are included in the path, you get a path segment of zero distance.  By default, we&#39;ll ignore these points, so each segment of the line is of non-zero distance.</span>
<span class="sd">	</span>
<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	A dictionary of lists of paths</span>

<span class="sd">	Example</span>
<span class="sd">	--------</span>
<span class="sd">	Import veroviz and check if the version is up-to-date</span>
<span class="sd">		&gt;&gt;&gt; import veroviz as vrv</span>
<span class="sd">		&gt;&gt;&gt; vrv.checkVersion()</span>

<span class="sd">	Specify 4 locations that could be visited:</span>
<span class="sd">		&gt;&gt;&gt; locs = [[42.1648, -78.4293], </span>
<span class="sd">		...         [42.1565, -78.4234], </span>
<span class="sd">		...         [42.1443, -78.4246],</span>
<span class="sd">		...         [42.1113, -78.4212]]</span>
<span class="sd">		</span>
<span class="sd">		&gt;&gt;&gt; # Now, create an :ref:`Arcs` dataframe for two vehicles.  </span>
<span class="sd">		... </span>
<span class="sd">		... # The truck will visit nodes 1 and 2. 		</span>
<span class="sd">		... exampleArcs = vrv.createArcsFromLocSeq(</span>
<span class="sd">		... 	locSeq       = locs[0:2],</span>
<span class="sd">		... 	objectID     = &#39;Truck&#39;,</span>
<span class="sd">		... 	leafletColor = &#39;red&#39;)</span>
<span class="sd">		... </span>
<span class="sd">		... # The truck will then take a route from node 4 to node 3.  There is an obvious break in these routes.  </span>
<span class="sd">		... exampleArcs = vrv.createArcsFromLocSeq(</span>
<span class="sd">		... 	initArcs     = exampleArcs,</span>
<span class="sd">		... 	locSeq       = locs[-1:1:-1],</span>
<span class="sd">		... 	objectID     = &#39;Truck&#39;,</span>
<span class="sd">		... 	leafletColor = &#39;green&#39;)</span>
<span class="sd">		... </span>
<span class="sd">		... # The car will visit nodes 1 and 4.</span>
<span class="sd">		... exampleArcs = vrv.createArcsFromLocSeq(</span>
<span class="sd">		... 	initArcs     = exampleArcs,</span>
<span class="sd">		... 	locSeq       = [locs[0], locs[3]],</span>
<span class="sd">		... 	objectID     = &#39;Car&#39;,</span>
<span class="sd">		... 	leafletColor = &#39;blue&#39;)		</span>

<span class="sd">	Visualize the locations and arcs. Generate a :ref:`Nodes` dataframe from a list of coordinates.  See :meth:`~veroviz.generateNodes.generateNodes` for other methods to generate &quot;nodes&quot; dataframes. </span>
<span class="sd">		&gt;&gt;&gt; exampleNodes = vrv.createNodesFromLocs(locs = locs)</span>
<span class="sd">		&gt;&gt;&gt; vrv.createLeaflet(nodes = exampleNodes, arcs = exampleArcs)</span>

<span class="sd">	Generate the paths for each vehicle:</span>
<span class="sd">		&gt;&gt;&gt; myPaths = vrv.arcsToPaths(arcs=exampleArcs, objectID=None, ignoreStaticPoints=True)</span>
<span class="sd">		&gt;&gt;&gt; myPaths</span>
<span class="sd">		{&#39;Truck&#39;: [[[42.1648, -78.4293], [42.1565, -78.4234]],</span>
<span class="sd">		  [[42.1113, -78.4212], [42.1443, -78.4246]]],</span>
<span class="sd">		 &#39;Car&#39;: [[[42.1648, -78.4293], [42.1113, -78.4212]]]}</span>
<span class="sd">		</span>
<span class="sd">	Investigate some details of the output:	</span>
<span class="sd">		&gt;&gt;&gt; len(myPaths[&#39;Truck&#39;])</span>
<span class="sd">		2</span>
<span class="sd">		</span>
<span class="sd">		&gt;&gt;&gt; myPaths[&#39;Truck&#39;]</span>
<span class="sd">		[[[42.1648, -78.4293], [42.1565, -78.4234]],</span>
<span class="sd">		 [[42.1113, -78.4212], [42.1443, -78.4246]]]</span>
<span class="sd"> 	&quot;&quot;&quot;</span>

	<span class="c1"># validation</span>
	<span class="p">[</span><span class="n">valFlag</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">,</span> <span class="n">warningMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">valArcsToPaths</span><span class="p">(</span><span class="n">arcs</span><span class="p">,</span> <span class="n">objectID</span><span class="p">,</span> <span class="n">ignoreStaticPoints</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">valFlag</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">errorMsg</span><span class="p">)</span>
		<span class="k">return</span>
	<span class="k">elif</span> <span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;VRV_SETTING_SHOWWARNINGMESSAGE&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">warningMsg</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">warningMsg</span><span class="p">)</span>

	<span class="n">paths</span> <span class="o">=</span> <span class="n">privArcsToPaths</span><span class="p">(</span><span class="n">arcs</span><span class="p">,</span> <span class="n">objectID</span><span class="p">,</span> <span class="n">ignoreStaticPoints</span><span class="p">)</span>
	
	<span class="k">return</span> <span class="n">paths</span></div>
	

<div class="viewcode-block" id="nodesToLocs"><a class="viewcode-back" href="../../veroviz.utilities.html#veroviz.utilities.nodesToLocs">[docs]</a><span class="k">def</span> <span class="nf">nodesToLocs</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">includeAlt</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Returns a list of lists (i.e., locations) from a nodes dataframe.  If `includeAlt` is False (default), the return will be of the form [[lat,lon], ..., [lat,lon]]; otherwise, the return is of the form [[lat,lon,altMeters], ..., [lat,lon,altMeters]].  </span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	nodes: A :ref:`Nodes` dataframe, Required, default as None</span>
<span class="sd">		Dataframe containing a collection of nodes.</span>
<span class="sd">	includeAlt: Boolean, Optional, default as False</span>
<span class="sd">		If False, only latitude and longitude values are returned.  If True, the value in the `altMeters` column of the nodes dataframe is also returned with each lat/lon pair. </span>
<span class="sd">	</span>
<span class="sd">	Returns</span>
<span class="sd">	-------</span>
<span class="sd">	A list of lists, with each sub-list representing the location of one node.</span>

<span class="sd">	Example</span>
<span class="sd">	--------</span>
<span class="sd">	Import veroviz and check if the version is up-to-date</span>
<span class="sd">		&gt;&gt;&gt; import veroviz as vrv</span>
<span class="sd">		&gt;&gt;&gt; vrv.checkVersion()</span>

<span class="sd">	Generate 4 nodes:</span>
<span class="sd">		&gt;&gt;&gt; exampleNodes = vrv.generateNodes(</span>
<span class="sd">		...     nodeDistrib      = &#39;normal&#39;, </span>
<span class="sd">		...     nodeDistribArgs  = {</span>
<span class="sd">		...         &#39;center&#39;         : [42.90, -78.80], </span>
<span class="sd">		...         &#39;stdDev&#39;         : 10000</span>
<span class="sd">		...     },</span>
<span class="sd">		...     numNodes         = 4)</span>
<span class="sd">		</span>
<span class="sd">	Convert to locations (including altitudes in meters):</span>
<span class="sd">		&gt;&gt;&gt; vrv.nodesToLocs(exampleNodes, includeAlt=True)</span>
<span class="sd">		[[42.895314077862146, -78.80362790487085, 0.0],</span>
<span class="sd">		 [42.92242495208993, -78.82243490871062, 0.0],</span>
<span class="sd">		 [42.98842769922963, -78.74302258092918, 0.0],</span>
<span class="sd">		 [42.880876136692564, -78.81444943020881, 0.0]]		</span>
<span class="sd">	&quot;&quot;&quot;</span>
	
	<span class="p">[</span><span class="n">valFlag</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">,</span> <span class="n">warningMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">valNodesToLocs</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="n">includeAlt</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">valFlag</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">errorMsg</span><span class="p">)</span>
		<span class="k">return</span>
	<span class="k">elif</span> <span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;VRV_SETTING_SHOWWARNINGMESSAGE&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">warningMsg</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">warningMsg</span><span class="p">)</span>

	<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">nodes</span><span class="p">[[</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="s1">&#39;altMeters&#39;</span><span class="p">]])</span>
	
	<span class="k">if</span> <span class="p">(</span><span class="n">includeAlt</span><span class="p">):</span>
		<span class="n">locs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">zip</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">lon</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">altMeters</span><span class="p">)))</span>        
	<span class="k">else</span><span class="p">:</span>
		<span class="n">locs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">zip</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">lon</span><span class="p">)))</span>
	
	<span class="k">return</span> <span class="n">locs</span> </div>

	
<div class="viewcode-block" id="distance2D"><a class="viewcode-back" href="../../veroviz.utilities.html#veroviz.utilities.distance2D">[docs]</a><span class="k">def</span> <span class="nf">distance2D</span><span class="p">(</span><span class="n">loc1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">loc2</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Calculates the geodesic distance, in meters, between two locations, using the geopy library.  Altitude is ignored.</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	loc1: list, Required</span>
<span class="sd">		First location, in [lat, lon] format.</span>
<span class="sd">	loc2: list, Required</span>
<span class="sd">		Second location, in [lat, lon] format.</span>
<span class="sd">	</span>
<span class="sd">	Return</span>
<span class="sd">	------</span>
<span class="sd">	float</span>
<span class="sd">		Geodesic distance, in meters, between the two locations.</span>

<span class="sd">	Example</span>
<span class="sd">	-------</span>
<span class="sd">		&gt;&gt;&gt; import veroviz as vrv</span>
<span class="sd">		&gt;&gt;&gt; loc1 = [42.80, -78.90]</span>
<span class="sd">		&gt;&gt;&gt; loc2 = [42.82, -78.92]</span>
<span class="sd">		&gt;&gt;&gt; dist2D = vrv.distance2D(loc1, loc2)</span>
<span class="sd">		&gt;&gt;&gt; dist2D</span>
<span class="sd">		2759.0335974131926</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="p">[</span><span class="n">valFlag</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">,</span> <span class="n">warningMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">valDistance2D</span><span class="p">(</span><span class="n">loc1</span><span class="p">,</span> <span class="n">loc2</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">valFlag</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">errorMsg</span><span class="p">)</span>
		<span class="k">return</span>
	<span class="k">elif</span> <span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;VRV_SETTING_SHOWWARNINGMESSAGE&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">warningMsg</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">warningMsg</span><span class="p">)</span>
	
	<span class="n">distMeters</span> <span class="o">=</span> <span class="n">geoDistance2D</span><span class="p">(</span><span class="n">loc1</span><span class="p">,</span> <span class="n">loc2</span><span class="p">)</span>

	<span class="k">return</span> <span class="n">distMeters</span></div>

<div class="viewcode-block" id="distance3D"><a class="viewcode-back" href="../../veroviz.utilities.html#veroviz.utilities.distance3D">[docs]</a><span class="k">def</span> <span class="nf">distance3D</span><span class="p">(</span><span class="n">loc1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">loc2</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Estimates the distance, in meters, between two point, including changes in altitude.  The calculation combines geopy&#39;s geodesic distance (along the surface of an ellipsoidal model of the earth) with a simple estimate of additional travel distance due to altitude changes.</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	loc1: list, Required</span>
<span class="sd">		First location, in [lat, lon, alt] format.</span>
<span class="sd">	loc2: list, Required</span>
<span class="sd">		Second location, in [lat, lon, alt] format.</span>
<span class="sd">	</span>
<span class="sd">	Return</span>
<span class="sd">	------</span>
<span class="sd">	float</span>
<span class="sd">		Distance, in meters, between the two locations.</span>

<span class="sd">	Example</span>
<span class="sd">	-------</span>
<span class="sd">		&gt;&gt;&gt; import veroviz as vrv</span>
<span class="sd">		&gt;&gt;&gt; loc1 = [42.80, -78.90, 0]</span>
<span class="sd">		&gt;&gt;&gt; loc2 = [42.82, -78.92, 300]</span>
<span class="sd">		&gt;&gt;&gt; dist3D = vrv.distance3D(loc1, loc2)</span>
<span class="sd">		&gt;&gt;&gt; dist3D</span>
<span class="sd">		2775.2957304861734</span>
<span class="sd">	&quot;&quot;&quot;</span>
	
	<span class="p">[</span><span class="n">valFlag</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">,</span> <span class="n">warningMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">valDistance3D</span><span class="p">(</span><span class="n">loc1</span><span class="p">,</span> <span class="n">loc2</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">valFlag</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">errorMsg</span><span class="p">)</span>
		<span class="k">return</span>
	<span class="k">elif</span> <span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;VRV_SETTING_SHOWWARNINGMESSAGE&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">warningMsg</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">warningMsg</span><span class="p">)</span>

	<span class="n">distMeters</span> <span class="o">=</span> <span class="n">geoDistance3D</span><span class="p">(</span><span class="n">loc1</span><span class="p">,</span> <span class="n">loc2</span><span class="p">)</span>

	<span class="k">return</span> <span class="n">distMeters</span></div>

<div class="viewcode-block" id="distancePath2D"><a class="viewcode-back" href="../../veroviz.utilities.html#veroviz.utilities.distancePath2D">[docs]</a><span class="k">def</span> <span class="nf">distancePath2D</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Calculate the total geodesic distance, in meters, along a path defined by [lat, lon] coordinates.  </span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	path: list of lists, Required</span>
<span class="sd">		A list of coordinates that form a path, in the format of [[lat, lon], [lat, lon], ...].</span>

<span class="sd">	Return</span>
<span class="sd">	------</span>
<span class="sd">	float</span>
<span class="sd">		Total length of the path, in meters.</span>

<span class="sd">	Example</span>
<span class="sd">	-------</span>
<span class="sd">		&gt;&gt;&gt; import veroviz as vrv</span>
<span class="sd">		&gt;&gt;&gt; locs = [[42.80, -78.90], [42.82, -78.92], [42.84, -78.94]]</span>
<span class="sd">		&gt;&gt;&gt; path = vrv.distancePath2D(locs)</span>
<span class="sd">		&gt;&gt;&gt; path</span>
<span class="sd">		5517.760959357638</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="p">[</span><span class="n">valFlag</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">,</span> <span class="n">warningMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">valDistancePath2D</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">valFlag</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">errorMsg</span><span class="p">)</span>
		<span class="k">return</span>
	<span class="k">elif</span> <span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;VRV_SETTING_SHOWWARNINGMESSAGE&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">warningMsg</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">warningMsg</span><span class="p">)</span>

	<span class="n">dist</span> <span class="o">=</span> <span class="mi">0</span>
	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
		<span class="n">dist</span> <span class="o">+=</span> <span class="n">geoDistance2D</span><span class="p">(</span><span class="n">path</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">path</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>

	<span class="k">return</span> <span class="n">dist</span></div>

<div class="viewcode-block" id="getHeading"><a class="viewcode-back" href="../../veroviz.utilities.html#veroviz.utilities.getHeading">[docs]</a><span class="k">def</span> <span class="nf">getHeading</span><span class="p">(</span><span class="n">currentLoc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">goalLoc</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Finds the heading required to travel from a current location to a goal location.  North is 0-degrees, east is 90-degrees, south is 180-degrees, west is 270-degrees.</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	currentLoc: list, Required</span>
<span class="sd">		The [lat, lon] of current location</span>
<span class="sd">	goalLoc: list, Required</span>
<span class="sd">		The [lat, lon] of goal location</span>

<span class="sd">	Return</span>
<span class="sd">	------</span>
<span class="sd">	float</span>
<span class="sd">		Heading at current location towards goal location in degrees.</span>

<span class="sd">	Example</span>
<span class="sd">	-------</span>
<span class="sd">		&gt;&gt;&gt; import veroviz as vrv</span>
<span class="sd">		&gt;&gt;&gt; locCurrent = [42.80, -78.90]</span>
<span class="sd">		&gt;&gt;&gt; locGoal    = [42.85, -78.85]</span>
<span class="sd">		&gt;&gt;&gt; heading = vrv.getHeading(locCurrent, locGoal)</span>
<span class="sd">		&gt;&gt;&gt; heading</span>
<span class="sd">		36.24057197338239</span>
<span class="sd">		</span>
<span class="sd">		&gt;&gt;&gt; # View the arc from the current location to the goal:</span>
<span class="sd">		&gt;&gt;&gt; arc = vrv.createArcsFromLocSeq(locSeq = [locCurrent, locGoal])</span>
<span class="sd">		&gt;&gt;&gt; vrv.createLeaflet(arcs=arc)		</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="p">[</span><span class="n">valFlag</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">,</span> <span class="n">warningMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">valGetHeading</span><span class="p">(</span><span class="n">currentLoc</span><span class="p">,</span> <span class="n">goalLoc</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">valFlag</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">errorMsg</span><span class="p">)</span>
		<span class="k">return</span>
	<span class="k">elif</span> <span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;VRV_SETTING_SHOWWARNINGMESSAGE&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">warningMsg</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">warningMsg</span><span class="p">)</span>

	<span class="n">bearingInDegree</span> <span class="o">=</span> <span class="n">geoGetHeading</span><span class="p">(</span><span class="n">currentLoc</span><span class="p">,</span> <span class="n">goalLoc</span><span class="p">)</span>

	<span class="k">return</span> <span class="n">bearingInDegree</span></div>

<div class="viewcode-block" id="findLocsAtTime"><a class="viewcode-back" href="../../veroviz.utilities.html#veroviz.utilities.findLocsAtTime">[docs]</a><span class="k">def</span> <span class="nf">findLocsAtTime</span><span class="p">(</span><span class="n">assignments</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">timeSec</span><span class="o">=</span><span class="mf">0.0</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Finds the estimated location of each unique `objectID` in an input `assignments` dataframe at the given time.  The output is a dictionary, where the keys are unique objectIDs.  The corresponding value for each `objectID` key will be `None` if the object is not defined at the given value of `timeSec`, the value will be a list of the form [lat, lon, alt] if a single match is found, or the value will be a list of lists of the form [[lat1, lon1, alt1], ..., [latn, lonn, altn]] if n matches are found.  In the latter case, this is typically indicative of duplicate entries in the assignments dataframe (as each object should not appear in multiple locations simultaneously).</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	assignments: :ref:`Assignments` dataframe, Required, default as None</span>
<span class="sd">		Each row of an :ref:`Assignments` dataframe describes the starting and ending location of an object, with corresponding start and end times (in seconds).</span>
<span class="sd">	timeSec: float, Optional, default as 0.0</span>
<span class="sd">		The time, in seconds, at which it is desired to find an estimate of each object&#39;s location.</span>
<span class="sd">	</span>
<span class="sd">	Return</span>
<span class="sd">	------</span>
<span class="sd">	dictionary</span>
<span class="sd">		A dictionary describing the estimated location of each unique `objectID` in the input assignments dataframe.  See above for a description of the key/value pairs.</span>

<span class="sd">	Example</span>
<span class="sd">	-------</span>
<span class="sd">	Import veroviz and check if it&#39;s the latest version:</span>
<span class="sd">		&gt;&gt;&gt; import veroviz as vrv</span>
<span class="sd">		&gt;&gt;&gt; vrv.checkVersion()</span>

<span class="sd">	Define 5 node locations, as [lat, lon] pairs:</span>
<span class="sd">		&gt;&gt;&gt; locs = [[42.8871085, -78.8731949],</span>
<span class="sd">		...         [42.8888311, -78.8649649],</span>
<span class="sd">		...         [42.8802158, -78.8660787],</span>
<span class="sd">		...         [42.8845705, -78.8762794],</span>
<span class="sd">		...         [42.8908031, -78.8770140]]</span>

<span class="sd">	Generate a nodes dataframe from these locations:</span>
<span class="sd">		&gt;&gt;&gt; myNodes = vrv.createNodesFromLocs(locs=locs)</span>

<span class="sd">	Construct an assignments dataframe for two vehicles, a drone and a truck.  The truck will visit nodes 1 -&gt; 2 -&gt; 3 -&gt; 1.  The drone will visit nodes 1 -&gt; 4 -&gt; 5 -&gt; 1.</span>
<span class="sd">		&gt;&gt;&gt; mySolution = {</span>
<span class="sd">		...     &#39;truck&#39;: [[1,2], [2,3], [3,1]],</span>
<span class="sd">		...     &#39;drone&#39;: [[1,4], [4,5], [5,1]]</span>
<span class="sd">		... }</span>

<span class="sd">	Define some information about our 2 vehicles, for use below:</span>
<span class="sd">		&gt;&gt;&gt; vehicleProperties = {</span>
<span class="sd">		...     &#39;drone&#39;: {&#39;model&#39;: &#39;veroviz/models/drone.gltf&#39;,</span>
<span class="sd">		...               &#39;leafletColor&#39;: &#39;red&#39;,</span>
<span class="sd">		...               &#39;cesiumColor&#39;: &#39;red&#39;},</span>
<span class="sd">		...     &#39;truck&#39;: {&#39;model&#39;: &#39;veroviz/models/ub_truck.gltf&#39;,</span>
<span class="sd">		...               &#39;leafletColor&#39;: &#39;blue&#39;,</span>
<span class="sd">		...               &#39;cesiumColor&#39;: &#39;blue&#39;}</span>
<span class="sd">		... }</span>

<span class="sd">	This example assumes the use of ORS as the data provider. </span>
<span class="sd">		&gt;&gt;&gt; # If you have saved your API key as an environment variable, you may use `os.environ` to access it:</span>
<span class="sd">		&gt;&gt;&gt; import os</span>
<span class="sd">		&gt;&gt;&gt; ORS_API_KEY = os.environ[&#39;ORSKEY&#39;]</span>
<span class="sd">		&gt;&gt;&gt; # Otherwise, you may specify your key here:</span>
<span class="sd">		&gt;&gt;&gt; # ORS_API_KEY = &#39;YOUR_ORS_KEY_GOES_HERE&#39;</span>

<span class="sd">	Initialize an empty assignments dataframe:</span>
<span class="sd">		&gt;&gt;&gt; myAssignments = vrv.initDataframe(&#39;assignments&#39;)</span>


<span class="sd">	Build assignments for the truck route:</span>
<span class="sd">		&gt;&gt;&gt; endTimeSec = 0.0</span>
<span class="sd">		&gt;&gt;&gt; for arc in mySolution[&#39;truck&#39;]:</span>
<span class="sd">		...     [myAssignments, endTimeSec] = vrv.addAssignment2D(</span>
<span class="sd">		...             initAssignments  = myAssignments,</span>
<span class="sd">		...             objectID         = &#39;truck&#39;,</span>
<span class="sd">		...             modelFile        = vehicleProperties[&#39;truck&#39;][&#39;model&#39;],</span>
<span class="sd">		...             startLoc         = list(myNodes[myNodes[&#39;id&#39;] == arc[0]][[&#39;lat&#39;, &#39;lon&#39;]].values[0]),</span>
<span class="sd">		...             endLoc           = list(myNodes[myNodes[&#39;id&#39;] == arc[1]][[&#39;lat&#39;, &#39;lon&#39;]].values[0]),</span>
<span class="sd">		...             startTimeSec     = endTimeSec,</span>
<span class="sd">		...             leafletColor     = vehicleProperties[&#39;truck&#39;][&#39;leafletColor&#39;],</span>
<span class="sd">		...             cesiumColor      = vehicleProperties[&#39;truck&#39;][&#39;cesiumColor&#39;], </span>
<span class="sd">		...             routeType        = &#39;fastest&#39;,</span>
<span class="sd">		...             dataProvider     = &#39;ORS-online&#39;, </span>
<span class="sd">		...             dataProviderArgs = {&#39;APIkey&#39;: ORS_API_KEY})</span>
<span class="sd">		&gt;&gt;&gt; myAssignments</span>
<span class="sd">		</span>
<span class="sd">	Build assignments for the drone deliveries:</span>
<span class="sd">		&gt;&gt;&gt; endTimeSec = 0.0</span>
<span class="sd">		&gt;&gt;&gt; for arc in mySolution[&#39;drone&#39;]:</span>
<span class="sd">		...     [myAssignments, endTimeSec] = vrv.addAssignment3D(</span>
<span class="sd">		...         initAssignments    = myAssignments,</span>
<span class="sd">		...         objectID           = &#39;drone&#39;,</span>
<span class="sd">		...         modelFile          = vehicleProperties[&#39;drone&#39;][&#39;model&#39;],</span>
<span class="sd">		...         startLoc           = list(myNodes[myNodes[&#39;id&#39;] == arc[0]][[&#39;lat&#39;, &#39;lon&#39;]].values[0]),</span>
<span class="sd">		...         endLoc             = list(myNodes[myNodes[&#39;id&#39;] == arc[1]][[&#39;lat&#39;, &#39;lon&#39;]].values[0]),</span>
<span class="sd">		...         startTimeSec       = endTimeSec,</span>
<span class="sd">		...         takeoffSpeedMPS    = vrv.convertSpeed(30, &#39;miles&#39;, &#39;hr&#39;, &#39;meters&#39;, &#39;sec&#39;),</span>
<span class="sd">		...         cruiseSpeedMPS     = vrv.convertSpeed(80, &#39;miles&#39;, &#39;hr&#39;, &#39;meters&#39;, &#39;sec&#39;),</span>
<span class="sd">		...         landSpeedMPS       = vrv.convertSpeed( 5, &#39;miles&#39;, &#39;hr&#39;, &#39;meters&#39;, &#39;sec&#39;),</span>
<span class="sd">		...         cruiseAltMetersAGL = vrv.convertDistance(350, &#39;feet&#39;, &#39;meters&#39;),</span>
<span class="sd">		...         routeType          = &#39;square&#39;,</span>
<span class="sd">		...         leafletColor       = vehicleProperties[&#39;drone&#39;][&#39;leafletColor&#39;],</span>
<span class="sd">		...         cesiumColor        = vehicleProperties[&#39;drone&#39;][&#39;cesiumColor&#39;])</span>
<span class="sd">		&gt;&gt;&gt; myAssignments</span>
<span class="sd">		</span>
<span class="sd">	Show the nodes and assignments on a map:</span>
<span class="sd">		&gt;&gt;&gt; vrv.createLeaflet(nodes=myNodes, arcs=myAssignments)</span>

<span class="sd">	Find the location of each vehicle at time 30.0:</span>
<span class="sd">		&gt;&gt;&gt; currentLocs = vrv.findLocsAtTime(assignments=myAssignments, timeSec=30.0)</span>
<span class="sd">		&gt;&gt;&gt; </span>
<span class="sd">		&gt;&gt;&gt; # Or, we can just find the location of the drone at time 30.0:</span>
<span class="sd">		&gt;&gt;&gt; # currentLocs = vrv.findLocsAtTime(</span>
<span class="sd">		&gt;&gt;&gt; #    assignments=myAssignments[myAssignments[&#39;objectID&#39;] == &#39;drone&#39;], </span>
<span class="sd">		&gt;&gt;&gt; #    timeSec=30.0)</span>
<span class="sd">		&gt;&gt;&gt; currentLocs</span>
<span class="sd">		</span>
<span class="sd">	Display the estimated locations on a map:		</span>
<span class="sd">		&gt;&gt;&gt; myMap = vrv.createLeaflet(nodes=myNodes, arcs=myAssignments)</span>
<span class="sd">		&gt;&gt;&gt; for objectID in currentLocs:</span>
<span class="sd">		...     if (type(currentLocs[objectID]) is list):</span>
<span class="sd">		...         # This objectID has at least 1 location at this time:</span>
<span class="sd">		...         if (type(currentLocs[objectID][0]) is list):</span>
<span class="sd">		...             # There were multiple matches for this objectID:</span>
<span class="sd">		...             for i in currentLocs[objectID]:</span>
<span class="sd">		...                 myMap = vrv.addLeafletMarker(mapObject=myMap, center=i)</span>
<span class="sd">		...         else:</span>
<span class="sd">		...             # We only have one location for this objectID:</span>
<span class="sd">		...             myMap = vrv.addLeafletMarker(mapObject=myMap, </span>
<span class="sd">		...                                          center=currentLocs[objectID], </span>
<span class="sd">		...                                          radius=9, </span>
<span class="sd">		...                                          fillOpacity=0.7, </span>
<span class="sd">		...                                          fillColor=&#39;black&#39;)</span>
<span class="sd">		&gt;&gt;&gt; myMap		</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="p">[</span><span class="n">valFlag</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">,</span> <span class="n">warningMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">valFindLocsAtTime</span><span class="p">(</span><span class="n">assignments</span><span class="p">,</span> <span class="n">timeSec</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">valFlag</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">errorMsg</span><span class="p">)</span>
		<span class="k">return</span>
	<span class="k">elif</span> <span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;VRV_SETTING_SHOWWARNINGMESSAGE&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">warningMsg</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">warningMsg</span><span class="p">)</span>


	<span class="n">output</span> <span class="o">=</span> <span class="p">{}</span>

	<span class="n">asgnCopy</span> <span class="o">=</span> <span class="n">assignments</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

	<span class="c1"># Get list of unique objectIDs:</span>
	<span class="n">uniqueIDs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">asgnCopy</span><span class="p">[</span><span class="s1">&#39;objectID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>

	<span class="c1"># Replace &quot;-1&quot; end time with +infinity</span>
	<span class="n">asgnCopy</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">asgnCopy</span><span class="p">[</span><span class="s1">&#39;endTimeSec&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;endTimeSec&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;Inf&#39;</span><span class="p">)</span>

	<span class="k">for</span> <span class="n">objectID</span> <span class="ow">in</span> <span class="n">uniqueIDs</span><span class="p">:</span>
		<span class="n">tmpAsgn</span> <span class="o">=</span> <span class="n">asgnCopy</span><span class="p">[(</span><span class="n">asgnCopy</span><span class="p">[</span><span class="s1">&#39;objectID&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">objectID</span><span class="p">)</span> <span class="o">&amp;</span> 
			<span class="p">(</span><span class="n">asgnCopy</span><span class="p">[</span><span class="s1">&#39;startTimeSec&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">timeSec</span><span class="p">)</span> <span class="o">&amp;</span> 
			<span class="p">(</span><span class="n">asgnCopy</span><span class="p">[</span><span class="s1">&#39;endTimeSec&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">timeSec</span><span class="p">)]</span> 
	
		<span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tmpAsgn</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
			<span class="n">output</span><span class="p">[</span><span class="n">objectID</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
			<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: objectID `</span><span class="si">%s</span><span class="s2">` is not tracked at time </span><span class="si">%.2f</span><span class="s2"> seconds&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">objectID</span><span class="p">,</span> <span class="n">timeSec</span><span class="p">))</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">outList</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">tmpAsgn</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
				<span class="n">startLat</span>     <span class="o">=</span> <span class="n">tmpAsgn</span><span class="p">[</span><span class="s1">&#39;startLat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span>
				<span class="n">startLon</span>     <span class="o">=</span> <span class="n">tmpAsgn</span><span class="p">[</span><span class="s1">&#39;startLon&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span>
				<span class="n">startAlt</span>     <span class="o">=</span> <span class="n">tmpAsgn</span><span class="p">[</span><span class="s1">&#39;startAltMeters&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span>
				<span class="n">startTimeSec</span> <span class="o">=</span> <span class="n">tmpAsgn</span><span class="p">[</span><span class="s1">&#39;startTimeSec&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span>
			
				<span class="n">endLat</span>     <span class="o">=</span> <span class="n">tmpAsgn</span><span class="p">[</span><span class="s1">&#39;endLat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span>
				<span class="n">endLon</span>     <span class="o">=</span> <span class="n">tmpAsgn</span><span class="p">[</span><span class="s1">&#39;endLon&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span>
				<span class="n">endAlt</span>     <span class="o">=</span> <span class="n">tmpAsgn</span><span class="p">[</span><span class="s1">&#39;endAltMeters&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span>
				<span class="n">endTimeSec</span> <span class="o">=</span> <span class="n">tmpAsgn</span><span class="p">[</span><span class="s1">&#39;endTimeSec&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span>

				<span class="c1"># Find percentage of time:</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">endTimeSec</span> <span class="o">&lt;</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;Inf&#39;</span><span class="p">)):</span>
					<span class="n">pct</span> <span class="o">=</span> <span class="p">(</span><span class="n">timeSec</span> <span class="o">-</span> <span class="n">startTimeSec</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">endTimeSec</span> <span class="o">-</span> <span class="n">startTimeSec</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">pct</span> <span class="o">=</span> <span class="mf">0.0</span>
			
				<span class="c1"># Find distance from start to end:</span>
				<span class="n">distMeters</span> <span class="o">=</span> <span class="n">geoDistance2D</span><span class="p">([</span><span class="n">startLat</span><span class="p">,</span> <span class="n">startLon</span><span class="p">],</span> <span class="p">[</span><span class="n">endLat</span><span class="p">,</span> <span class="n">endLon</span><span class="p">])</span>
			
				<span class="k">if</span> <span class="p">(</span><span class="n">distMeters</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">):</span>
					<span class="n">newLoc</span> <span class="o">=</span> <span class="p">[</span><span class="n">startLat</span><span class="p">,</span> <span class="n">startLon</span><span class="p">]</span>
				<span class="k">else</span><span class="p">:</span> 
					<span class="c1"># Get initial heading from start to end:</span>
					<span class="n">hdgDeg</span> <span class="o">=</span> <span class="n">geoGetHeading</span><span class="p">([</span><span class="n">startLat</span><span class="p">,</span> <span class="n">startLon</span><span class="p">],</span> <span class="p">[</span><span class="n">endLat</span><span class="p">,</span> <span class="n">endLon</span><span class="p">])</span>

					<span class="c1"># Get expected lat/lon coords:</span>
					<span class="n">newLoc</span> <span class="o">=</span> <span class="n">geoPointInDistance2D</span><span class="p">([</span><span class="n">startLat</span><span class="p">,</span> <span class="n">startLon</span><span class="p">],</span> <span class="n">hdgDeg</span><span class="p">,</span> <span class="n">distMeters</span><span class="o">*</span><span class="n">pct</span><span class="p">)</span>

				<span class="c1"># Interpolate altitude:</span>
				<span class="n">newAlt</span> <span class="o">=</span> <span class="n">startAlt</span> <span class="o">+</span> <span class="p">(</span><span class="n">endAlt</span> <span class="o">-</span> <span class="n">startAlt</span><span class="p">)</span><span class="o">*</span><span class="n">pct</span>
			
				<span class="c1"># Add to our list of expected locations for this id:</span>
				<span class="n">outList</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">newLoc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">newLoc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">newAlt</span><span class="p">])</span>

			<span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">outList</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
				<span class="n">output</span><span class="p">[</span><span class="n">objectID</span><span class="p">]</span> <span class="o">=</span> <span class="n">outList</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
					
			<span class="k">else</span><span class="p">:</span>
				<span class="c1"># </span>
				<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: objectID `</span><span class="si">%s</span><span class="s2">` appears in </span><span class="si">%d</span><span class="s2"> matching rows.  Perhaps the assignments dataframe has duplicate entries?&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">objectID</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">tmpAsgn</span><span class="p">)))</span>
				<span class="n">output</span><span class="p">[</span><span class="n">objectID</span><span class="p">]</span> <span class="o">=</span> <span class="n">outList</span>
	
	<span class="k">return</span> <span class="n">output</span>			</div>
				
<div class="viewcode-block" id="geocode"><a class="viewcode-back" href="../../veroviz.utilities.html#veroviz.utilities.geocode">[docs]</a><span class="k">def</span> <span class="nf">geocode</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dataProvider</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dataProviderArgs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Convert a street address, city, state, or zip code to GPS coordinates ([lat, lon] format).</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	location: string, Required</span>
<span class="sd">		A text string indicating a street address, state, or zip code.</span>
<span class="sd">	dataProvider: string, Conditional, default as None</span>
<span class="sd">		Specifies the data source to be used for generating nodes on a road network. See :ref:`Data Providers` for options and requirements.</span>
<span class="sd">	dataProviderArgs: dictionary, Conditional, default as None</span>
<span class="sd">		For some data providers, additional parameters are required (e.g., API keys or database names). See :ref:`Data Providers` for the additional arguments required for each supported data provider.</span>
<span class="sd">	</span>
<span class="sd">	Return</span>
<span class="sd">	------</span>
<span class="sd">	list</span>
<span class="sd">		A GPS coordinate, of the form [lat, lon].</span>

<span class="sd">	Note</span>
<span class="sd">	----</span>
<span class="sd">	Neither pgRouting nor OSRM are supported.  </span>
<span class="sd">	pgRouting would require a database of the entire planet.  </span>
<span class="sd">	OSRM doesn&#39;t have a geocode function.</span>

<span class="sd">	Examples</span>
<span class="sd">	--------</span>
<span class="sd">	Import veroviz and check if the version is up-to-date:</span>
<span class="sd">		&gt;&gt;&gt; import veroviz as vrv</span>
<span class="sd">		&gt;&gt;&gt; vrv.checkVersion()</span>
<span class="sd">	</span>
<span class="sd">	The following examples assume the use of ORS or MapQuest as the data provider.  If you have saved your API keys as environment variables, you may use `os.environ` to access them:</span>
<span class="sd">		&gt;&gt;&gt; import os</span>
<span class="sd">		&gt;&gt;&gt; </span>
<span class="sd">		&gt;&gt;&gt; ORS_API_KEY = os.environ[&#39;ORSKEY&#39;]</span>
<span class="sd">		&gt;&gt;&gt; MQ_API_KEY = os.environ[&#39;MAPQUESTKEY&#39;]</span>
<span class="sd">		&gt;&gt;&gt; </span>
<span class="sd">		&gt;&gt;&gt; # Otherwise, you may specify your keys here:</span>
<span class="sd">		&gt;&gt;&gt; # ORS_API_KEY = &#39;YOUR_ORS_KEY_GOES_HERE&#39;</span>
<span class="sd">		&gt;&gt;&gt; # MQ_API_KEY = &#39;YOUR_MAPQUEST_KEY_GOES_HERE&#39;</span>

<span class="sd">	Example 1 - Find [lat, lon] of Buckingham Palace, without specifying a data provider:</span>
<span class="sd">		&gt;&gt;&gt; myLoc = vrv.geocode(location=&#39;Westminster, London SW1A 1AA, United Kingdom&#39;)</span>
<span class="sd">		&gt;&gt;&gt; myLoc</span>
<span class="sd">		[51.5008719, -0.1252387]</span>
<span class="sd">	</span>
<span class="sd">	Example 2 - Find [lat, lon] of Buckingham Palace, using ORS-online as the data provider:</span>
<span class="sd">		&gt;&gt;&gt; myLoc = vrv.geocode(location         =&#39;Westminster, London SW1A 1AA, United Kingdom&#39;, </span>
<span class="sd">		...                     dataProvider     =&#39;ors-online&#39;, </span>
<span class="sd">		...                     dataProviderArgs = {&#39;APIkey&#39;: ORS_API_KEY})</span>
<span class="sd">		&gt;&gt;&gt; myLoc</span>
<span class="sd">		[51.497991, -0.12875]</span>
<span class="sd">        </span>
<span class="sd">	Example 3 - Find [lat, lon] of Seattle, Washington, USA:</span>
<span class="sd">		&gt;&gt;&gt; myLoc = vrv.geocode(location         =&#39;seattle, wa&#39;, </span>
<span class="sd">		...                     dataProvider     =&#39;mapquest&#39;, </span>
<span class="sd">		...                     dataProviderArgs = {&#39;APIkey&#39;: MQ_API_KEY})</span>
<span class="sd">		&gt;&gt;&gt; myLoc</span>
<span class="sd">		[47.603229, -122.33028]</span>

<span class="sd">	Example 4 - Find [lat, lon] of the state of Florida, USA:</span>
<span class="sd">		&gt;&gt;&gt; myLoc = vrv.geocode(location         =&#39;florida&#39;, </span>
<span class="sd">		...                     dataProvider     =&#39;ors-ONLINE&#39;, </span>
<span class="sd">		...                     dataProviderArgs = {&#39;APIkey&#39;: ORS_API_KEY})</span>
<span class="sd">		&gt;&gt;&gt; myLoc</span>
<span class="sd">		[27.97762, -81.769611]</span>

<span class="sd">	Example 5 - Find [lat, lon] of the Space Needle (in Seattle, WA):</span>
<span class="sd">		&gt;&gt;&gt; myLoc = vrv.geocode(location         =&#39;space needle&#39;, </span>
<span class="sd">		...                     dataProvider     =&#39;ors-ONLINE&#39;, </span>
<span class="sd">		...                     dataProviderArgs = {&#39;APIkey&#39;: ORS_API_KEY})</span>
<span class="sd">		&gt;&gt;&gt; myLoc</span>
<span class="sd">		[47.620336, -122.349314]  </span>

<span class="sd">	Draw the geocoded location as a red dot on a Leaflet map:</span>
<span class="sd">		&gt;&gt;&gt; vrv.addLeafletMarker(center=myLoc)</span>
<span class="sd">		 </span>
<span class="sd">	&quot;&quot;&quot;</span>
	
	<span class="c1"># validation</span>
	<span class="p">[</span><span class="n">valFlag</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">,</span> <span class="n">warningMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">valGeocode</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="n">dataProvider</span><span class="p">,</span> <span class="n">dataProviderArgs</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">valFlag</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">errorMsg</span><span class="p">)</span>
		<span class="k">return</span>
	<span class="k">elif</span> <span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;VRV_SETTING_SHOWWARNINGMESSAGE&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">warningMsg</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">warningMsg</span><span class="p">)</span>

	<span class="n">loc</span> <span class="o">=</span> <span class="n">privGeocode</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="n">dataProvider</span><span class="p">,</span> <span class="n">dataProviderArgs</span><span class="p">)</span>
	
	<span class="k">return</span> <span class="n">loc</span></div>
	
<div class="viewcode-block" id="reverseGeocode"><a class="viewcode-back" href="../../veroviz.utilities.html#veroviz.utilities.reverseGeocode">[docs]</a><span class="k">def</span> <span class="nf">reverseGeocode</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dataProvider</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dataProviderArgs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>    
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Convert a GPS coordinate (of the form [lat, lon] or [lat, lon, alt]) to an address.  If altitude is provided it will be ignored.</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	location: list, Required</span>
<span class="sd">		A GPS coordinate of the form [lat, lon] or [lat, lon, alt].</span>
<span class="sd">	dataProvider: string, Conditional, default as None</span>
<span class="sd">		Specifies the data source to be used for generating nodes on a road network. See :ref:`Data Providers` for options and requirements.</span>
<span class="sd">	dataProviderArgs: dictionary, Conditional, default as None</span>
<span class="sd">		For some data providers, additional parameters are required (e.g., API keys or database names). See :ref:`Data Providers` for the additional arguments required for each supported data provider.</span>
<span class="sd">	</span>
<span class="sd">	Return</span>
<span class="sd">	------</span>
<span class="sd">	list</span>
<span class="sd">		A GPS coordinate, of the form [lat, lon], indicating the location of the returned address.  Note that this location might not match the input coordinates.</span>
<span class="sd">	dictionary</span>
<span class="sd">		A dataProvider-specific dictionary containing address details.  The keys in this dictionary may differ according to data provider.</span>

<span class="sd">	Note</span>
<span class="sd">	----</span>
<span class="sd">	Neither pgRouting nor OSRM are supported.  </span>
<span class="sd">	pgRouting would require a database of the entire planet.  </span>
<span class="sd">	OSRM doesn&#39;t have a geocode function.</span>

<span class="sd">	Examples</span>
<span class="sd">	--------</span>
<span class="sd">	Import veroviz and check if the version is up-to-date:</span>
<span class="sd">		&gt;&gt;&gt; import veroviz as vrv</span>
<span class="sd">		&gt;&gt;&gt; vrv.checkVersion()</span>
<span class="sd">	</span>
<span class="sd">	The following examples assume the use of ORS or MapQuest as the data provider.  If you have saved your API keys as environment variables, you may use `os.environ` to access them:</span>
<span class="sd">		&gt;&gt;&gt; import os</span>
<span class="sd">		&gt;&gt;&gt; </span>
<span class="sd">		&gt;&gt;&gt; ORS_API_KEY = os.environ[&#39;ORSKEY&#39;]</span>
<span class="sd">		&gt;&gt;&gt; MQ_API_KEY = os.environ[&#39;MAPQUESTKEY&#39;]</span>
<span class="sd">		&gt;&gt;&gt; </span>
<span class="sd">		&gt;&gt;&gt; # Otherwise, you may specify your keys here:</span>
<span class="sd">		&gt;&gt;&gt; # ORS_API_KEY = &#39;YOUR_ORS_KEY_GOES_HERE&#39;</span>
<span class="sd">		&gt;&gt;&gt; # MQ_API_KEY = &#39;YOUR_MAPQUEST_KEY_GOES_HERE&#39;</span>
<span class="sd">	</span>
<span class="sd">	Example 1 -- Without specifying a dataProvider:</span>
<span class="sd">		&gt;&gt;&gt; [loc, addr] = vrv.reverseGeocode(location=[47.603229, -122.33028])</span>
<span class="sd">		&gt;&gt;&gt; loc</span>
<span class="sd">		[47.6030474, -122.3302567]</span>
<span class="sd">        </span>
<span class="sd">		&gt;&gt;&gt; addr</span>
<span class="sd">		{&#39;place_id&#39;: 18472401,</span>
<span class="sd">		 &#39;licence&#39;: &#39;Data © OpenStreetMap contributors, ODbL 1.0. https://osm.org/copyright&#39;,</span>
<span class="sd">		 &#39;osm_type&#39;: &#39;node&#39;,</span>
<span class="sd">		 &#39;osm_id&#39;: 1769027877,</span>
<span class="sd">		 &#39;lat&#39;: &#39;47.6030474&#39;,</span>
<span class="sd">		 &#39;lon&#39;: &#39;-122.3302567&#39;,</span>
<span class="sd">		 &#39;display_name&#39;: &#39;SDOT, 4th Avenue, West Edge, International District/Chinatown, Seattle, King County, Washington, 98104, USA&#39;,</span>
<span class="sd">		 &#39;address&#39;: {&#39;bicycle_parking&#39;: &#39;SDOT&#39;,</span>
<span class="sd">		 &#39;road&#39;: &#39;4th Avenue&#39;,</span>
<span class="sd">		 &#39;neighbourhood&#39;: &#39;West Edge&#39;,</span>
<span class="sd">		 &#39;suburb&#39;: &#39;International District/Chinatown&#39;,</span>
<span class="sd">		 &#39;city&#39;: &#39;Seattle&#39;,</span>
<span class="sd">		 &#39;county&#39;: &#39;King County&#39;,</span>
<span class="sd">		 &#39;state&#39;: &#39;Washington&#39;,</span>
<span class="sd">		 &#39;postcode&#39;: &#39;98104&#39;,</span>
<span class="sd">		 &#39;country&#39;: &#39;USA&#39;,</span>
<span class="sd">		 &#39;country_code&#39;: &#39;us&#39;},</span>
<span class="sd">		 &#39;boundingbox&#39;: [&#39;47.6029474&#39;, &#39;47.6031474&#39;, &#39;-122.3303567&#39;, &#39;-122.3301567&#39;]}</span>
<span class="sd">	</span>
<span class="sd">	Example 2 -- Using MapQuest:</span>
<span class="sd">		&gt;&gt;&gt; [loc, addr] = vrv.reverseGeocode(location         = [47.603229, -122.33028], </span>
<span class="sd">		...                                  dataProvider     = &#39;MapQuest&#39;, </span>
<span class="sd">		...                                  dataProviderArgs = {&#39;APIkey&#39;: MQ_API_KEY})</span>
<span class="sd">		&gt;&gt;&gt; loc</span>
<span class="sd">		[47.603229, -122.33028]</span>
<span class="sd">		</span>
<span class="sd">		&gt;&gt;&gt; addr</span>
<span class="sd">		{&#39;street&#39;: &#39;431 James St&#39;,</span>
<span class="sd">		 &#39;adminArea6&#39;: &#39;&#39;,</span>
<span class="sd">		 &#39;adminArea6Type&#39;: &#39;Neighborhood&#39;,</span>
<span class="sd">		 &#39;adminArea5&#39;: &#39;Seattle&#39;,</span>
<span class="sd">		 &#39;adminArea5Type&#39;: &#39;City&#39;,</span>
<span class="sd">		 &#39;adminArea4&#39;: &#39;King&#39;,</span>
<span class="sd">		 &#39;adminArea4Type&#39;: &#39;County&#39;,</span>
<span class="sd">		 &#39;adminArea3&#39;: &#39;WA&#39;,</span>
<span class="sd">		 &#39;adminArea3Type&#39;: &#39;State&#39;,</span>
<span class="sd">		 &#39;adminArea1&#39;: &#39;US&#39;,</span>
<span class="sd">		 &#39;adminArea1Type&#39;: &#39;Country&#39;,</span>
<span class="sd">		 &#39;postalCode&#39;: &#39;98104&#39;,</span>
<span class="sd">		 &#39;geocodeQualityCode&#39;: &#39;L1AAA&#39;,</span>
<span class="sd">		 &#39;geocodeQuality&#39;: &#39;ADDRESS&#39;,</span>
<span class="sd">		 &#39;dragPoint&#39;: False,</span>
<span class="sd">		 &#39;sideOfStreet&#39;: &#39;R&#39;,</span>
<span class="sd">		 &#39;linkId&#39;: &#39;0&#39;,</span>
<span class="sd">		 &#39;unknownInput&#39;: &#39;&#39;,</span>
<span class="sd">		 &#39;type&#39;: &#39;s&#39;,</span>
<span class="sd">		 &#39;latLng&#39;: {&#39;lat&#39;: 47.603229, &#39;lng&#39;: -122.33028},</span>
<span class="sd">		 &#39;displayLatLng&#39;: {&#39;lat&#39;: 47.603229, &#39;lng&#39;: -122.33028},</span>
<span class="sd">		 &#39;nearestIntersection&#39;: {&#39;streetDisplayName&#39;: &#39;4th Ave&#39;,</span>
<span class="sd">		 &#39;distanceMeters&#39;: &#39;0.0&#39;,</span>
<span class="sd">		 &#39;latLng&#39;: {&#39;longitude&#39;: -122.33028, &#39;latitude&#39;: 47.603229},</span>
<span class="sd">		 &#39;label&#39;: &#39;James St &amp; 4th Ave&#39;},</span>
<span class="sd">		 &#39;roadMetadata&#39;: {&#39;speedLimitUnits&#39;: &#39;mph&#39;,</span>
<span class="sd">		 &#39;tollRoad&#39;: None,</span>
<span class="sd">		 &#39;speedLimit&#39;: 25}}</span>
<span class="sd">		 </span>
<span class="sd">	Example 3 -- Using OpenRouteService:</span>
<span class="sd">		&gt;&gt;&gt; [loc, addr] = vrv.reverseGeocode(location         = [47.603229, -122.33028], </span>
<span class="sd">		...                                  dataProvider     = &#39;ORS-online&#39;, </span>
<span class="sd">		...                                  dataProviderArgs = {&#39;APIkey&#39;: ORS_API_KEY})</span>
<span class="sd">		&gt;&gt;&gt; loc</span>
<span class="sd">		[47.603077, -122.330139]</span>
<span class="sd">		</span>
<span class="sd">		&gt;&gt;&gt; addr</span>
<span class="sd">		{&#39;id&#39;: &#39;node/4491511984&#39;,</span>
<span class="sd">		 &#39;gid&#39;: &#39;openstreetmap:venue:node/4491511984&#39;,</span>
<span class="sd">		 &#39;layer&#39;: &#39;venue&#39;,</span>
<span class="sd">		 &#39;source&#39;: &#39;openstreetmap&#39;,</span>
<span class="sd">		 &#39;source_id&#39;: &#39;node/4491511984&#39;,</span>
<span class="sd">		 &#39;name&#39;: &#39;4th Ave &amp; James St&#39;,</span>
<span class="sd">		 &#39;confidence&#39;: 0.8,</span>
<span class="sd">		 &#39;distance&#39;: 0.02,</span>
<span class="sd">		 &#39;accuracy&#39;: &#39;point&#39;,</span>
<span class="sd">		 &#39;country&#39;: &#39;United States&#39;,</span>
<span class="sd">		 &#39;country_gid&#39;: &#39;whosonfirst:country:85633793&#39;,</span>
<span class="sd">		 &#39;country_a&#39;: &#39;USA&#39;,</span>
<span class="sd">		 &#39;region&#39;: &#39;Washington&#39;,</span>
<span class="sd">		 &#39;region_gid&#39;: &#39;whosonfirst:region:85688623&#39;,</span>
<span class="sd">		 &#39;region_a&#39;: &#39;WA&#39;,</span>
<span class="sd">		 &#39;county&#39;: &#39;King County&#39;,</span>
<span class="sd">		 &#39;county_gid&#39;: &#39;whosonfirst:county:102086191&#39;,</span>
<span class="sd">		 &#39;county_a&#39;: &#39;KN&#39;,</span>
<span class="sd">		 &#39;locality&#39;: &#39;Seattle&#39;,</span>
<span class="sd">		 &#39;locality_gid&#39;: &#39;whosonfirst:locality:101730401&#39;,</span>
<span class="sd">		 &#39;neighbourhood&#39;: &#39;Pioneer Square&#39;,</span>
<span class="sd">		 &#39;neighbourhood_gid&#39;: &#39;whosonfirst:neighbourhood:85866047&#39;,</span>
<span class="sd">		 &#39;continent&#39;: &#39;North America&#39;,</span>
<span class="sd">		 &#39;continent_gid&#39;: &#39;whosonfirst:continent:102191575&#39;,</span>
<span class="sd">		 &#39;label&#39;: &#39;4th Ave &amp; James St, Seattle, WA, USA&#39;}</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="c1"># validation</span>
	<span class="p">[</span><span class="n">valFlag</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">,</span> <span class="n">warningMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">valReverseGeocode</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="n">dataProvider</span><span class="p">,</span> <span class="n">dataProviderArgs</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">valFlag</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">errorMsg</span><span class="p">)</span>
		<span class="k">return</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
	<span class="k">elif</span> <span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;VRV_SETTING_SHOWWARNINGMESSAGE&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">warningMsg</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">warningMsg</span><span class="p">)</span>

	<span class="p">[</span><span class="n">loc</span><span class="p">,</span> <span class="n">address</span><span class="p">]</span> <span class="o">=</span> <span class="n">privReverseGeocode</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="n">dataProvider</span><span class="p">,</span> <span class="n">dataProviderArgs</span><span class="p">)</span>

	<span class="k">return</span> <span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="n">address</span><span class="p">)</span>	</div>

<div class="viewcode-block" id="isochrones"><a class="viewcode-back" href="../../veroviz.utilities.html#veroviz.utilities.isochrones">[docs]</a><span class="k">def</span> <span class="nf">isochrones</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">locationType</span><span class="o">=</span><span class="s1">&#39;start&#39;</span><span class="p">,</span> <span class="n">travelMode</span><span class="o">=</span><span class="s1">&#39;driving-car&#39;</span><span class="p">,</span> <span class="n">rangeType</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">,</span> <span class="n">rangeSize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">smoothing</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">dataProvider</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dataProviderArgs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>    
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Finds isochrones (lines corresponding to points of equal distance or time from a given location) to or from a given location.  </span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	location: list, Required</span>
<span class="sd">		A GPS coordinate of the form [lat, lon] or [lat, lon, alt].  If provided, altitude will be ignored (i.e., assumed to be 0).</span>
<span class="sd">	locationType: string, Required, default as &#39;start&#39;</span>
<span class="sd">		Specifies whether `location` is the start or the destination.  Valid options are &#39;start&#39; or &#39;destination&#39;</span>
<span class="sd">	travelMode: string, Required, default as &#39;driving-car&#39;</span>
<span class="sd">		Specifies the mode of travel.  Valid options are: &#39;driving-car&#39;, &#39;driving-hgv&#39;, &#39;cycling-regular&#39;, &#39;cycling-road&#39;, &#39;cycling-mountain&#39;, &#39;cycling-electric&#39;, &#39;foot-walking&#39;, &#39;foot-hiking&#39;, or &#39;wheelchair&#39;.</span>
<span class="sd">	rangeType: string, Required, default as &#39;distance&#39;</span>
<span class="sd">		Indicates whether the isochrones are based on distance or time.  Valid options are &#39;distance&#39; or &#39;time&#39;.</span>
<span class="sd">	rangeSize: positive float, Required, default as None</span>
<span class="sd">		The isochrones will indicate the area accessible from the given location within the rangeSize.  rangeSize is in units of [meters] if rangeType equals &#39;distance&#39;; rangeSize is in units of [seconds] if rangeType equals &#39;time&#39;.</span>
<span class="sd">	interval: float, Optional, default as None</span>
<span class="sd">		If provided, this parameter can be used to generate multiple concentric isochrones.  For example, if rangeSize = 90, and interval = 30, isochrones will be identified for ranges of 30, 60, and 90 units.  If interval is not provided (as is the default), only one isochrone will be determined.</span>
<span class="sd">	smoothing: float in range [0, 100], Optional, default as 25</span>
<span class="sd">		Indicates the granularity of the isochrones.  Smoothing values close to 0 will produce jagged isochrones; values close to 100 will generally result in smooth isochrones.	</span>
<span class="sd">	dataProvider: string, Required, default as None</span>
<span class="sd">		Specifies the data source to be used for obtaining isochrone data. See :ref:`Data Providers` for options and requirements.</span>
<span class="sd">	dataProviderArgs: dictionary, Required, default as None</span>
<span class="sd">		For some data providers, additional parameters are required (e.g., API keys or database names). See :ref:`Data Providers` for the additional arguments required for each supported data provider.</span>
<span class="sd">	</span>
<span class="sd">	Return</span>
<span class="sd">	------</span>
<span class="sd">	dictionary with nested dictionaries and lists</span>
<span class="sd">		Check the note for the structure of dictionary.</span>

<span class="sd">	Note</span>
<span class="sd">	----</span>
<span class="sd">	This dictionary has the following structure:</span>
<span class="sd">		&gt;&gt;&gt; {</span>
<span class="sd">		&gt;&gt;&gt;     &#39;location&#39;: [lat, lon],		# Matches the user&#39;s &#39;location&#39; input value</span>
<span class="sd">		&gt;&gt;&gt;     &#39;boundingRegion&#39;: [[lat, lon], [lat, lon], [lat, lon], [lat, lon]],  # The smallest rectangle that encloses all isochrones.</span>
<span class="sd">		&gt;&gt;&gt;     &#39;isochrones&#39;:</span>
<span class="sd">		&gt;&gt;&gt;     [</span>
<span class="sd">		&gt;&gt;&gt;         {</span>
<span class="sd">		&gt;&gt;&gt;             &#39;value&#39;:  # Either the time or distance assoc. with this isochrone.</span>
<span class="sd">		&gt;&gt;&gt;             &#39;valueUnits&#39;: # either &#39;seconds&#39; or &#39;meters&#39;.</span>
<span class="sd">		&gt;&gt;&gt;             &#39;area&#39;:  # The area enclosed by the isochrone, in square meters.</span>
<span class="sd">		&gt;&gt;&gt;             &#39;pop&#39;:   # The estimated population within the isochrone.</span>
<span class="sd">		&gt;&gt;&gt;             &#39;reachfactor&#39;:  # FIXME -- not sure what this represents.</span>
<span class="sd">		&gt;&gt;&gt;             &#39;poly&#39;: [[]]	# A list of lists describing polylines.</span>
<span class="sd">		&gt;&gt;&gt;                 # A list of GPS coordinates, of the form [[[lat, lon], [lat, lon], ..., [lat, lon]], []] defining a polygon.  This polygon describes the isochrones.</span>
<span class="sd">		&gt;&gt;&gt;         },</span>
<span class="sd">		&gt;&gt;&gt;         {</span>
<span class="sd">		&gt;&gt;&gt;             ...</span>
<span class="sd">		&gt;&gt;&gt;         }</span>
<span class="sd">		&gt;&gt;&gt;     ]</span>
<span class="sd">		&gt;&gt;&gt; }    						</span>
<span class="sd">		</span>
<span class="sd">	Note</span>
<span class="sd">	----</span>
<span class="sd">	Currently, only &#39;ors-online&#39; and &#39;ors-local&#39; are supported.  Neither mapQuest, pgRouting, nor OSRM are supported, as they don&#39;t appear to have native support for isochrones.  </span>

<span class="sd">	Examples</span>
<span class="sd">	--------</span>
<span class="sd">                     	</span>
<span class="sd">	Import veroviz and check if the version is up-to-date:</span>
<span class="sd">		&gt;&gt;&gt; import veroviz as vrv</span>
<span class="sd">		&gt;&gt;&gt; vrv.checkVersion()</span>
<span class="sd">	</span>
<span class="sd">	The following examples assume the use of ORS as the data provider.  If you have saved your API keys as environment variables, you may use `os.environ` to access them:</span>
<span class="sd">		&gt;&gt;&gt; import os</span>
<span class="sd">		&gt;&gt;&gt; </span>
<span class="sd">		&gt;&gt;&gt; ORS_API_KEY = os.environ[&#39;ORSKEY&#39;]</span>
<span class="sd">		&gt;&gt;&gt; </span>
<span class="sd">		&gt;&gt;&gt; # Otherwise, you may specify your keys here:</span>
<span class="sd">		&gt;&gt;&gt; # ORS_API_KEY = &#39;YOUR_ORS_KEY_GOES_HERE&#39;</span>

<span class="sd">	Example 1 - Get distance-based isochrones from a given location:</span>
<span class="sd">		&gt;&gt;&gt; iso = vrv.isochrones(location         = [43.00154, -78.7871],</span>
<span class="sd">		...                      rangeType        = &#39;distance&#39;, </span>
<span class="sd">		...                      rangeSize        = 4000, </span>
<span class="sd">		...                      dataProvider     = &#39;ors-online&#39;, </span>
<span class="sd">		...                      dataProviderArgs = {&#39;APIkey&#39;: os.environ[&#39;ORSKEY&#39;]})</span>
<span class="sd">		&gt;&gt;&gt; iso</span>
<span class="sd">	</span>
<span class="sd">	Draw the result on a Leaflet map:</span>
<span class="sd">		&gt;&gt;&gt; vrv.addLeafletIsochrones(iso=iso)</span>
<span class="sd">		&gt;&gt;&gt; </span>
<span class="sd">		&gt;&gt;&gt; # Click on the shaded area of the map for additional info</span>

<span class="sd">	Example 2 - This example includes all function arguments:</span>
<span class="sd">		&gt;&gt;&gt; iso2 = vrv.isochrones(location         = [43.00154, -78.7871], </span>
<span class="sd">		...                       locationType     = &#39;start&#39;, </span>
<span class="sd">		...                       travelMode       = &#39;driving-car&#39;, </span>
<span class="sd">		...                       rangeType        = &#39;time&#39;, </span>
<span class="sd">		...                       rangeSize        = vrv.convertTime(5, &#39;minutes&#39;, &#39;seconds&#39;), </span>
<span class="sd">		...                       interval         = vrv.convertTime(1, &#39;minutes&#39;, &#39;seconds&#39;), </span>
<span class="sd">		...                       smoothing        = 5, </span>
<span class="sd">		...                       dataProvider     =&#39;ors-online&#39;, </span>
<span class="sd">		...                       dataProviderArgs = {&#39;APIkey&#39;: os.environ[&#39;ORSKEY&#39;]})</span>
<span class="sd">		&gt;&gt;&gt;</span>
<span class="sd">		&gt;&gt;&gt; vrv.addLeafletIsochrones(iso=iso2)</span>
<span class="sd">		</span>
<span class="sd">	Customize the map by using the `addLeafletPolygon()` function:	</span>
<span class="sd">		&gt;&gt;&gt;	myColors = [&#39;red&#39;, &#39;blue&#39;, &#39;green&#39;]</span>
<span class="sd">		&gt;&gt;&gt;	</span>
<span class="sd">		&gt;&gt;&gt;	myMap = vrv.addLeafletIcon(location=iso2[&#39;location&#39;])</span>
<span class="sd">		&gt;&gt;&gt;	</span>
<span class="sd">		&gt;&gt;&gt;	for i in range(len(iso2[&#39;isochrones&#39;])-1, -1, -1):</span>
<span class="sd">		...     lineColor = myColors[i % len(myColors)]</span>
<span class="sd">		...     fillColor = lineColor</span>
<span class="sd">		...     for j in range(0, len(iso2[&#39;isochrones&#39;][i][&#39;poly&#39;])):</span>
<span class="sd">		...         myMap = vrv.addLeafletPolygon(mapObject = myMap,</span>
<span class="sd">		...                                       points    = iso2[&#39;isochrones&#39;][i][&#39;poly&#39;][j],</span>
<span class="sd">		...                                       lineColor = lineColor,</span>
<span class="sd">		...                                       fillColor = fillColor)</span>
<span class="sd">		&gt;&gt;&gt;	</span>
<span class="sd">		&gt;&gt;&gt;	myMap   	</span>
<span class="sd">	&quot;&quot;&quot;</span>
	
	
	<span class="c1"># validation</span>
	<span class="p">[</span><span class="n">valFlag</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">,</span> <span class="n">warningMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">valIsochrones</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="n">locationType</span><span class="p">,</span> <span class="n">travelMode</span><span class="p">,</span> <span class="n">rangeType</span><span class="p">,</span> <span class="n">rangeSize</span><span class="p">,</span> <span class="n">interval</span><span class="p">,</span> <span class="n">smoothing</span><span class="p">,</span> <span class="n">dataProvider</span><span class="p">,</span> <span class="n">dataProviderArgs</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">valFlag</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">errorMsg</span><span class="p">)</span>
		<span class="k">return</span> <span class="kc">None</span>
	<span class="k">elif</span> <span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;VRV_SETTING_SHOWWARNINGMESSAGE&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">warningMsg</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">warningMsg</span><span class="p">)</span>

	
	<span class="k">if</span> <span class="p">(</span><span class="n">interval</span> <span class="o">==</span> <span class="kc">None</span><span class="p">):</span>
		<span class="n">interval</span> <span class="o">=</span> <span class="n">rangeSize</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">interval</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">interval</span><span class="p">,</span> <span class="n">rangeSize</span><span class="p">)</span>
		
	<span class="n">iso</span> <span class="o">=</span> <span class="n">privIsochrones</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="n">locationType</span><span class="p">,</span> <span class="n">travelMode</span><span class="p">,</span> <span class="n">rangeType</span><span class="p">,</span> <span class="n">rangeSize</span><span class="p">,</span> <span class="n">interval</span><span class="p">,</span> <span class="n">smoothing</span><span class="p">,</span> <span class="n">dataProvider</span><span class="p">,</span> <span class="n">dataProviderArgs</span><span class="p">)</span>
	
	<span class="k">return</span> <span class="n">iso</span></div>

<div class="viewcode-block" id="createGantt"><a class="viewcode-back" href="../../veroviz.utilities.html#veroviz.utilities.createGantt">[docs]</a><span class="k">def</span> <span class="nf">createGantt</span><span class="p">(</span><span class="n">assignments</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">objectIDorder</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">separateByModelFile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">mergeByodID</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">splitOnColorChange</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xAxisLabel</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">xGrid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">yGrid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">xMin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">xMax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xGridFreq</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">timeFormat</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">overlayColumn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">missingColor</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	EXPERIMENTAL.  Draws a Gantt chart from an :ref:`Assignments` dataframe.  This has the appearance of a horizontal bar chart.  The x-axis indicates the elapsed time.  Each `objectID` forms a horizontal bar.</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	assignments: :ref:`Assignments` dataframe, Required, default as None</span>
<span class="sd">		The activities and event times are drawn from the `Assignments` dataframe.  Bar colors are specified by the `leafletColor` column of the dataframe.</span>
<span class="sd">	objectIDorder: list, Optional, default as None</span>
<span class="sd">		A list containing values from the `objectID` column of the `assignments` dataframe.  If provided, this list will be used to determine the order in which `objectID`s are displayed on the y-axis of the Gantt chart, where the first item in the list will be on the bottom and the last item will be on top.</span>
<span class="sd">	separateByModelFile: boolean, Optional, default as False</span>
<span class="sd">		If `True`, Gantt chart bars will be formed by the unique combination of the `objectID` and `modelFile` columns of the `assignments` dataframe.  By default, only the `objectID` column will be used to specify the bars.  Note: This field affects the y-axis groupings.</span>
<span class="sd">	mergeByodID: boolean, Optional, default as True</span>
<span class="sd">		If `True`, consecutive assignments that have the same `odID` value (for a particular row of the Gantt chart) and do not have a gap in timing (i.e., the end time of the preceding assignment row equals the start time of the next assignment) will be combined into a single cell.  If `False`, each row of the assignments dataframe will result in a separate Gantt chart cell.  This can lead to a very cluttered figure.</span>
<span class="sd">	splitOnColorChange: boolean, Optional, default as True</span>
<span class="sd">		If `True`, a cell will be split if the `ganttColor` value in the preceding assignment is different (even if the odID is the same and there are no timing gaps).  This case typically would occur if a static assignment (such as a service activity) was appended to a route, and the static assignment has the same odID, and the static assignment did have a `ganttColor` value in the `assignments` dataframe, and `missingColor` is not None.  This defaults to True to help flag these cases; in which case you probably want to fix your assignments dataframe.</span>
<span class="sd">	title: string, Optional, default as None</span>
<span class="sd">		A title to appear above the Gantt chart.</span>
<span class="sd">	xAxisLabel: string, Optional, default as &#39;time&#39;</span>
<span class="sd">		A label to appear below the x-axis.		  </span>
<span class="sd">	xGrid: boolean, Optional, default as False</span>
<span class="sd">		If `True`, vertical lines will be displayed on the Gantt chart.</span>
<span class="sd">	yGrid: boolean, Optional, default as False</span>
<span class="sd">		If `True`, horizontal lines will be displayed on the Gantt chart.</span>
<span class="sd">	xMin: non-negative float, Optional, default as 0 </span>
<span class="sd">		Specifies the minimum value to display on the x-axis, in units of [seconds].</span>
<span class="sd">	xMax: positive float, Optional, default as None</span>
<span class="sd">		Specifies the maximum value to display on the x-axis, in units of [seconds].  If None (default), xMax will be automatically determined from the `endTimeSeconds` column of the `assignments` dataframe.</span>
<span class="sd">	xGridFreq: positive float, Optional, default as 60</span>
<span class="sd">		Specifies the spacing between tick labels on the x-axis, in units of [seconds].</span>
<span class="sd">	timeFormat: string, Optional, default as &#39;s&#39;</span>
<span class="sd">		Specifies the formatting of the x-axis tick marks.  Valid options are: &#39;DHMS&#39; (days:hours:minutes:seconds), &#39;HMS&#39; (hours:minutes:seconds), &#39;MS&#39; (minutes:seconds), &#39;D&#39; (fractional number of days), &#39;H&#39; (fractional number of hours), &#39;M&#39; (fractional number of minutes), or &#39;S&#39; (integer number of seconds).</span>
<span class="sd">	overlayColumn: string, Optional, default as None</span>
<span class="sd">		There are three options: None, &#39;odID&#39;, or &#39;index&#39;.  If None (default), no labels will be shown within each bar cell of the Gantt chart.  If &#39;odID&#39;, each bar cell will display the corresponding odID value.  This only makes sense if `mergeByodID` is True.  If &#39;index&#39;, each bar cell will display the index column value of the `assignments` dataframe.  This can be cluttered, but may be useful for debugging (allowing a mapping from the Gantt chart elements to the particular rows of the assignments dataframe).</span>
<span class="sd">	missingColor: string, Optional, default as &#39;lightgray&#39;</span>
<span class="sd">		Specifies the default color to use if the assignments dataframe is missing a color for a particular row.  Use `None` if you do not want to use a default color.</span>
<span class="sd">	filename: string, Optional, default as None</span>
<span class="sd">		If provided, the Gant chart will be saved to this file.  The image format will be automatically determined by the file extension (e.g., `.jpg`, `.png`, or `.pdf`).</span>

<span class="sd">	Return</span>
<span class="sd">	------</span>
<span class="sd">	object</span>
<span class="sd">		A matplotlib figure object.</span>

<span class="sd">	Examples</span>
<span class="sd">	--------					</span>
<span class="sd">	Import veroviz and check if the version is up-to-date:</span>
<span class="sd">		&gt;&gt;&gt; import veroviz as vrv</span>
<span class="sd">		&gt;&gt;&gt; vrv.checkVersion()</span>

<span class="sd">	Start by defining some locations for our vehicles to visit:</span>
<span class="sd">		&gt;&gt;&gt; locs = [[42.8871085, -78.8731949],</span>
<span class="sd">		...         [42.8888311, -78.8649649],</span>
<span class="sd">		...         [42.8802158, -78.8660787],</span>
<span class="sd">		...         [42.8845705, -78.8762794],</span>
<span class="sd">		...         [42.8908031, -78.8770140]]</span>

<span class="sd">	Convert these locations into a `Nodes` dataframe:</span>
<span class="sd">		&gt;&gt;&gt; myNodes = vrv.createNodesFromLocs(locs=locs)</span>
<span class="sd">		&gt;&gt;&gt; myNodes</span>

<span class="sd">	A car will start at node 1, visit nodes 2 and 3, and then return to node 1.  A truck will follow a route from 1-&gt;5-&gt;4-&gt;1.</span>
<span class="sd">		&gt;&gt;&gt; mySolution = {</span>
<span class="sd">		...     &#39;car&#39;: [[1,2], [2,3], [3,1]],</span>
<span class="sd">		...     &#39;truck&#39;: [[1,5], [5,4], [4,1]]</span>
<span class="sd">		&gt;&gt;&gt; }</span>
<span class="sd">		mySolution</span>

<span class="sd">	Define some properties to use when building the `Assignments` dataframe:</span>
<span class="sd">		&gt;&gt;&gt; vehicleProperties = {</span>
<span class="sd">		...     &#39;car&#39;:   {&#39;model&#39;: &#39;veroviz/models/car_red.gltf&#39;,</span>
<span class="sd">		...               &#39;color&#39;: &#39;red&#39;},</span>
<span class="sd">		...     &#39;truck&#39;: {&#39;model&#39;: &#39;veroviz/models/ub_truck.gltf&#39;,</span>
<span class="sd">		...               &#39;color&#39;: &#39;blue&#39;}</span>
<span class="sd">		&gt;&gt;&gt; }</span>

<span class="sd">	Build the assignments dataframe for the 2 vehicle routes.  No service times, Euclidean travel:</span>
<span class="sd">		&gt;&gt;&gt; myAssignments = vrv.initDataframe(&#39;assignments&#39;)</span>
<span class="sd">		&gt;&gt;&gt; for v in mySolution:</span>
<span class="sd">		...     endTimeSec = 0.0</span>
<span class="sd">		...     for arc in mySolution[v]:</span>
<span class="sd">		...         [myAssignments, endTimeSec] = vrv.addAssignment2D(</span>
<span class="sd">		...             initAssignments = myAssignments,</span>
<span class="sd">		...             objectID        = v,</span>
<span class="sd">		...             modelFile       = vehicleProperties[v][&#39;model&#39;],</span>
<span class="sd">		...             startLoc        = list(myNodes[myNodes[&#39;id&#39;] == arc[0]][[&#39;lat&#39;, &#39;lon&#39;]].values[0]),</span>
<span class="sd">		...             endLoc          = list(myNodes[myNodes[&#39;id&#39;] == arc[1]][[&#39;lat&#39;, &#39;lon&#39;]].values[0]),</span>
<span class="sd">		...             startTimeSec    = endTimeSec,</span>
<span class="sd">		...             routeType       = &#39;euclidean2D&#39;,</span>
<span class="sd">		...             speedMPS        = vrv.convertSpeed(25, &#39;miles&#39;, &#39;hour&#39;, &#39;meters&#39;, &#39;second&#39;),</span>
<span class="sd">		...             leafletColor    = vehicleProperties[v][&#39;color&#39;],</span>
<span class="sd">		...             cesiumColor     = vehicleProperties[v][&#39;color&#39;],</span>
<span class="sd">		...             ganttColor      = vehicleProperties[v][&#39;color&#39;])</span>
<span class="sd">		&gt;&gt;&gt; myAssignments</span>

<span class="sd">	Create a Gantt chart using the default settings:</span>
<span class="sd">		&gt;&gt;&gt; vrv.createGantt(assignments = myAssignments, </span>
<span class="sd">		...                 xAxisLabel  = &#39;time [seconds]&#39;)</span>

<span class="sd">	Create (and save) a Gantt chart using all of the available settings:</span>
<span class="sd">		&gt;&gt;&gt; vrv.createGantt(assignments         = myAssignments, </span>
<span class="sd">		...                 objectIDorder       = [&#39;truck&#39;, &#39;car&#39;], </span>
<span class="sd">		...                 separateByModelFile = False,</span>
<span class="sd">		...                 mergeByodID         = True,</span>
<span class="sd">		...                 splitOnColorChange  = True,</span>
<span class="sd">		...                 title               = &#39;My Title&#39;,</span>
<span class="sd">		...                 xAxisLabel          = &#39;time [mm:ss]&#39;,</span>
<span class="sd">		...                 xGrid               = True,</span>
<span class="sd">		...                 yGrid               = False,</span>
<span class="sd">		...                 xMin                = 0,</span>
<span class="sd">		...                 xMax                = None,</span>
<span class="sd">		...                 xGridFreq           = 30,</span>
<span class="sd">		...                 timeFormat          = &#39;MS&#39;,</span>
<span class="sd">		...                 overlayColumn       = &#39;odID&#39;,</span>
<span class="sd">		...                 missingColor        = &#39;lightgray&#39;,</span>
<span class="sd">		...                 filename            = &#39;myGantt.png&#39;)</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="c1"># validation</span>
	<span class="p">[</span><span class="n">valFlag</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">,</span> <span class="n">warningMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">valCreateGantt</span><span class="p">(</span><span class="n">assignments</span><span class="p">,</span> <span class="n">objectIDorder</span><span class="p">,</span> <span class="n">separateByModelFile</span><span class="p">,</span> <span class="n">mergeByodID</span><span class="p">,</span> <span class="n">splitOnColorChange</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">xAxisLabel</span><span class="p">,</span> <span class="n">xGrid</span><span class="p">,</span> <span class="n">yGrid</span><span class="p">,</span> <span class="n">xMin</span><span class="p">,</span> <span class="n">xMax</span><span class="p">,</span> <span class="n">xGridFreq</span><span class="p">,</span> <span class="n">timeFormat</span><span class="p">,</span> <span class="n">overlayColumn</span><span class="p">,</span> <span class="n">missingColor</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">valFlag</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">errorMsg</span><span class="p">)</span>
		<span class="k">return</span> <span class="kc">None</span>
	<span class="k">elif</span> <span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;VRV_SETTING_SHOWWARNINGMESSAGE&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">warningMsg</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">warningMsg</span><span class="p">)</span>


	<span class="n">BAR_HEIGHT</span>    <span class="o">=</span> <span class="mi">8</span>
	<span class="n">BAR_STEP_SIZE</span> <span class="o">=</span> <span class="mi">10</span>

	<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">objectIDorder</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
		<span class="n">objectIDorder</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">assignments</span><span class="p">[</span><span class="s1">&#39;objectID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
	
	
	<span class="k">if</span> <span class="p">(</span><span class="n">separateByModelFile</span><span class="p">):</span>
		<span class="c1"># Group y-axis labels by objectID and modelFile:</span>
		<span class="c1"># yLabels = list((assignments[&#39;objectID&#39;].map(str) + &#39; - &#39; + assignments[&#39;modelFile&#39;].map(str)).unique())</span>
		<span class="n">yLabels</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">yTicks</span>  <span class="o">=</span> <span class="p">[]</span>
		<span class="n">y</span>       <span class="o">=</span> <span class="mi">2</span>
		<span class="k">for</span> <span class="n">objectID</span> <span class="ow">in</span> <span class="n">objectIDorder</span><span class="p">:</span>
			<span class="n">modelFiles</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">assignments</span><span class="p">[</span><span class="n">assignments</span><span class="p">[</span><span class="s1">&#39;objectID&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">objectID</span><span class="p">][</span><span class="s1">&#39;modelFile&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
			<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">modelFiles</span><span class="p">)):</span>
				<span class="n">yLabels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">objectID</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; - &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">modelFiles</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
				<span class="n">yTicks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="n">BAR_HEIGHT</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> 
				<span class="n">y</span> <span class="o">+=</span> <span class="n">BAR_HEIGHT</span>
			<span class="n">y</span> <span class="o">+=</span> <span class="mi">2</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="c1"># Only group y-axis labels by objectID</span>
		<span class="c1"># yGroups = list(assignments[&#39;objectID&#39;].unique())</span>
		<span class="n">yLabels</span> <span class="o">=</span> <span class="n">objectIDorder</span>
		<span class="n">yTicks</span>  <span class="o">=</span> <span class="p">[]</span>
		<span class="n">y</span> <span class="o">=</span> <span class="mi">2</span> 
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">yLabels</span><span class="p">)):</span>
			<span class="n">yTicks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="n">BAR_HEIGHT</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
			<span class="n">y</span> <span class="o">+=</span> <span class="n">BAR_STEP_SIZE</span>

	<span class="n">yTicks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

	<span class="n">maxEnd</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">assignments</span><span class="p">[</span><span class="s1">&#39;endTimeSec&#39;</span><span class="p">])</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">xMax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
		<span class="n">xMax</span> <span class="o">=</span> <span class="n">xMin</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="n">maxEnd</span> <span class="o">-</span> <span class="n">xMin</span><span class="p">)</span><span class="o">/</span><span class="n">xGridFreq</span><span class="p">)</span> <span class="o">*</span> <span class="n">xGridFreq</span>
	
	<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xMin</span><span class="p">,</span> <span class="n">xMax</span><span class="p">)</span>

	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">yLabels</span><span class="p">)):</span>
		<span class="n">myLabel</span> <span class="o">=</span> <span class="n">yLabels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
		<span class="n">y</span> <span class="o">=</span> <span class="n">yTicks</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">separateByModelFile</span><span class="p">):</span>
			<span class="n">dummy</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">assignments</span><span class="p">[</span><span class="n">assignments</span><span class="p">[</span><span class="s1">&#39;objectID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; - &#39;</span> <span class="o">+</span> <span class="n">assignments</span><span class="p">[</span><span class="s1">&#39;modelFile&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="o">==</span> <span class="n">myLabel</span><span class="p">])</span>
			<span class="n">dummy</span><span class="p">[</span><span class="s1">&#39;asgnIndex&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">assignments</span><span class="p">[</span><span class="n">assignments</span><span class="p">[</span><span class="s1">&#39;objectID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; - &#39;</span> <span class="o">+</span> <span class="n">assignments</span><span class="p">[</span><span class="s1">&#39;modelFile&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="o">==</span> <span class="n">myLabel</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
		<span class="k">else</span><span class="p">:</span>    
			<span class="n">dummy</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">assignments</span><span class="p">[</span><span class="n">assignments</span><span class="p">[</span><span class="s1">&#39;objectID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="n">myLabel</span><span class="p">])])</span>
			<span class="n">dummy</span><span class="p">[</span><span class="s1">&#39;asgnIndex&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">assignments</span><span class="p">[</span><span class="n">assignments</span><span class="p">[</span><span class="s1">&#39;objectID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="n">myLabel</span><span class="p">])]</span><span class="o">.</span><span class="n">index</span>

		<span class="c1"># Replace -1 endTime:</span>
		<span class="n">dummy</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dummy</span><span class="p">[</span><span class="s1">&#39;endTimeSec&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;endTimeSec&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">maxEnd</span>
		
		<span class="c1"># If user doesn&#39;t want color change to trigger a break,</span>
		<span class="c1"># and if a missing color name is specified,</span>
		<span class="c1"># go ahead and replace missing colors now.</span>
		<span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">splitOnColorChange</span><span class="p">):</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">missingColor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
				<span class="n">dummy</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dummy</span><span class="p">[</span><span class="s1">&#39;ganttColor&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="kc">None</span><span class="p">]),</span> <span class="s1">&#39;ganttColor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">missingColor</span>

		<span class="c1"># Sort by odID and startTime:</span>
		<span class="n">dummy</span> <span class="o">=</span> <span class="n">dummy</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;odID&#39;</span><span class="p">,</span> <span class="s1">&#39;startTimeSec&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
		<span class="n">dummy</span> <span class="o">=</span> <span class="n">dummy</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
		
		<span class="c1"># Add new columns, with values from the *next* row:</span>
		<span class="n">dummy</span><span class="p">[[</span><span class="s1">&#39;next_odID&#39;</span><span class="p">,</span> <span class="s1">&#39;next_startTimeSec&#39;</span><span class="p">,</span> <span class="s1">&#39;next_ganttColor&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dummy</span><span class="p">[</span><span class="mi">1</span><span class="p">:][[</span><span class="s1">&#39;odID&#39;</span><span class="p">,</span> <span class="s1">&#39;startTimeSec&#39;</span><span class="p">,</span> <span class="s1">&#39;ganttColor&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

		<span class="n">start_x</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">dummy</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
			<span class="c1"># Set the starting x coordinate for a new cell:</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">start_x</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
				<span class="n">myColor</span> <span class="o">=</span> <span class="n">dummy</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;ganttColor&#39;</span><span class="p">]</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">myColor</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
					<span class="k">if</span> <span class="p">(</span><span class="n">missingColor</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
						<span class="k">break</span>
					<span class="k">else</span><span class="p">:</span>
						<span class="n">myColor</span> <span class="o">=</span> <span class="n">missingColor</span>
				<span class="n">start_x</span> <span class="o">=</span> <span class="n">dummy</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;startTimeSec&#39;</span><span class="p">]</span>
				<span class="n">odID</span>    <span class="o">=</span> <span class="n">dummy</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;odID&#39;</span><span class="p">]</span>	
			
			<span class="c1"># Check for ending condition of the cell</span>
			<span class="c1"># Break in times,</span>
			<span class="c1"># mergeByodID and change in odIDs</span>
			<span class="c1"># splitOnColorChange and change in colors</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">start_x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
				<span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="ow">not</span> <span class="n">mergeByodID</span><span class="p">)</span> <span class="ow">or</span> \
					 <span class="p">(</span><span class="n">dummy</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;endTimeSec&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">dummy</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;next_startTimeSec&#39;</span><span class="p">])</span> <span class="ow">or</span> \
					 <span class="p">(</span><span class="n">dummy</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;odID&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">dummy</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;next_odID&#39;</span><span class="p">])</span> <span class="ow">or</span> \
					 <span class="p">(</span><span class="n">splitOnColorChange</span> <span class="ow">and</span> <span class="p">(</span><span class="n">dummy</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;ganttColor&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">dummy</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;next_ganttColor&#39;</span><span class="p">]))</span> <span class="p">):</span>

					<span class="n">endTime</span> <span class="o">=</span> <span class="n">dummy</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;endTimeSec&#39;</span><span class="p">]</span>
					<span class="n">duration</span> <span class="o">=</span> <span class="n">endTime</span> <span class="o">-</span> <span class="n">start_x</span>
				
					<span class="n">ax</span><span class="o">.</span><span class="n">broken_barh</span><span class="p">([(</span><span class="n">start_x</span><span class="p">,</span> <span class="n">duration</span><span class="p">)],</span> <span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">BAR_HEIGHT</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">BAR_HEIGHT</span><span class="p">),</span> <span class="n">fc</span><span class="o">=</span><span class="n">myColor</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

					<span class="k">if</span> <span class="p">(</span><span class="n">overlayColumn</span> <span class="o">==</span> <span class="s1">&#39;index&#39;</span><span class="p">):</span>
						<span class="k">if</span> <span class="p">(</span><span class="n">xMin</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">start_x</span> <span class="o">+</span> <span class="n">duration</span><span class="o">/</span><span class="mf">2.0</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">xMax</span><span class="p">):</span>
							<span class="n">overlayText</span> <span class="o">=</span> <span class="n">dummy</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;asgnIndex&#39;</span><span class="p">]</span>
							<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">((</span><span class="n">start_x</span> <span class="o">+</span> <span class="n">duration</span><span class="o">/</span><span class="mf">2.0</span><span class="p">),</span> <span class="n">y</span><span class="p">,</span> <span class="n">overlayText</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
					<span class="k">elif</span> <span class="p">(</span><span class="n">overlayColumn</span> <span class="o">==</span> <span class="s1">&#39;odID&#39;</span><span class="p">):</span>
						<span class="k">if</span> <span class="p">(</span><span class="n">xMin</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">start_x</span> <span class="o">+</span> <span class="n">duration</span><span class="o">/</span><span class="mf">2.0</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">xMax</span><span class="p">):</span>
							<span class="n">overlayText</span> <span class="o">=</span> <span class="n">odID</span>
							<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">((</span><span class="n">start_x</span> <span class="o">+</span> <span class="n">duration</span><span class="o">/</span><span class="mf">2.0</span><span class="p">),</span> <span class="n">y</span><span class="p">,</span> <span class="n">overlayText</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
					
					<span class="n">start_x</span> <span class="o">=</span> <span class="kc">None</span>		


	<span class="k">if</span> <span class="p">(</span><span class="n">title</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

	<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">yTicks</span><span class="p">))</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">xAxisLabel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xAxisLabel</span><span class="p">)</span>

	<span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">yTicks</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">yLabels</span><span class="p">)):</span>
		<span class="n">yTicks</span> <span class="o">=</span> <span class="n">yTicks</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">yLabels</span><span class="p">)]</span>
		
	<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">xMin</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">xMax</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">xGridFreq</span><span class="p">)))</span>
	<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">yTicks</span><span class="p">)</span>
	<span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">yLabels</span><span class="p">,</span> <span class="n">minor</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
	<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">yTicks</span><span class="p">,</span> <span class="n">minor</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

	<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">xGrid</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>     
	<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">yGrid</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>     

	<span class="k">if</span> <span class="p">(</span><span class="n">timeFormat</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;dhms&#39;</span><span class="p">):</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">fmtDHMS</span><span class="p">))</span>
	<span class="k">elif</span> <span class="p">(</span><span class="n">timeFormat</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;hms&#39;</span><span class="p">):</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">fmtHMS</span><span class="p">))</span>
	<span class="k">elif</span> <span class="p">(</span><span class="n">timeFormat</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;ms&#39;</span><span class="p">):</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">fmtMS</span><span class="p">))</span>
	<span class="k">elif</span> <span class="p">(</span><span class="n">timeFormat</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;d&#39;</span><span class="p">):</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">fmtD</span><span class="p">))</span>
	<span class="k">elif</span> <span class="p">(</span><span class="n">timeFormat</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;h&#39;</span><span class="p">):</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">fmtH</span><span class="p">))</span>
	<span class="k">elif</span> <span class="p">(</span><span class="n">timeFormat</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;m&#39;</span><span class="p">):</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">fmtM</span><span class="p">))</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">fmtS</span><span class="p">))</span>

	
	<span class="k">if</span> <span class="p">(</span><span class="n">filename</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
		<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>

	<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">();</span>

	<span class="k">return</span> <span class="n">fig</span></div>
	
<div class="viewcode-block" id="getElevationLocs"><a class="viewcode-back" href="../../veroviz.utilities.html#veroviz.utilities.getElevationLocs">[docs]</a><span class="k">def</span> <span class="nf">getElevationLocs</span><span class="p">(</span><span class="n">locs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dataProvider</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dataProviderArgs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>    
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	EXPERIMENTAL.  Finds the elevation, in units of meters above mean sea level (MSL), for a given location or list of locations.  </span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	locs: list of lists, Required, default as None</span>
<span class="sd">		A list of one or more GPS coordinate of the form [[lat, lon], ...] or [[lat, lon, alt], ...].  If altitude is included in locs, the function will add the elevation to the input altitude.  Otherwise, the input altitude will be assumed to be 0.</span>
<span class="sd">	dataProvider: string, Required, default as None</span>
<span class="sd">		Specifies the data source to be used for obtaining elevation data. See :ref:`Data Providers` for options and requirements.</span>
<span class="sd">	dataProviderArgs: dictionary, Required, default as None</span>
<span class="sd">		For some data providers, additional parameters are required (e.g., API keys or database names). See :ref:`Data Providers` for the additional arguments required for each supported data provider.</span>
<span class="sd">	</span>
<span class="sd">	Return</span>
<span class="sd">	------</span>
<span class="sd">	list of lists, of the form [[lat, lon, altMSL], [lat, lon, altMSL], ..., [lat, lon, altMSL]].</span>
<span class="sd">		</span>
<span class="sd">	Note</span>
<span class="sd">	----</span>
<span class="sd">	Currently, only &#39;ors-online&#39;, &#39;usgs&#39;, and &#39;elevapi&#39; are supported.</span>
<span class="sd">	Neither mapQuest, pgRouting, nor OSRM are supported, as they don&#39;t appear to have native support for elevation.  </span>

<span class="sd">	Examples</span>
<span class="sd">	--------</span>

<span class="sd">	Import veroviz and check if the version is up-to-date:</span>
<span class="sd">		&gt;&gt;&gt; import veroviz as vrv</span>
<span class="sd">		&gt;&gt;&gt; vrv.checkVersion()</span>
<span class="sd">	</span>
<span class="sd">	The `getElevationLocs()` function requires a data provider.  If you have saved your API keys as environment variables, you may use `os.environ` to access them:</span>
<span class="sd">		&gt;&gt;&gt; import os</span>
<span class="sd">		&gt;&gt;&gt; </span>
<span class="sd">		&gt;&gt;&gt; ORS_API_KEY = os.environ[&#39;ORSKEY&#39;]</span>
<span class="sd">		&gt;&gt;&gt; ELEVAPI_KEY = os.environ[&#39;ELEVAPIKEY&#39;]</span>
<span class="sd">		&gt;&gt;&gt; </span>
<span class="sd">		&gt;&gt;&gt; # Otherwise, you may specify your keys here:</span>
<span class="sd">		&gt;&gt;&gt; # ORS_API_KEY = &#39;YOUR_ORS_KEY_GOES_HERE&#39;</span>
<span class="sd">		&gt;&gt;&gt; # ELEVAPI_KEY = &#39;YOUR_ELEVATIONAPI_KEY_GOES_HERE&#39;                     	</span>

<span class="sd">	Define a set of locations:</span>
<span class="sd">		&gt;&gt;&gt; locs = [[42.8871085, -78.8731949],</span>
<span class="sd">		...         [42.8888311, -78.8649649],</span>
<span class="sd">		...         [42.8802158, -78.8660787],</span>
<span class="sd">		...         [42.8845705, -78.8762794],</span>
<span class="sd">		...         [42.8908031, -78.8770140]]</span>

<span class="sd">	Use ORS to find the elevations of all locations:</span>
<span class="sd">		&gt;&gt;&gt; vrv.getElevationLocs(locs             = locs, </span>
<span class="sd">		...                      dataProvider     = &#39;ors-online&#39;, </span>
<span class="sd">		...                      dataProviderArgs = {&#39;APIkey&#39;: ORS_API_KEY})</span>

<span class="sd">		[[42.887108, -78.873195, 196.0],</span>
<span class="sd">		 [42.888831, -78.864965, 185.0],</span>
<span class="sd">		 [42.880216, -78.866079, 183.0],</span>
<span class="sd">		 [42.884571, -78.876279, 200.0],</span>
<span class="sd">		 [42.890803, -78.877014, 187.0]]		</span>
<span class="sd">		</span>
<span class="sd">	Use ORS to find the elevation of a single location, with a starting elevation/altitude:</span>
<span class="sd">		&gt;&gt;&gt; vrv.getElevationLocs(locs             = [[42.888, -78.864, 100]], </span>
<span class="sd">		...                      dataProvider     = &#39;ors-online&#39;, </span>
<span class="sd">		...                      dataProviderArgs = {&#39;APIkey&#39;: ORS_API_KEY})</span>
<span class="sd">		</span>
<span class="sd">		[[42.888, -78.864, 284.0]]</span>
<span class="sd">		</span>
<span class="sd">	Use the US Geological Survey data:</span>
<span class="sd">		&gt;&gt;&gt; vrv.getElevationLocs(locs             = locs, </span>
<span class="sd">		...                      dataProvider     = &#39;usgs&#39;)		</span>
<span class="sd">		</span>
<span class="sd">		[[42.8871085, -78.8731949, 187.66],</span>
<span class="sd">		 [42.8888311, -78.8649649, 185.15],</span>
<span class="sd">		 [42.8802158, -78.8660787, 181.1],</span>
<span class="sd">		 [42.8845705, -78.8762794, 185.64],</span>
<span class="sd">		 [42.8908031, -78.877014, 186.25]]</span>
<span class="sd">		 </span>

<span class="sd">	Use Elevation-API:</span>
<span class="sd">		&gt;&gt;&gt; vrv.getElevationLocs(locs             = [[42.888, -78.864, 100]], </span>
<span class="sd">		...                      dataProvider     = &#39;elevapi&#39;,</span>
<span class="sd">		...                      dataProviderArgs = {&#39;APIkey&#39;: ELEVAPI_KEY})</span>

<span class="sd">		[[42.888, -78.864, 292.0]]		 </span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="c1"># validation</span>
	<span class="p">[</span><span class="n">valFlag</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">,</span> <span class="n">warningMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">valGetElevationLocs</span><span class="p">(</span><span class="n">locs</span><span class="p">,</span> <span class="n">dataProvider</span><span class="p">,</span> <span class="n">dataProviderArgs</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">valFlag</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">errorMsg</span><span class="p">)</span>
		<span class="k">return</span> <span class="kc">None</span>
	<span class="k">elif</span> <span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;VRV_SETTING_SHOWWARNINGMESSAGE&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">warningMsg</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">warningMsg</span><span class="p">)</span>
		
	<span class="n">locsWithAlt</span> <span class="o">=</span> <span class="n">privGetElevationLocs</span><span class="p">(</span><span class="n">locs</span><span class="p">,</span> <span class="n">dataProvider</span><span class="p">,</span> <span class="n">dataProviderArgs</span><span class="p">)</span>
	
	<span class="k">return</span> <span class="n">locsWithAlt</span></div>

<div class="viewcode-block" id="getElevationDF"><a class="viewcode-back" href="../../veroviz.utilities.html#veroviz.utilities.getElevationDF">[docs]</a><span class="k">def</span> <span class="nf">getElevationDF</span><span class="p">(</span><span class="n">dataframe</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replaceOnlyNone</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dataProvider</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dataProviderArgs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span> 
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	EXPERIMENTAL.  Replaces missing (`None`) values for elevation columns of the provided dataframe.  New values are in units of meters above mean sea level (MSL).  CAUTION: This function will overwrite the elevation data in the input dataframe.</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	dataframe: pandas.dataframe, Required</span>
<span class="sd">		The dataframe to be exported.  This can be a :ref:`Nodes`, :ref:`Arcs`, or :ref:`Assignments` dataframe.</span>
<span class="sd">	replaceOnlyNone: Boolean, Optional, default as True</span>
<span class="sd">		If True, only find elevation data associated for rows in which this data is missing from the input dataframe.  If False, find (and overwrite) all elevation data with new values.</span>
<span class="sd">	dataProvider: string, Required, default as None</span>
<span class="sd">		Specifies the data source to be used for obtaining elevation data. See :ref:`Data Providers` for options and requirements.</span>
<span class="sd">	dataProviderArgs: dictionary, Required, default as None</span>
<span class="sd">		For some data providers, additional parameters are required (e.g., API keys or database names). See :ref:`Data Providers` for the additional arguments required for each supported data provider.</span>
<span class="sd">	</span>
<span class="sd">	Return</span>
<span class="sd">	------</span>
<span class="sd">	A pandas dataframe.</span>
<span class="sd">		</span>
<span class="sd">	Note</span>
<span class="sd">	----</span>
<span class="sd">	Currently, only &#39;ors-online&#39;, &#39;usgs&#39;, and &#39;elevapi&#39; are supported.</span>
<span class="sd">	Neither mapQuest, pgRouting, nor OSRM are supported, as they don&#39;t appear to have native support for elevation.  </span>

<span class="sd">	Examples</span>
<span class="sd">	--------</span>
<span class="sd">                     	</span>
<span class="sd">	Import veroviz and check if the version is up-to-date:</span>
<span class="sd">		&gt;&gt;&gt; import veroviz as vrv</span>
<span class="sd">		&gt;&gt;&gt; vrv.checkVersion()</span>
<span class="sd">	</span>
<span class="sd">	The `getElevationDF()` function requires a data provider.  If you have saved your API keys as environment variables, you may use `os.environ` to access them:</span>
<span class="sd">		&gt;&gt;&gt; import os</span>
<span class="sd">		&gt;&gt;&gt; </span>
<span class="sd">		&gt;&gt;&gt; ORS_API_KEY = os.environ[&#39;ORSKEY&#39;]</span>
<span class="sd">		&gt;&gt;&gt; ELEVAPI_KEY = os.environ[&#39;ELEVAPIKEY&#39;]</span>
<span class="sd">		&gt;&gt;&gt; </span>
<span class="sd">		&gt;&gt;&gt; # Otherwise, you may specify your keys here:</span>
<span class="sd">		&gt;&gt;&gt; # ORS_API_KEY = &#39;YOUR_ORS_KEY_GOES_HERE&#39;</span>
<span class="sd">		&gt;&gt;&gt; # ELEVAPI_KEY = &#39;YOUR_ELEVATIONAPI_KEY_GOES_HERE&#39;                     	</span>

<span class="sd">	Create a Nodes dataframe.  Note that, by default, there is no elevation data:</span>
<span class="sd">		&gt;&gt;&gt; myNodes = vrv.generateNodes(</span>
<span class="sd">		...     numNodes        = 4,</span>
<span class="sd">		...     nodeType        = &#39;depot&#39;, </span>
<span class="sd">		...     nodeDistrib     = &#39;normal&#39;, </span>
<span class="sd">		...     nodeDistribArgs = {</span>
<span class="sd">		...         &#39;center&#39; : [42.30, -78.00], </span>
<span class="sd">		...         &#39;stdDev&#39; : 1000</span>
<span class="sd">		...     })</span>
<span class="sd">		&gt;&gt;&gt; myNodes[&#39;elevMeters&#39;]</span>

<span class="sd">		0    None</span>
<span class="sd">		1    None</span>
<span class="sd">		2    None</span>
<span class="sd">		3    None</span>
<span class="sd">		Name: elevMeters, dtype: object</span>

<span class="sd">	Find missing elevation data using ORS-online:</span>
<span class="sd">		&gt;&gt;&gt; vrv.getElevationDF(dataframe        = myNodes, </span>
<span class="sd">		...                    dataProvider     = &#39;ors-online&#39;,</span>
<span class="sd">		...                    dataProviderArgs = {&#39;APIkey&#39;: ORS_API_KEY})</span>
<span class="sd">		&gt;&gt;&gt; myNodes[&#39;elevMeters&#39;]</span>

<span class="sd">		0    460</span>
<span class="sd">		1    448</span>
<span class="sd">		2    461</span>
<span class="sd">		3    446</span>
<span class="sd">		Name: elevMeters, dtype: int64</span>

<span class="sd">	Overwrite elevation data using USGS:</span>
<span class="sd">		&gt;&gt;&gt; vrv.getElevationDF(dataframe       = myNodes, </span>
<span class="sd">		...                    replaceOnlyNone = False,</span>
<span class="sd">		...                    dataProvider    = &#39;usgs&#39;)</span>
<span class="sd">		&gt;&gt;&gt; myNodes[&#39;elevMeters&#39;]</span>

<span class="sd">		0    442.58</span>
<span class="sd">		1    447.53</span>
<span class="sd">		2    455.06</span>
<span class="sd">		3    444.21</span>
<span class="sd">		Name: elevMeters, dtype: object</span>

<span class="sd">	Replace elevation data using Elevation-API:</span>
<span class="sd">		&gt;&gt;&gt; vrv.getElevationDF(dataframe        = myNodes, </span>
<span class="sd">		...                    replaceOnlyNone = False,</span>
<span class="sd">		...                    dataProvider     = &#39;elevAPI&#39;,</span>
<span class="sd">		...                    dataProviderArgs = {&#39;APIkey&#39;: ELEVAPI_KEY})</span>
<span class="sd">		&gt;&gt;&gt; myNodes[&#39;elevMeters&#39;]</span>

<span class="sd">		0    192</span>
<span class="sd">		1    192</span>
<span class="sd">		2    192</span>
<span class="sd">		3    178</span>
<span class="sd">		4    178</span>
<span class="sd">		Name: elevMeters, dtype: int64</span>
<span class="sd">	</span>
<span class="sd">	Create an Arcs dataframe from a sequence of nodes:</span>
<span class="sd">		&gt;&gt;&gt; myArcs = vrv.createArcsFromNodeSeq(</span>
<span class="sd">		...     nodeSeq = [1, 2, 3, 4],</span>
<span class="sd">		...     nodes   = myNodes)</span>

<span class="sd">	Find missing start/end elevations in the arcs dataframe, using USGS data:</span>
<span class="sd">		&gt;&gt;&gt; vrv.getElevationDF(dataframe        = myArcs, </span>
<span class="sd">		...                    dataProvider     = &#39;usgs&#39;)</span>
<span class="sd">		&gt;&gt;&gt; myArcs[[&#39;startElevMeters&#39;, &#39;endElevMeters&#39;]]</span>
<span class="sd">			startElevMeters	endElevMeters</span>
<span class="sd">		0	187.66	185.15</span>
<span class="sd">		1	185.15	181.1</span>
<span class="sd">		2	181.1	185.64</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="c1"># validation</span>
	<span class="p">[</span><span class="n">valFlag</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">,</span> <span class="n">warningMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">valGetElevationDF</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">replaceOnlyNone</span><span class="p">,</span> <span class="n">dataProvider</span><span class="p">,</span> <span class="n">dataProviderArgs</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">valFlag</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">errorMsg</span><span class="p">)</span>
		<span class="k">return</span> <span class="kc">None</span>
	<span class="k">elif</span> <span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;VRV_SETTING_SHOWWARNINGMESSAGE&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">warningMsg</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">warningMsg</span><span class="p">)</span>
		
	<span class="c1"># Make copy of dataframe</span>
	<span class="n">dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dataframe</span><span class="p">)</span>
		
	<span class="c1"># Find out the type of dataframe we have:</span>
	<span class="n">dfCols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">dataframe</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">((</span><span class="s1">&#39;lat&#39;</span> <span class="ow">in</span> <span class="n">dfCols</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;lon&#39;</span> <span class="ow">in</span> <span class="n">dfCols</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;elevMeters&#39;</span> <span class="ow">in</span> <span class="n">dfCols</span><span class="p">)):</span>
		<span class="n">dfWithAlt</span> <span class="o">=</span> <span class="n">privGetElevationNodes</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">replaceOnlyNone</span><span class="p">,</span> <span class="n">dataProvider</span><span class="p">,</span> <span class="n">dataProviderArgs</span><span class="p">)</span>
	<span class="k">elif</span> <span class="p">((</span><span class="s1">&#39;startElevMeters&#39;</span> <span class="ow">in</span> <span class="n">dfCols</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;endElevMeters&#39;</span> <span class="ow">in</span> <span class="n">dfCols</span><span class="p">)):</span>
		<span class="n">dfWithAlt</span> <span class="o">=</span> <span class="n">privGetElevationArcsAsgn</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">replaceOnlyNone</span><span class="p">,</span> <span class="n">dataProvider</span><span class="p">,</span> <span class="n">dataProviderArgs</span><span class="p">)</span>	
	<span class="k">else</span><span class="p">:</span>
		<span class="c1"># This shouldn&#39;t happen...validation should catch issues</span>
		<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: Invalid/unknown dataframe configuration.&#39;</span><span class="p">)</span>
		<span class="k">return</span>
		
	<span class="k">return</span> <span class="n">dfWithAlt</span></div>

<div class="viewcode-block" id="getWeather"><a class="viewcode-back" href="../../veroviz.utilities.html#veroviz.utilities.getWeather">[docs]</a><span class="k">def</span> <span class="nf">getWeather</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">initDF</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">metricUnits</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dataProvider</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dataProviderArgs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>  
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	EXPERIMENTAL.  Get weather information (current and forecasted) for a specified [lat, lon] location.</span>

<span class="sd">	Parameters</span>
<span class="sd">	----------</span>
<span class="sd">	location: list, Required</span>
<span class="sd">		A GPS coordinate of the form [lat, lon] or [lat, lon, alt].  If provided, altitude will be ignored.</span>
<span class="sd">	id: integer, Optional, default as None</span>
<span class="sd">		This value may be used to link the resulting dataframe with a different dataframe.  For example, the id could match a nodeID from a nodes dataframe.  If `id=None` and `initDF` is a weather dataframe, a new unique id will be automatically chosen.</span>
<span class="sd">	initDF: pandas dataframe, Optional, default as None</span>
<span class="sd">		If provided, the resulting weather dataframe will be appended to this dataframe.  `initDF` should be the result of calling this function.</span>
<span class="sd">	metricUnits: boolean, Optional, default as False</span>
<span class="sd">		If True, metric units (e.g., Celsius) will be used.  Otherwise, imperial units (e.g., Fahrenheit) will be used.</span>
<span class="sd">	dataProvider: string, Required, default as None</span>
<span class="sd">		Specifies the data source to be used for obtaining elevation data. See :ref:`Data Providers` for options and requirements.</span>
<span class="sd">	dataProviderArgs: dictionary, Required, default as None</span>
<span class="sd">		For some data providers, additional parameters are required (e.g., API keys or database names). See :ref:`Data Providers` for the additional arguments required for each supported data provider.</span>
<span class="sd">	</span>
<span class="sd">	Return</span>
<span class="sd">	------</span>
<span class="sd">	A pandas weather dataframe.</span>
<span class="sd">		</span>
<span class="sd">	Examples</span>
<span class="sd">	--------</span>
<span class="sd">	Import veroviz and check if the version is up-to-date:</span>
<span class="sd">		&gt;&gt;&gt; import veroviz as vrv</span>
<span class="sd">		&gt;&gt;&gt; vrv.checkVersion()</span>
<span class="sd">	</span>
<span class="sd">	Example 1: A simple example using the minium input arguments.</span>
<span class="sd">		&gt;&gt;&gt; myDF = vrv.getWeather(location         = [42, -78], </span>
<span class="sd">		...                       dataProvider     = &#39;openweather&#39;, </span>
<span class="sd">		...                       dataProviderArgs = {&#39;APIkey&#39;: &#39;ENTER KEY HERE&#39;})</span>
<span class="sd">	</span>
<span class="sd">	Example 2: Append to the dataframe created above.  This example uses all of the functional arguments.</span>
<span class="sd">		&gt;&gt;&gt; myDF = vrv.getWeather(location         = [40, -80], </span>
<span class="sd">		...                       id               = 2, </span>
<span class="sd">		...                       initDF           = myDF, </span>
<span class="sd">		...                       metricUnits      = False, </span>
<span class="sd">		...                       dataProvider     = &#39;openweather&#39;, </span>
<span class="sd">		...                       dataProviderArgs = {&#39;APIkey&#39;: &#39;ENTER KEY HERE&#39;})</span>
<span class="sd">	</span>
<span class="sd">	&quot;&quot;&quot;</span>
	
	<span class="c1"># validation</span>
	<span class="p">[</span><span class="n">valFlag</span><span class="p">,</span> <span class="n">errorMsg</span><span class="p">,</span> <span class="n">warningMsg</span><span class="p">]</span> <span class="o">=</span> <span class="n">valGetWeather</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">initDF</span><span class="p">,</span> <span class="n">metricUnits</span><span class="p">,</span> <span class="n">dataProvider</span><span class="p">,</span> <span class="n">dataProviderArgs</span><span class="p">)</span>
	<span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">valFlag</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">errorMsg</span><span class="p">)</span>
		<span class="k">return</span> <span class="kc">None</span>
	<span class="k">elif</span> <span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;VRV_SETTING_SHOWWARNINGMESSAGE&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">warningMsg</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
		<span class="nb">print</span> <span class="p">(</span><span class="n">warningMsg</span><span class="p">)</span>
	
	<span class="c1"># Get an ID:</span>
	<span class="k">if</span> <span class="p">(</span><span class="nb">id</span> <span class="o">==</span> <span class="kc">None</span><span class="p">):</span>
		<span class="nb">id</span> <span class="o">=</span> <span class="mi">1</span>
		<span class="k">if</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">initDF</span><span class="p">)</span> <span class="ow">is</span> <span class="n">pd</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
			<span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">initDF</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
				<span class="nb">id</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">initDF</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">])</span><span class="o">+</span><span class="mi">1</span>
			
	<span class="n">weatherDF</span> <span class="o">=</span> <span class="n">privGetWeather</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">metricUnits</span><span class="p">,</span> <span class="n">dataProvider</span><span class="p">,</span> <span class="n">dataProviderArgs</span><span class="p">)</span>

	<span class="c1"># Combine with init dataframe:</span>
	<span class="k">if</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">initDF</span><span class="p">)</span> <span class="ow">is</span> <span class="n">pd</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
		<span class="n">weatherDF</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">initDF</span><span class="p">,</span> <span class="n">weatherDF</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

	<span class="k">return</span> <span class="n">weatherDF</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">veroviz 0.4.5 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../veroviz.html" >veroviz</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, optimatorlab.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.1.2.
    </div>
  </body>
</html>